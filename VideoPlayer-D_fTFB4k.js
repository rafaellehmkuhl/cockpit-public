import{bX as B,d as E,bz as P,b as o,a5 as T,az as j,ay as O,q as p,aC as H,aE as A,aF as D,a7 as x,v as k,k as _,o as m,c as f,a as l,t as S,h as i,a1 as d,ac as q,aM as L,a4 as g,ad as Y,aG as I,aV as N,a2 as U,ah as G,a8 as K,ai as W,aj as X,ak as J}from"./index-BTqOXlJU.js";const Q=B("v-banner-text"),c=v=>(W("data-v-f87059ab"),v=v(),X(),v),Z={ref:"videoWidget",class:"video-widget"},ee={key:0,class:"no-video-alert"},te=c(()=>l("span",null,"No video stream selected.",-1)),ae=[te],oe={key:1,class:"no-video-alert"},le=c(()=>l("p",null,"The selected stream is not available.",-1)),se=c(()=>l("p",null,"Please check its source or select another stream.",-1)),ne=[le,se],ie={key:2,class:"no-video-alert"},re={class:"no-video-alert"},de=c(()=>l("span",{class:"text-xl font-bold"},"Server status: ",-1)),ue=c(()=>l("span",{class:"text-xl font-bold"},"Stream status: ",-1)),ce={key:3,class:"no-video-alert"},ve=c(()=>l("p",null,"Loading stream...",-1)),pe=[ve],me={class:"flex-wrap justify-center d-flex ga-5"},fe=E({__name:"VideoPlayer",props:{widget:{}},setup(v){P(a=>({"9394bb32":o(e).options.videoFitStyle,"3535f76a":R.value}));const y=T(),{namesAvailableStreams:u}=j(y),e=O(v).widget,s=p(),V=p(),r=p();H(()=>{const a={videoFitStyle:"cover",flipHorizontally:!1,flipVertically:!1,rotationAngle:0,streamName:void 0};e.value.options=Object.assign({},a,e.value.options),s.value=e.value.options.streamName});const F=setInterval(()=>{e.value.options.streamName===void 0&&!u.value.isEmpty()&&(e.value.options.streamName=u.value[0],s.value=e.value.options.streamName,u.value.length>1&&A.fire({title:"Multiple streams detected",text:`You have multiple streams available, so we chose one randomly to start with.
        If you want to change it, please open the widget configuration on the edit-menu.`,icon:"info",confirmButtonText:"OK"}));const a=y.getMediaStream(e.value.options.streamName);D(a,r.value)||(r.value=a)},1e3);x(()=>clearInterval(F)),k(s,()=>{e.value.options.streamName=s.value,r.value=void 0}),k(r,()=>{!V.value||!r.value||(V.value.srcObject=r.value,V.value.play().then(()=>console.log("[VideoPlayer] Stream is playing")).catch(a=>{const t=`Failed to play stream. Reason: ${a}`;console.error(`[VideoPlayer] ${t}`)}))});const h=a=>{e.value.options.rotationAngle+=a},C=_(()=>`scale(${e.value.options.flipHorizontally?-1:1}, ${e.value.options.flipVertically?-1:1})`),M=_(()=>`rotate(${e.value.options.rotationAngle??0}deg)`),R=_(()=>`${C.value} ${M.value}`),b=p("Unknown."),w=p("Unknown."),$=setInterval(()=>{var a;s.value!==void 0&&(b.value=((a=y.getStreamData(s.value))==null?void 0:a.webRtcManager.signallerStatus)??"Unknown.")},1e3),z=setInterval(()=>{var a;s.value!==void 0&&(w.value=((a=y.getStreamData(s.value))==null?void 0:a.webRtcManager.streamStatus)??"Unknown.")},1e3);return x(()=>{clearInterval($),clearInterval(z)}),(a,t)=>(m(),f(K,null,[l("div",Z,[s.value===void 0?(m(),f("div",ee,ae)):!o(u).isEmpty()&&!o(u).includes(s.value)?(m(),f("div",oe,ne)):r.value===void 0?(m(),f("div",ie,[l("div",re,[l("p",null,[de,l("span",null,S(b.value),1)]),l("p",null,[ue,l("span",null,S(w.value),1)])])])):(m(),f("div",ce,pe)),l("video",{ref_key:"videoElement",ref:V,muted:"",autoplay:"",playsinline:"",disablePictureInPicture:""}," Your browser does not support the video tag. ",512)],512),i(G,{modelValue:o(e).managerVars.configMenuOpen,"onUpdate:modelValue":t[6]||(t[6]=n=>o(e).managerVars.configMenuOpen=n),width:"auto"},{default:d(()=>[i(q,{class:"pa-2"},{default:d(()=>[i(L,null,{default:d(()=>[g("Video widget config")]),_:1}),i(Y,null,{default:d(()=>[i(I,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=n=>s.value=n),label:"Stream name",class:"my-3",items:o(u),"item-title":"name",density:"compact",variant:"outlined","no-data-text":"No streams available.","hide-details":"","return-object":""},null,8,["modelValue","items"]),i(I,{modelValue:o(e).options.videoFitStyle,"onUpdate:modelValue":t[1]||(t[1]=n=>o(e).options.videoFitStyle=n),label:"Fit style",class:"my-3",items:["cover","fill","contain"],"item-title":"style",density:"compact",variant:"outlined","no-data-text":"No streams available.","hide-details":"","return-object":""},null,8,["modelValue"]),i(Q,null,{default:d(()=>[g('Saved stream name: "'+S(o(e).options.streamName)+'"',1)]),_:1}),i(N,{modelValue:o(e).options.flipHorizontally,"onUpdate:modelValue":t[2]||(t[2]=n=>o(e).options.flipHorizontally=n),class:"my-1",label:"Flip horizontally",color:o(e).options.flipHorizontally?"rgb(0, 20, 80)":void 0,"hide-details":""},null,8,["modelValue","color"]),i(N,{modelValue:o(e).options.flipVertically,"onUpdate:modelValue":t[3]||(t[3]=n=>o(e).options.flipVertically=n),class:"my-1",label:"Flip vertically",color:o(e).options.flipVertically?"rgb(0, 20, 80)":void 0,"hide-details":""},null,8,["modelValue","color"]),l("div",me,[i(U,{"prepend-icon":"mdi-file-rotate-left",variant:"outlined",onClick:t[4]||(t[4]=n=>h(-90))},{default:d(()=>[g(" Rotate Left")]),_:1}),i(U,{"prepend-icon":"mdi-file-rotate-right",variant:"outlined",onClick:t[5]||(t[5]=n=>h(90))},{default:d(()=>[g(" Rotate Right")]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),ge=J(fe,[["__scopeId","data-v-f87059ab"]]);export{ge as default};
