import{bE as Ie,bF as He,bG as Ue,bH as ne,bI as Ze,bJ as we,bK as Fe,bL as We,q as O,bs as A,y as U,bM as D,bN as re,aP as Be,by as x,a0 as j,a7 as K,k as F,v as ye,a6 as Ge,d as Xe,p as Te,D as _e,u as Je,bO as qe,aS as Ye,x as Ke,bP as B,ay as Qe,aC as et,o as N,c as me,h as L,a1 as _,i as J,b as p,a as E,t as R,j as q,aa as Ae,a2 as ae,Z as Ce,aL as H,bA as tt,a8 as Me,a9 as ot,ac as nt,aM as at,a4 as lt,ad as st,aV as it,ah as rt,X as ut,bQ as dt,aE as Ee,s as ct,e as ft,E as mt}from"./index-B-kaFeNq.js";import{_ as pt}from"./VehicleIcon.vue_vue_type_script_setup_true_lang-b5ewA1YJ.js";function De(e,t){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}function yt(e){return De({},e)}var Pe=1440,vt=2520,pe=43200,gt=86400;function bt(e,t,o){var n,f;Ie(2,arguments);var c=We(),s=(n=(f=o==null?void 0:o.locale)!==null&&f!==void 0?f:c.locale)!==null&&n!==void 0?n:He;if(!s.formatDistance)throw new RangeError("locale must contain formatDistance property");var d=Ue(e,t);if(isNaN(d))throw new RangeError("Invalid time value");var l=De(yt(o),{addSuffix:!!(o!=null&&o.addSuffix),comparison:d}),g,a;d>0?(g=ne(t),a=ne(e)):(g=ne(e),a=ne(t));var y=Ze(a,g),P=(we(a)-we(g))/1e3,u=Math.round((y-P)/60),h;if(u<2)return o!=null&&o.includeSeconds?y<5?s.formatDistance("lessThanXSeconds",5,l):y<10?s.formatDistance("lessThanXSeconds",10,l):y<20?s.formatDistance("lessThanXSeconds",20,l):y<40?s.formatDistance("halfAMinute",0,l):y<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):u===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",u,l);if(u<45)return s.formatDistance("xMinutes",u,l);if(u<90)return s.formatDistance("aboutXHours",1,l);if(u<Pe){var w=Math.round(u/60);return s.formatDistance("aboutXHours",w,l)}else{if(u<vt)return s.formatDistance("xDays",1,l);if(u<pe){var C=Math.round(u/Pe);return s.formatDistance("xDays",C,l)}else if(u<gt)return h=Math.round(u/pe),s.formatDistance("aboutXMonths",h,l)}if(h=Fe(a,g),h<12){var T=Math.round(u/pe);return s.formatDistance("xMonths",T,l)}else{var I=h%12,S=Math.floor(h/12);return I<3?s.formatDistance("aboutXYears",S,l):I<9?s.formatDistance("overXYears",S,l):s.formatDistance("almostXYears",S+1,l)}}function ht(e,t){return Ie(1,arguments),bt(e,Date.now(),t)}const ke=(e,t)=>{let o;return function(...n){const f=this;o&&clearTimeout(o),o=setTimeout(()=>{e.apply(f,n),o=null},t)}},Lt=e=>!e||typeof e.charAt!="function"?e:e.charAt(0).toUpperCase()+e.slice(1),W=(e,t,o)=>{for(const n in o){const f="set"+Lt(n);e[f]?ye(()=>o[n],(c,s)=>{e[f](c,s)}):t[f]&&ye(()=>o[n],c=>{t[f](c)})}},G=e=>{const t={};for(const o in e)if(o.startsWith("on")&&!o.startsWith("onUpdate")&&o!=="onReady"){const n=o.slice(2).toLocaleLowerCase();t[n]=e[o]}return t},Ot=async e=>{const t=await Promise.all([D(()=>import("./marker-icon-2x-D4k_ikNW.js"),[],import.meta.url),D(()=>import("./marker-icon-C2eJqgqv.js"),[],import.meta.url),D(()=>import("./marker-shadow-DU6CIJ0p.js"),[],import.meta.url)]);delete e.Default.prototype._getIconUrl,e.Default.mergeOptions({iconRetinaUrl:t[0].default,iconUrl:t[1].default,shadowUrl:t[2].default})},le=e=>{const t=O(()=>console.warn(`Method ${e} has been invoked without being replaced`)),o=(...n)=>t.value(...n);return o.wrapped=t,x(e,o),o},se=(e,t)=>e.wrapped.value=t,$=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||void 0,X="useGlobalLeaflet",Q={options:{type:Object,default:()=>({})}},ee=e=>({options:e.options,methods:{}}),be={...Q,pane:{type:String,default:"overlayPane"},attribution:{type:String,default:null},name:{type:String,custom:!0,default:void 0},layerType:{type:String,custom:!0,default:void 0},visible:{type:Boolean,custom:!0,default:!0}},he=(e,t,o)=>{const n=A("addLayer"),f=A("removeLayer"),{options:c,methods:s}=ee(e),d={...c,attribution:e.attribution,pane:e.pane},l=()=>n({leafletObject:t.value}),g=()=>f({leafletObject:t.value}),a={...s,setAttribution(y,P){this.$parent.leafletObject.attributionControl.removeAttribution(P).addAttribution(y)},setName(){g(),e.visible&&l()},setLayerType(){g(),e.visible&&l()},setVisible(y){t.value&&(y?l():g())},bindPopup({leafletObject:y}){t.value.bindPopup(y)},bindTooltip({leafletObject:y}){t.value.bindTooltip(y)},unbindTooltip(){const y=t.value?t.value.getTooltip():null;y&&y.unbindTooltip()},unbindPopup(){const y=t.value?t.value.getPopup():null;y&&y.unbindPopup()},updateVisibleProp(y){o.emit("update:visible",y)}};return x("bindPopup",a.bindPopup),x("bindTooltip",a.bindTooltip),x("unbindTooltip",a.unbindTooltip),x("unbindPopup",a.unbindPopup),Ge(()=>{a.unbindPopup(),a.unbindTooltip(),g()}),{options:d,methods:a}},xe=(e,t)=>{if(e&&t.default)return re("div",{style:{display:"none"}},t.default())},St={...Q,interactive:{type:Boolean,default:!0},bubblingMouseEvents:{type:Boolean,default:!0}},wt=e=>{const{options:t,methods:o}=ee(e);return{options:{...t,interactive:e.interactive,bubblingMouseEvents:e.bubblingMouseEvents},methods:o}},Tt={...be,...St,stroke:{type:Boolean,custom:!0,default:!0},color:{type:String,custom:!0,default:"#3388ff"},weight:{type:Number,custom:!0,default:3},opacity:{type:Number,custom:!0,default:1},lineCap:{type:String,custom:!0,default:"round"},lineJoin:{type:String,custom:!0,default:"round"},dashArray:{type:String,custom:!0,default:null},dashOffset:{type:String,custom:!0,default:null},fill:{type:Boolean,custom:!0,default:!1},fillColor:{type:String,custom:!0,default:"#3388ff"},fillOpacity:{type:Number,custom:!0,default:.2},fillRule:{type:String,custom:!0,default:"evenodd"},className:{type:String,custom:!0,default:null}},_t=(e,t,o)=>{const{options:n,methods:f}=he(e,t,o),{options:c,methods:s}=wt(e),d=A("removeLayer"),l={...n,...c,stroke:e.stroke,color:e.color,weight:e.weight,opacity:e.opacity,lineCap:e.lineCap,lineJoin:e.lineJoin,dashArray:e.dashArray,dashOffset:e.dashOffset,fill:e.fill,fillColor:e.fillColor,fillOpacity:e.fillOpacity,fillRule:e.fillRule,className:e.className},g={...f,...s,setStroke(a){t.value.setStyle({stroke:a})},setColor(a){t.value.setStyle({color:a})},setWeight(a){t.value.setStyle({weight:a})},setOpacity(a){t.value.setStyle({opacity:a})},setLineCap(a){t.value.setStyle({lineCap:a})},setLineJoin(a){t.value.setStyle({lineJoin:a})},setDashArray(a){t.value.setStyle({dashArray:a})},setDashOffset(a){t.value.setStyle({dashOffset:a})},setFill(a){t.value.setStyle({fill:a})},setFillColor(a){t.value.setStyle({fillColor:a})},setFillOpacity(a){t.value.setStyle({fillOpacity:a})},setFillRule(a){t.value.setStyle({fillRule:a})},setClassName(a){t.value.setStyle({className:a})}};return K(()=>{d({leafletObject:t.value})}),{options:l,methods:g}},At={...be,pane:{type:String,default:"tilePane"},opacity:{type:Number,custom:!1,default:1},zIndex:{type:Number,default:1},tileSize:{type:Number,default:256},noWrap:{type:Boolean,default:!1},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:void 0}},Ct=(e,t,o)=>{const{options:n,methods:f}=he(e,t,o);return{options:{...n,pane:e.pane,opacity:e.opacity,zIndex:e.zIndex,tileSize:e.tileSize,noWrap:e.noWrap,minZoom:e.minZoom,maxZoom:e.maxZoom},methods:{...f}}},Mt={iconUrl:{type:String,custom:!0,default:null},iconRetinaUrl:{type:String,custom:!0,default:null},iconSize:{type:[Object,Array],custom:!0,default:null},iconAnchor:{type:[Object,Array],custom:!0,default:null},popupAnchor:{type:[Object,Array],custom:!0,default:()=>[0,0]},tooltipAnchor:{type:[Object,Array],custom:!0,default:()=>[0,0]},shadowUrl:{type:String,custom:!0,default:null},shadowRetinaUrl:{type:String,custom:!0,default:null},shadowSize:{type:[Object,Array],custom:!0,default:null},shadowAnchor:{type:[Object,Array],custom:!0,default:null},bgPos:{type:[Object,Array],custom:!0,default:()=>[0,0]},className:{type:String,custom:!0,default:""},options:{type:Object,custom:!0,default:()=>({})}};var ie={name:"LIcon",props:{...Mt,...Q},setup(e,t){const o=O(null),n=A(X),f=A("canSetParentHtml"),c=A("setParentHtml"),s=A("setIcon");let d,l,g,a,y;const P=(C,T,I)=>{const S=C&&C.innerHTML;if(!T){I&&y&&f()&&c(S);return}const M=G(t.attrs);y&&l(y,M);const{options:Z}=ee(e),i={...Z,iconUrl:e.iconUrl,iconRetinaUrl:e.iconRetinaUrl,iconSize:e.iconSize,iconAnchor:e.iconAnchor,popupAnchor:e.popupAnchor,tooltipAnchor:e.tooltipAnchor,shadowUrl:e.shadowUrl,shadowRetinaUrl:e.shadowRetinaUrl,shadowSize:e.shadowSize,shadowAnchor:e.shadowAnchor,bgPos:e.bgPos,className:e.className,html:S||e.html};y=i.html?g(i):a(i),d(y,M),s(y)},u=()=>{j(()=>P(o.value,!0,!1))},h=()=>{j(()=>P(o.value,!1,!0))},w={setIconUrl:u,setIconRetinaUrl:u,setIconSize:u,setIconAnchor:u,setPopupAnchor:u,setTooltipAnchor:u,setShadowUrl:u,setShadowRetinaUrl:u,setShadowAnchor:u,setBgPos:u,setClassName:u,setHtml:u};return U(async()=>{const{DomEvent:C,divIcon:T,icon:I}=n?$.L:await D(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);d=C.on,l=C.off,g=T,a=I,W(w,{},e),new MutationObserver(h).observe(o.value,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),u()}),{root:o}},render(){const e=this.$slots.default?this.$slots.default():void 0;return re("div",{ref:"root"},e)}};ie.__file="src/components/LIcon.vue";var Ve={emits:["ready","update:zoom","update:center","update:bounds"],props:{...Q,center:{type:[Object,Array],default:()=>[0,0]},bounds:{type:[Array,Object],default:void 0},maxBounds:{type:[Array,Object],default:void 0},zoom:{type:Number,default:0},minZoom:{type:Number,default:void 0},maxZoom:{type:Number,default:void 0},paddingBottomRight:{type:Array,default:void 0},paddingTopLeft:{type:Array,default:void 0},padding:{type:Array,default:void 0},worldCopyJump:{type:Boolean,default:!1},crs:{type:[String,Object],default:"EPSG3857"},maxBoundsViscosity:{type:Number,default:void 0},inertia:{type:Boolean,default:void 0},inertiaDeceleration:{type:Number,default:void 0},inertiaMaxSpeed:{type:Number,default:void 0},easeLinearity:{type:Number,default:void 0},zoomAnimation:{type:Boolean,default:void 0},zoomAnimationThreshold:{type:Number,default:void 0},fadeAnimation:{type:Boolean,default:void 0},markerZoomAnimation:{type:Boolean,default:void 0},noBlockingAnimations:{type:Boolean,default:!1},useGlobalLeaflet:{type:Boolean,default:!1}},setup(e,t){const o=O(null),n=Be({ready:!1,leafletRef:{},layersToAdd:[],layersInControl:[]}),{options:f}=ee(e),c={...f,minZoom:e.minZoom,maxZoom:e.maxZoom,maxBounds:e.maxBounds,maxBoundsViscosity:e.maxBoundsViscosity,worldCopyJump:e.worldCopyJump,crs:e.crs,center:e.center,zoom:e.zoom,inertia:e.inertia,inertiaDeceleration:e.inertiaDeceleration,inertiaMaxSpeed:e.inertiaMaxSpeed,easeLinearity:e.easeLinearity,zoomAnimation:e.zoomAnimation,zoomAnimationThreshold:e.zoomAnimationThreshold,fadeAnimation:e.fadeAnimation,markerZoomAnimation:e.markerZoomAnimation},s=le("addLayer"),d=le("removeLayer"),l=le("registerControl"),g=le("registerLayerControl");x(X,e.useGlobalLeaflet);const a={moveEndHandler(){t.emit("update:zoom",n.leafletRef.getZoom()),t.emit("update:center",n.leafletRef.getCenter()),t.emit("update:bounds",n.leafletRef.getBounds())},overlayAddHandler(u){const h=n.layersInControl.find(w=>w.name===u.name);h&&h.updateVisibleProp(!0)},overlayRemoveHandler(u){const h=n.layersInControl.find(w=>w.name===u.name);h&&h.updateVisibleProp(!1)}};U(async()=>{e.useGlobalLeaflet&&($.L=$.L||await D(()=>import("./index-B-kaFeNq.js").then(i=>i.l),[],import.meta.url));const{map:u,CRS:h,Icon:w,latLngBounds:C,latLng:T,DomEvent:I}=e.useGlobalLeaflet?$.L:await D(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);try{c.beforeMapMount&&await c.beforeMapMount()}catch(i){console.error(`The following error occurred running the provided beforeMapMount hook ${i.message}`)}await Ot(w);const S=typeof c.crs=="string"?h[c.crs]:c.crs;c.crs=S||h.EPSG3857;const M={addLayer(i){i.layerType!==void 0&&(n.layerControl===void 0?n.layersToAdd.push(i):n.layersInControl.find(z=>z.leafletObject._leaflet_id===i.leafletObject._leaflet_id)||(n.layerControl.addLayer(i),n.layersInControl.push(i))),i.visible!==!1&&n.leafletRef.addLayer(i.leafletObject)},removeLayer(i){i.layerType!==void 0&&(n.layerControl===void 0?n.layersToAdd=n.layersToAdd.filter(b=>b.name!==i.name):(n.layerControl.removeLayer(i.leafletObject),n.layersInControl=n.layersInControl.filter(b=>b.leafletObject._leaflet_id!==i.leafletObject._leaflet_id))),n.leafletRef.removeLayer(i.leafletObject)},registerLayerControl(i){n.layerControl=i,n.layersToAdd.forEach(b=>{n.layerControl.addLayer(b)}),n.layersToAdd=[],l(i)},registerControl(i){n.leafletRef.addControl(i.leafletObject)},setZoom(i){const b=n.leafletRef.getZoom();i!==b&&n.leafletRef.setZoom(i,{animate:e.noBlockingAnimations?!1:null})},setPaddingBottomRight(i){n.paddingBottomRight=i},setPaddingTopLeft(i){n.paddingTopLeft=i},setPadding(i){n.padding=i},setCrs(i){const b=n.leafletRef.getBounds();n.leafletRef.options.crs=i,n.leafletRef.fitBounds(b,{animate:!1,padding:[0,0]})},fitBounds(i){n.leafletRef.fitBounds(i,{animate:this.noBlockingAnimations?!1:null})},setBounds(i){if(!i)return;const b=C(i);if(!b.isValid())return;!(n.lastSetBounds||n.leafletRef.getBounds()).equals(b,0)&&(n.lastSetBounds=b,n.leafletRef.fitBounds(b,this.fitBoundsOptions))},setCenter(i){if(i==null)return;const b=T(i),z=n.lastSetCenter||n.leafletRef.getCenter();(z.lat!==b.lat||z.lng!==b.lng)&&(n.lastSetCenter=b,n.leafletRef.panTo(b,{animate:this.noBlockingAnimations?!1:null}))}};se(s,M.addLayer),se(d,M.removeLayer),se(l,M.registerControl),se(g,M.registerLayerControl),n.leafletRef=u(o.value,c),W(M,n.leafletRef,e);const Z=G(t.attrs);n.leafletRef.on("moveend",ke(a.moveEndHandler,100)),n.leafletRef.on("overlayadd",a.overlayAddHandler),n.leafletRef.on("overlayremove",a.overlayRemoveHandler),I.on(n.leafletRef,Z),n.ready=!0,j(()=>t.emit("ready",n.leafletRef))}),K(()=>{n.leafletRef&&n.leafletRef.remove()});const y=F(()=>n.leafletRef),P=F(()=>n.ready);return{root:o,ready:P,leafletObject:y}},render(){return re("div",{style:{width:"100%",height:"100%"},ref:"root"},this.ready?this.$slots.default():{})}};Ve.__file="src/components/LMap.vue";const Et={...be,pane:{type:String,default:"markerPane"},draggable:{type:Boolean,custom:!0,default:!1},latLng:{type:[Object,Array],custom:!0,default:null},icon:{type:[Object],default:()=>{},custom:!1},zIndexOffset:{type:Number,custom:!1,default:null}},Pt=(e,t,o)=>{const{options:n,methods:f}=he(e,t,o),c={...n,...e},s={...f,setDraggable(d){t.value.dragging&&(d?t.value.dragging.enable():t.value.dragging.disable())},latLngSync(d){o.emit("update:latLng",d.latlng),o.emit("update:lat-lng",d.latlng)},setLatLng(d){if(d!=null&&t.value){const l=t.value.getLatLng();(!l||!l.equals(d))&&t.value.setLatLng(d)}}};return{options:c,methods:s}};var Y={name:"LMarker",props:Et,setup(e,t){const o=O({}),n=O(!1),f=A(X),c=A("addLayer");x("canSetParentHtml",()=>!!o.value.getElement()),x("setParentHtml",l=>o.value.getElement().innerHTML=l),x("setIcon",l=>o.value.setIcon&&o.value.setIcon(l));const{options:s,methods:d}=Pt(e,o,t);return s.icon===void 0&&delete s.icon,U(async()=>{const{marker:l,DomEvent:g}=f?$.L:await D(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);o.value=l(e.latLng,s);const a=G(t.attrs);g.on(o.value,a),o.value.on("move",ke(d.latLngSync,100)),W(d,o.value,e),c({...e,...d,leafletObject:o.value}),n.value=!0,j(()=>t.emit("ready",o.value))}),{ready:n,leafletObject:o}},render(){return xe(this.ready,this.$slots)}};Y.__file="src/components/LMarker.vue";const Ne={...Tt,latLngs:{type:Array,default:()=>[]},smoothFactor:{type:Number,custom:!0,default:1},noClip:{type:Boolean,custom:!0,default:!1}},It=(e,t,o)=>{const{options:n,methods:f}=_t(e,t,o),c={...n,...e},s={...f,setSmoothFactor(d){t.value.setStyle({smoothFactor:d})},setNoClip(d){t.value.setStyle({noClip:d})},addLatLng(d){t.value.addLatLng(d)}};return{options:c,methods:s}};({...Ne});var ve={name:"LPolyline",props:Ne,setup(e,t){const o=O({}),n=O(!1),f=A(X),c=A("addLayer"),{options:s,methods:d}=It(e,o,t);return U(async()=>{const{polyline:l,DomEvent:g}=f?$.L:await D(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);o.value=l(e.latLngs,s);const a=G(t.attrs);g.on(o.value,a),W(d,o.value,e),c({...e,...d,leafletObject:o.value}),n.value=!0,j(()=>t.emit("ready",o.value))}),{ready:n,leafletObject:o}},render(){return xe(this.ready,this.$slots)}};ve.__file="src/components/LPolyline.vue";const Bt={...Q,content:{type:String,default:null}},Dt=(e,t)=>{const{options:o,methods:n}=ee(e),f={...n,setContent(c){t.value&&c!==null&&c!==void 0&&t.value.setContent(c)}};return{options:o,methods:f}},kt=e=>e.default?re("div",{ref:"root"},e.default()):null,$e={...At,tms:{type:Boolean,default:!1},subdomains:{type:String,default:"abc"},detectRetina:{type:Boolean,default:!1},url:{type:String,default:null}},xt=(e,t)=>{const{options:o,methods:n}=Ct(e,t);return{options:{...o,tms:e.tms,subdomains:e.subdomains,detectRetina:e.detectRetina},methods:{...n}}};var je={props:$e,setup(e,t){const o=O({}),n=A(X),f=A("addLayer"),{options:c,methods:s}=xt(e,o);return U(async()=>{const{tileLayer:d,DomEvent:l}=n?$.L:await D(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);o.value=d(e.url,c);const g=G(t.attrs);l.on(o.value,g),W(s,o.value,e),f({...e,...s,leafletObject:o.value}),j(()=>t.emit("ready",o.value))}),{leafletObject:o}},render(){return null}};je.__file="src/components/LTileLayer.vue";const Vt={...Bt},Nt=(e,t)=>{const{options:o,methods:n}=Dt(e,t),f=A("unbindTooltip");return K(()=>{f()}),{options:o,methods:n}};var ge={name:"LTooltip",props:Vt,setup(e,t){const o=O({}),n=O(null),f=A(X),c=A("bindTooltip"),{options:s,methods:d}=Nt(e,o);return U(async()=>{const{tooltip:l,DomEvent:g}=f?$.L:await D(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);o.value=l(s),W(d,o.value,e);const a=G(t.attrs);g.on(o.value,a),o.value.setContent(e.content||n.value),c({leafletObject:o.value}),j(()=>t.emit("ready",o.value))}),{root:n,leafletObject:o}},render(){return kt(this.$slots)}};ge.__file="src/components/LTooltip.vue";({...$e});const $t=E("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[E("path",{fill:"blue",d:`M12 3L2 12h3v8h14v-8h3L12 3m0 4.7c2.1 0 3.8 1.7
            3.8 3.8c0 3-3.8 6.5-3.8 6.5s-3.8-3.5-3.8-6.5c0-2.1
            1.7-3.8 3.8-3.8m0 2.3a1.5 1.5 0 0 0-1.5 1.5A1.5 1.5
            0 0 0 12 13a1.5 1.5 0 0 0 1.5-1.5A1.5 1.5 0 0 0 12 10Z`})],-1),Rt=Xe({__name:"Map",props:{widget:{}},setup(e){var Se;Te.registerUsage(_e.latitude),Te.registerUsage(_e.longitude);const t=Je(),o=qe(),n=O(18),f=O(null),c=O([-27.5935,-48.55854]),s=O(c.value),d=O(void 0),l=F(()=>t.coordinates.latitude?[t.coordinates.latitude,t.coordinates.longitude]:void 0),g=F(()=>{var r;return t.attitude.yaw?Ye((r=t.attitude)==null?void 0:r.yaw):0}),{history:a}=Ke(l),y=F(()=>a.value.filter(r=>r.snapshot!==void 0).map(r=>r.snapshot)),P=F(()=>{const r=t.lastHeartbeat;return r?`${ht(r??0,{includeSeconds:!0})} ago`:"never"}),u=new dt(r=>d.value=r,r=>c.value=r);u.setTrackableTarget(B.VEHICLE,()=>l.value),u.setTrackableTarget(B.HOME,()=>s.value);const h=O(null),w=O(null);let C=!0;(Se=navigator==null?void 0:navigator.geolocation)==null||Se.watchPosition(r=>{s.value=[r.coords.latitude,r.coords.longitude],C&&(u.goToTarget(B.HOME),C=w.value!==null)},r=>{console.error(`Failed to get position: (${r.code}) ${r.message}`)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:0});let T=null;const I=async()=>{var r,m;if(await j(),T=(r=h.value)==null?void 0:r.leafletObject,!T){console.warn("Failed to get leaflet reference");return}if(w.value=(m=h.value)==null?void 0:m.leafletObject,T.on("click",ue),w.value==null){console.warn("Failed to get leaflet reference");return}w.value.zoomControl.setPosition("bottomright"),T.on("contextmenu",()=>{M()}),setTimeout(()=>u.goToTarget(B.HOME),2e3)},S=O(null),M=()=>{te.value=!1,S.value=null},Z=r=>{r.key==="Escape"&&M()};U(()=>{window.addEventListener("keydown",Z)});const i=O(!1),b=O(0),z=async()=>{for(i.value=!0,b.value=0;o.currentPlanningWaypoints.length>0;)o.currentPlanningWaypoints.pop();const r=async m=>{b.value=m};try{(await t.fetchMission(r)).forEach(v=>{o.currentPlanningWaypoints.push(v),Ee.fire({icon:"success",title:"Mission download succeed!",timer:2e3})})}catch(m){Ee.fire({icon:"error",title:"Mission download failed",text:m,timer:5e3})}finally{i.value=!1}},Le=()=>{t.startMission()},Oe=e,V=Qe(Oe).widget;ye(Oe.widget,()=>{var r;(r=w.value)==null||r.invalidateSize()}),et(()=>{Object.keys(V.value.options).length===0&&(V.value.options={showVehiclePath:!0}),u.enableAutoUpdate()}),K(()=>{u.disableAutoUpdate(),T&&T.off("click",ue)}),K(()=>{window.removeEventListener("keydown",Z),T&&T.off("contextmenu")});const te=O(!1),oe=Be({top:"0px",left:"0px"}),ue=r=>{var m,v,k;if(console.log("Map click event:",r),((m=r==null?void 0:r.latlng)==null?void 0:m.lat)!=null&&((v=r==null?void 0:r.latlng)==null?void 0:v.lng)!=null){S.value=[r.latlng.lat,r.latlng.lng],te.value=!0;const de=(k=w.value)==null?void 0:k.getContainer();if(de){const{x:ce,y:fe}=de.getBoundingClientRect();oe.left=`${r.originalEvent.clientX-ce}px`,oe.top=`${r.originalEvent.clientY-fe}px`}}else console.error("Invalid event structure:",r)},ze=r=>{switch(console.log(`Option selected: ${r}`),r){case"goto":if(S.value){const ce=t.coordinates.altitude??0,fe=S.value[0],Re=S.value[1];ct(()=>{t.goTo(0,0,0,0,fe,Re,ce)},{command:"GoTo"},ft(mt.GOTO))}break;default:console.warn("Unknown menu option selected:",r)}te.value=!1};return(r,m)=>(N(),me(Me,null,[L(p(Ve),{ref_key:"map",ref:h,modelValue:n.value,"onUpdate:modelValue":m[6]||(m[6]=v=>n.value=v),zoom:n.value,"onUpdate:zoom":m[7]||(m[7]=v=>n.value=v),bounds:f.value,"onUpdate:bounds":m[8]||(m[8]=v=>f.value=v),center:c.value,"onUpdate:center":m[9]||(m[9]=v=>c.value=v),"max-zoom":19,class:"map",onReady:I,onClick:ue},{default:_(()=>[S.value?(N(),J(p(Y),{key:0,"lat-lng":S.value},{default:_(()=>[L(p(ge),null,{default:_(()=>[E("div",null,"coordinates: "+R(S.value),1)]),_:1})]),_:1},8,["lat-lng"])):q("",!0),L(Ae,{location:"top center",text:"Home position is currently undefined",disabled:!!s.value},{activator:_(({props:v})=>[L(ae,Ce({class:["absolute left-0 m-3 bottom-12 bg-slate-50",s.value?"":"active-events-on-disabled"],color:d.value==p(B).HOME?"red":"",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-home-map-marker",size:"x-small"},v,{disabled:!s.value,onClick:m[0]||(m[0]=H(k=>p(u).goToTarget(p(B).HOME,!0),["stop"])),onDblclick:m[1]||(m[1]=H(k=>p(u).follow(p(B).HOME),["stop"]))}),null,16,["class","color","disabled"])]),_:1},8,["disabled"]),te.value?(N(),me("div",{key:1,class:"context-menu",style:tt({top:oe.top,left:oe.left})},[E("ul",{onClick:m[3]||(m[3]=H(()=>{},["stop"]))},[E("li",{onClick:m[2]||(m[2]=v=>ze("goto"))},"GoTo")])],4)):q("",!0),L(Ae,{location:"top center",text:"Vehicle position is currently undefined",disabled:!!l.value},{activator:_(({props:v})=>[L(ae,Ce({class:["absolute m-3 bottom-12 left-10 bg-slate-50",l.value?"":"active-events-on-disabled"],color:d.value==p(B).VEHICLE?"red":"",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-airplane-marker",size:"x-small"},v,{disabled:!l.value,onClick:m[4]||(m[4]=H(k=>p(u).goToTarget(p(B).VEHICLE,!0),["stop"])),onDblclick:m[5]||(m[5]=H(k=>p(u).follow(p(B).VEHICLE),["stop"]))}),null,16,["class","color","disabled"])]),_:1},8,["disabled"]),L(ae,{class:"absolute m-3 bottom-12 left-20 bg-slate-50",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-download",size:"x-small",onClick:H(z,["stop"])}),L(ae,{class:"absolute mb-3 ml-1 bottom-12 left-32 bg-slate-50",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-play",size:"x-small",onClick:H(Le,["stop"])}),(N(!0),me(Me,null,ot(p(o).currentPlanningWaypoints,(v,k)=>(N(),J(p(Y),{key:v.id,"lat-lng":v.coordinates},{default:_(()=>[L(p(ie),{"icon-anchor":[12,12],"class-name":"markerIcon"},{default:_(()=>[E("div",null,R(k),1)]),_:2},1024)]),_:2},1032,["lat-lng"]))),128)),L(p(ve),{"lat-lngs":p(o).currentPlanningWaypoints.map(v=>v.coordinates),color:"rgba(1, 1, 1, 0.5)"},null,8,["lat-lngs"]),s.value?(N(),J(p(Y),{key:2,"lat-lng":s.value},{default:_(()=>[L(p(ie),{"icon-size":[24,24]},{default:_(()=>[$t]),_:1})]),_:1},8,["lat-lng"])):q("",!0),L(p(Y),{"lat-lng":l.value??[0,0],name:"Vehicle"},{default:_(()=>[L(p(ge),null,{default:_(()=>{var v;return[E("p",null,"Coordinates: "+R(l.value??"No data available"),1),E("p",null,"Velocity: "+R(`${(v=p(t).velocity.ground)==null?void 0:v.toFixed(2)} m/s`??"No data available"),1),E("p",null,"Heading: "+R(`${g.value.toFixed(2)}°`??"No data available"),1),E("p",null,R(p(t).isArmed?"Armed":"Disarmed"),1),E("p",null,"Last seen: "+R(P.value),1)]}),_:1}),L(p(ie),{"icon-anchor":[50,50]},{default:_(()=>[L(pt,{type:p(t).vehicleType,heading:g.value},null,8,["type","heading"])]),_:1})]),_:1},8,["lat-lng"]),p(V).options.showVehiclePath?(N(),J(p(ve),{key:3,"lat-lngs":y.value},null,8,["lat-lngs"])):q("",!0),L(p(je),{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})]),_:1},8,["modelValue","zoom","bounds","center"]),L(rt,{modelValue:p(V).managerVars.configMenuOpen,"onUpdate:modelValue":m[11]||(m[11]=v=>p(V).managerVars.configMenuOpen=v),width:"auto"},{default:_(()=>[L(nt,{class:"pa-2"},{default:_(()=>[L(at,null,{default:_(()=>[lt("Map widget settings")]),_:1}),L(st,null,{default:_(()=>[L(it,{modelValue:p(V).options.showVehiclePath,"onUpdate:modelValue":m[10]||(m[10]=v=>p(V).options.showVehiclePath=v),class:"my-1",label:"Show vehicle path",color:p(V).options.showVehiclePath?"rgb(0, 20, 80)":void 0,"hide-details":""},null,8,["modelValue","color"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i.value?(N(),J(ut,{key:0,"model-value":b.value,height:"10",absolute:"",bottom:"",color:"rgba(0, 110, 255, 0.8)"},null,8,["model-value"])):q("",!0)],64))}});export{Rt as default};
