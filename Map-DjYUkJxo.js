import{bK as Pe,bL as Fe,bM as We,bN as ae,bO as Ze,bP as Se,bQ as Ge,bR as Xe,q as L,bA as _,y as F,bS as I,bT as ue,aX as De,bG as x,af as j,aj as Q,k as U,v as ye,aQ as Je,d as qe,bH as Ye,p as Te,D as _e,u as Ke,bU as Qe,a_ as et,x as tt,bV as D,aH as ot,aL as nt,aG as at,f as lt,o as N,c as me,h as w,B as A,i as q,b as p,a as E,t as R,j as Y,w as Ae,M as le,n as Ce,al as H,ao as st,K as Me,L as it,V as rt,C as ut,N as dt,F as ct,b1 as ft,O as mt,aa as pt,bW as yt,aN as Ee,s as vt,e as gt,E as bt}from"./index-Bnhf3bsQ.js";import{_ as ht}from"./VehicleIcon.vue_vue_type_script_setup_true_lang-gG1xcKcl.js";function Ie(e,t){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}function Lt(e){return Ie({},e)}var Be=1440,wt=2520,pe=43200,Ot=86400;function St(e,t,o){var n,f;Pe(2,arguments);var c=Xe(),s=(n=(f=o==null?void 0:o.locale)!==null&&f!==void 0?f:c.locale)!==null&&n!==void 0?n:Fe;if(!s.formatDistance)throw new RangeError("locale must contain formatDistance property");var d=We(e,t);if(isNaN(d))throw new RangeError("Invalid time value");var l=Ie(Lt(o),{addSuffix:!!(o!=null&&o.addSuffix),comparison:d}),v,a;d>0?(v=ae(t),a=ae(e)):(v=ae(e),a=ae(t));var y=Ze(a,v),B=(Se(a)-Se(v))/1e3,u=Math.round((y-B)/60),h;if(u<2)return o!=null&&o.includeSeconds?y<5?s.formatDistance("lessThanXSeconds",5,l):y<10?s.formatDistance("lessThanXSeconds",10,l):y<20?s.formatDistance("lessThanXSeconds",20,l):y<40?s.formatDistance("halfAMinute",0,l):y<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):u===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",u,l);if(u<45)return s.formatDistance("xMinutes",u,l);if(u<90)return s.formatDistance("aboutXHours",1,l);if(u<Be){var S=Math.round(u/60);return s.formatDistance("aboutXHours",S,l)}else{if(u<wt)return s.formatDistance("xDays",1,l);if(u<pe){var C=Math.round(u/Be);return s.formatDistance("xDays",C,l)}else if(u<Ot)return h=Math.round(u/pe),s.formatDistance("aboutXMonths",h,l)}if(h=Ge(a,v),h<12){var T=Math.round(u/pe);return s.formatDistance("xMonths",T,l)}else{var P=h%12,O=Math.floor(h/12);return P<3?s.formatDistance("aboutXYears",O,l):P<9?s.formatDistance("overXYears",O,l):s.formatDistance("almostXYears",O+1,l)}}function Tt(e,t){return Pe(1,arguments),St(e,Date.now(),t)}const ke=(e,t)=>{let o;return function(...n){const f=this;o&&clearTimeout(o),o=setTimeout(()=>{e.apply(f,n),o=null},t)}},_t=e=>!e||typeof e.charAt!="function"?e:e.charAt(0).toUpperCase()+e.slice(1),Z=(e,t,o)=>{for(const n in o){const f="set"+_t(n);e[f]?ye(()=>o[n],(c,s)=>{e[f](c,s)}):t[f]&&ye(()=>o[n],c=>{t[f](c)})}},G=e=>{const t={};for(const o in e)if(o.startsWith("on")&&!o.startsWith("onUpdate")&&o!=="onReady"){const n=o.slice(2).toLocaleLowerCase();t[n]=e[o]}return t},At=async e=>{const t=await Promise.all([I(()=>import("./marker-icon-2x-D4k_ikNW.js"),[],import.meta.url),I(()=>import("./marker-icon-C2eJqgqv.js"),[],import.meta.url),I(()=>import("./marker-shadow-DU6CIJ0p.js"),[],import.meta.url)]);delete e.Default.prototype._getIconUrl,e.Default.mergeOptions({iconRetinaUrl:t[0].default,iconUrl:t[1].default,shadowUrl:t[2].default})},se=e=>{const t=L(()=>console.warn(`Method ${e} has been invoked without being replaced`)),o=(...n)=>t.value(...n);return o.wrapped=t,x(e,o),o},ie=(e,t)=>e.wrapped.value=t,$=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||void 0,X="useGlobalLeaflet",ee={options:{type:Object,default:()=>({})}},te=e=>({options:e.options,methods:{}}),be={...ee,pane:{type:String,default:"overlayPane"},attribution:{type:String,default:null},name:{type:String,custom:!0,default:void 0},layerType:{type:String,custom:!0,default:void 0},visible:{type:Boolean,custom:!0,default:!0}},he=(e,t,o)=>{const n=_("addLayer"),f=_("removeLayer"),{options:c,methods:s}=te(e),d={...c,attribution:e.attribution,pane:e.pane},l=()=>n({leafletObject:t.value}),v=()=>f({leafletObject:t.value}),a={...s,setAttribution(y,B){this.$parent.leafletObject.attributionControl.removeAttribution(B).addAttribution(y)},setName(){v(),e.visible&&l()},setLayerType(){v(),e.visible&&l()},setVisible(y){t.value&&(y?l():v())},bindPopup({leafletObject:y}){t.value.bindPopup(y)},bindTooltip({leafletObject:y}){t.value.bindTooltip(y)},unbindTooltip(){const y=t.value?t.value.getTooltip():null;y&&y.unbindTooltip()},unbindPopup(){const y=t.value?t.value.getPopup():null;y&&y.unbindPopup()},updateVisibleProp(y){o.emit("update:visible",y)}};return x("bindPopup",a.bindPopup),x("bindTooltip",a.bindTooltip),x("unbindTooltip",a.unbindTooltip),x("unbindPopup",a.unbindPopup),Je(()=>{a.unbindPopup(),a.unbindTooltip(),v()}),{options:d,methods:a}},xe=(e,t)=>{if(e&&t.default)return ue("div",{style:{display:"none"}},t.default())},Ct={...ee,interactive:{type:Boolean,default:!0},bubblingMouseEvents:{type:Boolean,default:!0}},Mt=e=>{const{options:t,methods:o}=te(e);return{options:{...t,interactive:e.interactive,bubblingMouseEvents:e.bubblingMouseEvents},methods:o}},Et={...be,...Ct,stroke:{type:Boolean,custom:!0,default:!0},color:{type:String,custom:!0,default:"#3388ff"},weight:{type:Number,custom:!0,default:3},opacity:{type:Number,custom:!0,default:1},lineCap:{type:String,custom:!0,default:"round"},lineJoin:{type:String,custom:!0,default:"round"},dashArray:{type:String,custom:!0,default:null},dashOffset:{type:String,custom:!0,default:null},fill:{type:Boolean,custom:!0,default:!1},fillColor:{type:String,custom:!0,default:"#3388ff"},fillOpacity:{type:Number,custom:!0,default:.2},fillRule:{type:String,custom:!0,default:"evenodd"},className:{type:String,custom:!0,default:null}},Bt=(e,t,o)=>{const{options:n,methods:f}=he(e,t,o),{options:c,methods:s}=Mt(e),d=_("removeLayer"),l={...n,...c,stroke:e.stroke,color:e.color,weight:e.weight,opacity:e.opacity,lineCap:e.lineCap,lineJoin:e.lineJoin,dashArray:e.dashArray,dashOffset:e.dashOffset,fill:e.fill,fillColor:e.fillColor,fillOpacity:e.fillOpacity,fillRule:e.fillRule,className:e.className},v={...f,...s,setStroke(a){t.value.setStyle({stroke:a})},setColor(a){t.value.setStyle({color:a})},setWeight(a){t.value.setStyle({weight:a})},setOpacity(a){t.value.setStyle({opacity:a})},setLineCap(a){t.value.setStyle({lineCap:a})},setLineJoin(a){t.value.setStyle({lineJoin:a})},setDashArray(a){t.value.setStyle({dashArray:a})},setDashOffset(a){t.value.setStyle({dashOffset:a})},setFill(a){t.value.setStyle({fill:a})},setFillColor(a){t.value.setStyle({fillColor:a})},setFillOpacity(a){t.value.setStyle({fillOpacity:a})},setFillRule(a){t.value.setStyle({fillRule:a})},setClassName(a){t.value.setStyle({className:a})}};return Q(()=>{d({leafletObject:t.value})}),{options:l,methods:v}},Pt={...be,pane:{type:String,default:"tilePane"},opacity:{type:Number,custom:!1,default:1},zIndex:{type:Number,default:1},tileSize:{type:Number,default:256},noWrap:{type:Boolean,default:!1},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:void 0}},Dt=(e,t,o)=>{const{options:n,methods:f}=he(e,t,o);return{options:{...n,pane:e.pane,opacity:e.opacity,zIndex:e.zIndex,tileSize:e.tileSize,noWrap:e.noWrap,minZoom:e.minZoom,maxZoom:e.maxZoom},methods:{...f}}},It={iconUrl:{type:String,custom:!0,default:null},iconRetinaUrl:{type:String,custom:!0,default:null},iconSize:{type:[Object,Array],custom:!0,default:null},iconAnchor:{type:[Object,Array],custom:!0,default:null},popupAnchor:{type:[Object,Array],custom:!0,default:()=>[0,0]},tooltipAnchor:{type:[Object,Array],custom:!0,default:()=>[0,0]},shadowUrl:{type:String,custom:!0,default:null},shadowRetinaUrl:{type:String,custom:!0,default:null},shadowSize:{type:[Object,Array],custom:!0,default:null},shadowAnchor:{type:[Object,Array],custom:!0,default:null},bgPos:{type:[Object,Array],custom:!0,default:()=>[0,0]},className:{type:String,custom:!0,default:""},options:{type:Object,custom:!0,default:()=>({})}};var re={name:"LIcon",props:{...It,...ee},setup(e,t){const o=L(null),n=_(X),f=_("canSetParentHtml"),c=_("setParentHtml"),s=_("setIcon");let d,l,v,a,y;const B=(C,T,P)=>{const O=C&&C.innerHTML;if(!T){P&&y&&f()&&c(O);return}const M=G(t.attrs);y&&l(y,M);const{options:W}=te(e),i={...W,iconUrl:e.iconUrl,iconRetinaUrl:e.iconRetinaUrl,iconSize:e.iconSize,iconAnchor:e.iconAnchor,popupAnchor:e.popupAnchor,tooltipAnchor:e.tooltipAnchor,shadowUrl:e.shadowUrl,shadowRetinaUrl:e.shadowRetinaUrl,shadowSize:e.shadowSize,shadowAnchor:e.shadowAnchor,bgPos:e.bgPos,className:e.className,html:O||e.html};y=i.html?v(i):a(i),d(y,M),s(y)},u=()=>{j(()=>B(o.value,!0,!1))},h=()=>{j(()=>B(o.value,!1,!0))},S={setIconUrl:u,setIconRetinaUrl:u,setIconSize:u,setIconAnchor:u,setPopupAnchor:u,setTooltipAnchor:u,setShadowUrl:u,setShadowRetinaUrl:u,setShadowAnchor:u,setBgPos:u,setClassName:u,setHtml:u};return F(async()=>{const{DomEvent:C,divIcon:T,icon:P}=n?$.L:await I(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);d=C.on,l=C.off,v=T,a=P,Z(S,{},e),new MutationObserver(h).observe(o.value,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),u()}),{root:o}},render(){const e=this.$slots.default?this.$slots.default():void 0;return ue("div",{ref:"root"},e)}};re.__file="src/components/LIcon.vue";var Ve={emits:["ready","update:zoom","update:center","update:bounds"],props:{...ee,center:{type:[Object,Array],default:()=>[0,0]},bounds:{type:[Array,Object],default:void 0},maxBounds:{type:[Array,Object],default:void 0},zoom:{type:Number,default:0},minZoom:{type:Number,default:void 0},maxZoom:{type:Number,default:void 0},paddingBottomRight:{type:Array,default:void 0},paddingTopLeft:{type:Array,default:void 0},padding:{type:Array,default:void 0},worldCopyJump:{type:Boolean,default:!1},crs:{type:[String,Object],default:"EPSG3857"},maxBoundsViscosity:{type:Number,default:void 0},inertia:{type:Boolean,default:void 0},inertiaDeceleration:{type:Number,default:void 0},inertiaMaxSpeed:{type:Number,default:void 0},easeLinearity:{type:Number,default:void 0},zoomAnimation:{type:Boolean,default:void 0},zoomAnimationThreshold:{type:Number,default:void 0},fadeAnimation:{type:Boolean,default:void 0},markerZoomAnimation:{type:Boolean,default:void 0},noBlockingAnimations:{type:Boolean,default:!1},useGlobalLeaflet:{type:Boolean,default:!1}},setup(e,t){const o=L(null),n=De({ready:!1,leafletRef:{},layersToAdd:[],layersInControl:[]}),{options:f}=te(e),c={...f,minZoom:e.minZoom,maxZoom:e.maxZoom,maxBounds:e.maxBounds,maxBoundsViscosity:e.maxBoundsViscosity,worldCopyJump:e.worldCopyJump,crs:e.crs,center:e.center,zoom:e.zoom,inertia:e.inertia,inertiaDeceleration:e.inertiaDeceleration,inertiaMaxSpeed:e.inertiaMaxSpeed,easeLinearity:e.easeLinearity,zoomAnimation:e.zoomAnimation,zoomAnimationThreshold:e.zoomAnimationThreshold,fadeAnimation:e.fadeAnimation,markerZoomAnimation:e.markerZoomAnimation},s=se("addLayer"),d=se("removeLayer"),l=se("registerControl"),v=se("registerLayerControl");x(X,e.useGlobalLeaflet);const a={moveEndHandler(){t.emit("update:zoom",n.leafletRef.getZoom()),t.emit("update:center",n.leafletRef.getCenter()),t.emit("update:bounds",n.leafletRef.getBounds())},overlayAddHandler(u){const h=n.layersInControl.find(S=>S.name===u.name);h&&h.updateVisibleProp(!0)},overlayRemoveHandler(u){const h=n.layersInControl.find(S=>S.name===u.name);h&&h.updateVisibleProp(!1)}};F(async()=>{e.useGlobalLeaflet&&($.L=$.L||await I(()=>import("./index-Bnhf3bsQ.js").then(i=>i.l),[],import.meta.url));const{map:u,CRS:h,Icon:S,latLngBounds:C,latLng:T,DomEvent:P}=e.useGlobalLeaflet?$.L:await I(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);try{c.beforeMapMount&&await c.beforeMapMount()}catch(i){console.error(`The following error occurred running the provided beforeMapMount hook ${i.message}`)}await At(S);const O=typeof c.crs=="string"?h[c.crs]:c.crs;c.crs=O||h.EPSG3857;const M={addLayer(i){i.layerType!==void 0&&(n.layerControl===void 0?n.layersToAdd.push(i):n.layersInControl.find(z=>z.leafletObject._leaflet_id===i.leafletObject._leaflet_id)||(n.layerControl.addLayer(i),n.layersInControl.push(i))),i.visible!==!1&&n.leafletRef.addLayer(i.leafletObject)},removeLayer(i){i.layerType!==void 0&&(n.layerControl===void 0?n.layersToAdd=n.layersToAdd.filter(b=>b.name!==i.name):(n.layerControl.removeLayer(i.leafletObject),n.layersInControl=n.layersInControl.filter(b=>b.leafletObject._leaflet_id!==i.leafletObject._leaflet_id))),n.leafletRef.removeLayer(i.leafletObject)},registerLayerControl(i){n.layerControl=i,n.layersToAdd.forEach(b=>{n.layerControl.addLayer(b)}),n.layersToAdd=[],l(i)},registerControl(i){n.leafletRef.addControl(i.leafletObject)},setZoom(i){const b=n.leafletRef.getZoom();i!==b&&n.leafletRef.setZoom(i,{animate:e.noBlockingAnimations?!1:null})},setPaddingBottomRight(i){n.paddingBottomRight=i},setPaddingTopLeft(i){n.paddingTopLeft=i},setPadding(i){n.padding=i},setCrs(i){const b=n.leafletRef.getBounds();n.leafletRef.options.crs=i,n.leafletRef.fitBounds(b,{animate:!1,padding:[0,0]})},fitBounds(i){n.leafletRef.fitBounds(i,{animate:this.noBlockingAnimations?!1:null})},setBounds(i){if(!i)return;const b=C(i);if(!b.isValid())return;!(n.lastSetBounds||n.leafletRef.getBounds()).equals(b,0)&&(n.lastSetBounds=b,n.leafletRef.fitBounds(b,this.fitBoundsOptions))},setCenter(i){if(i==null)return;const b=T(i),z=n.lastSetCenter||n.leafletRef.getCenter();(z.lat!==b.lat||z.lng!==b.lng)&&(n.lastSetCenter=b,n.leafletRef.panTo(b,{animate:this.noBlockingAnimations?!1:null}))}};ie(s,M.addLayer),ie(d,M.removeLayer),ie(l,M.registerControl),ie(v,M.registerLayerControl),n.leafletRef=u(o.value,c),Z(M,n.leafletRef,e);const W=G(t.attrs);n.leafletRef.on("moveend",ke(a.moveEndHandler,100)),n.leafletRef.on("overlayadd",a.overlayAddHandler),n.leafletRef.on("overlayremove",a.overlayRemoveHandler),P.on(n.leafletRef,W),n.ready=!0,j(()=>t.emit("ready",n.leafletRef))}),Q(()=>{n.leafletRef&&n.leafletRef.remove()});const y=U(()=>n.leafletRef),B=U(()=>n.ready);return{root:o,ready:B,leafletObject:y}},render(){return ue("div",{style:{width:"100%",height:"100%"},ref:"root"},this.ready?this.$slots.default():{})}};Ve.__file="src/components/LMap.vue";const kt={...be,pane:{type:String,default:"markerPane"},draggable:{type:Boolean,custom:!0,default:!1},latLng:{type:[Object,Array],custom:!0,default:null},icon:{type:[Object],default:()=>{},custom:!1},zIndexOffset:{type:Number,custom:!1,default:null}},xt=(e,t,o)=>{const{options:n,methods:f}=he(e,t,o),c={...n,...e},s={...f,setDraggable(d){t.value.dragging&&(d?t.value.dragging.enable():t.value.dragging.disable())},latLngSync(d){o.emit("update:latLng",d.latlng),o.emit("update:lat-lng",d.latlng)},setLatLng(d){if(d!=null&&t.value){const l=t.value.getLatLng();(!l||!l.equals(d))&&t.value.setLatLng(d)}}};return{options:c,methods:s}};var K={name:"LMarker",props:kt,setup(e,t){const o=L({}),n=L(!1),f=_(X),c=_("addLayer");x("canSetParentHtml",()=>!!o.value.getElement()),x("setParentHtml",l=>o.value.getElement().innerHTML=l),x("setIcon",l=>o.value.setIcon&&o.value.setIcon(l));const{options:s,methods:d}=xt(e,o,t);return s.icon===void 0&&delete s.icon,F(async()=>{const{marker:l,DomEvent:v}=f?$.L:await I(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);o.value=l(e.latLng,s);const a=G(t.attrs);v.on(o.value,a),o.value.on("move",ke(d.latLngSync,100)),Z(d,o.value,e),c({...e,...d,leafletObject:o.value}),n.value=!0,j(()=>t.emit("ready",o.value))}),{ready:n,leafletObject:o}},render(){return xe(this.ready,this.$slots)}};K.__file="src/components/LMarker.vue";const Ne={...Et,latLngs:{type:Array,default:()=>[]},smoothFactor:{type:Number,custom:!0,default:1},noClip:{type:Boolean,custom:!0,default:!1}},Vt=(e,t,o)=>{const{options:n,methods:f}=Bt(e,t,o),c={...n,...e},s={...f,setSmoothFactor(d){t.value.setStyle({smoothFactor:d})},setNoClip(d){t.value.setStyle({noClip:d})},addLatLng(d){t.value.addLatLng(d)}};return{options:c,methods:s}};({...Ne});var ve={name:"LPolyline",props:Ne,setup(e,t){const o=L({}),n=L(!1),f=_(X),c=_("addLayer"),{options:s,methods:d}=Vt(e,o,t);return F(async()=>{const{polyline:l,DomEvent:v}=f?$.L:await I(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);o.value=l(e.latLngs,s);const a=G(t.attrs);v.on(o.value,a),Z(d,o.value,e),c({...e,...d,leafletObject:o.value}),n.value=!0,j(()=>t.emit("ready",o.value))}),{ready:n,leafletObject:o}},render(){return xe(this.ready,this.$slots)}};ve.__file="src/components/LPolyline.vue";const Nt={...ee,content:{type:String,default:null}},$t=(e,t)=>{const{options:o,methods:n}=te(e),f={...n,setContent(c){t.value&&c!==null&&c!==void 0&&t.value.setContent(c)}};return{options:o,methods:f}},jt=e=>e.default?ue("div",{ref:"root"},e.default()):null,$e={...Pt,tms:{type:Boolean,default:!1},subdomains:{type:String,default:"abc"},detectRetina:{type:Boolean,default:!1},url:{type:String,default:null}},zt=(e,t)=>{const{options:o,methods:n}=Dt(e,t);return{options:{...o,tms:e.tms,subdomains:e.subdomains,detectRetina:e.detectRetina},methods:{...n}}};var je={props:$e,setup(e,t){const o=L({}),n=_(X),f=_("addLayer"),{options:c,methods:s}=zt(e,o);return F(async()=>{const{tileLayer:d,DomEvent:l}=n?$.L:await I(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);o.value=d(e.url,c);const v=G(t.attrs);l.on(o.value,v),Z(s,o.value,e),f({...e,...s,leafletObject:o.value}),j(()=>t.emit("ready",o.value))}),{leafletObject:o}},render(){return null}};je.__file="src/components/LTileLayer.vue";const Rt={...Nt},Ht=(e,t)=>{const{options:o,methods:n}=$t(e,t),f=_("unbindTooltip");return Q(()=>{f()}),{options:o,methods:n}};var ge={name:"LTooltip",props:Rt,setup(e,t){const o=L({}),n=L(null),f=_(X),c=_("bindTooltip"),{options:s,methods:d}=Ht(e,o);return F(async()=>{const{tooltip:l,DomEvent:v}=f?$.L:await I(()=>import("./leaflet-src.esm-mmL8ao-y.js"),[],import.meta.url);o.value=l(s),Z(d,o.value,e);const a=G(t.attrs);v.on(o.value,a),o.value.setContent(e.content||n.value),c({leafletObject:o.value}),j(()=>t.emit("ready",o.value))}),{root:n,leafletObject:o}},render(){return jt(this.$slots)}};ge.__file="src/components/LTooltip.vue";({...$e});const Ut=E("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[E("path",{fill:"blue",d:`M12 3L2 12h3v8h14v-8h3L12 3m0 4.7c2.1 0 3.8 1.7
            3.8 3.8c0 3-3.8 6.5-3.8 6.5s-3.8-3.5-3.8-6.5c0-2.1
            1.7-3.8 3.8-3.8m0 2.3a1.5 1.5 0 0 0-1.5 1.5A1.5 1.5
            0 0 0 12 13a1.5 1.5 0 0 0 1.5-1.5A1.5 1.5 0 0 0 12 10Z`})],-1),Zt=qe({__name:"Map",props:{widget:{}},setup(e){var Oe;Ye(r=>({d135be0e:He.value})),Te.registerUsage(_e.latitude),Te.registerUsage(_e.longitude);const t=Ke(),o=Qe(),n=L(18),f=L(null),c=L([-27.5935,-48.55854]),s=L(c.value),d=L(void 0),l=U(()=>t.coordinates.latitude?[t.coordinates.latitude,t.coordinates.longitude]:void 0),v=U(()=>{var r;return t.attitude.yaw?et((r=t.attitude)==null?void 0:r.yaw):0}),{history:a}=tt(l),y=U(()=>a.value.filter(r=>r.snapshot!==void 0).map(r=>r.snapshot)),B=U(()=>{const r=t.lastHeartbeat;return r?`${Tt(r??0,{includeSeconds:!0})} ago`:"never"}),u=new yt(r=>d.value=r,r=>c.value=r);u.setTrackableTarget(D.VEHICLE,()=>l.value),u.setTrackableTarget(D.HOME,()=>s.value);const h=L(null),S=L(null);let C=!0;(Oe=navigator==null?void 0:navigator.geolocation)==null||Oe.watchPosition(r=>{s.value=[r.coords.latitude,r.coords.longitude],C&&(u.goToTarget(D.HOME),C=S.value!==null)},r=>{console.error(`Failed to get position: (${r.code}) ${r.message}`)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:0});let T=null;const P=async()=>{var r,m;if(await j(),T=(r=h.value)==null?void 0:r.leafletObject,!T){console.warn("Failed to get leaflet reference");return}if(S.value=(m=h.value)==null?void 0:m.leafletObject,T.on("click",de),S.value==null){console.warn("Failed to get leaflet reference");return}S.value.zoomControl.setPosition("bottomright"),T.on("contextmenu",()=>{M()}),setTimeout(()=>u.goToTarget(D.HOME),2e3)},O=L(null),M=()=>{oe.value=!1,O.value=null},W=r=>{r.key==="Escape"&&M()};F(()=>{window.addEventListener("keydown",W)});const i=L(!1),b=L(0),z=async()=>{for(i.value=!0,b.value=0;o.currentPlanningWaypoints.length>0;)o.currentPlanningWaypoints.pop();const r=async m=>{b.value=m};try{(await t.fetchMission(r)).forEach(V=>{o.currentPlanningWaypoints.push(V),Ee.fire({icon:"success",title:"Mission download succeed!",timer:2e3})})}catch(m){Ee.fire({icon:"error",title:"Mission download failed",text:m,timer:5e3})}finally{i.value=!1}},Le=()=>{t.startMission()},we=e,k=ot(we).widget;ye(we.widget,()=>{var r;(r=S.value)==null||r.invalidateSize()}),nt(()=>{Object.keys(k.value.options).length===0&&(k.value.options={showVehiclePath:!0}),u.enableAutoUpdate()}),Q(()=>{u.disableAutoUpdate(),T&&T.off("click",de)}),Q(()=>{window.removeEventListener("keydown",W),T&&T.off("contextmenu")});const oe=L(!1),ne=De({top:"0px",left:"0px"}),de=r=>{var m,V,g;if(console.debug("Map click event:",r),((m=r==null?void 0:r.latlng)==null?void 0:m.lat)!=null&&((V=r==null?void 0:r.latlng)==null?void 0:V.lng)!=null){O.value=[r.latlng.lat,r.latlng.lng],oe.value=!0;const J=(g=S.value)==null?void 0:g.getContainer();if(J){const{x:ce,y:fe}=J.getBoundingClientRect();ne.left=`${r.originalEvent.clientX-ce}px`,ne.top=`${r.originalEvent.clientY-fe}px`}}else console.error("Invalid event structure:",r)},ze=r=>{switch(console.debug(`Map context menu option selected: ${r}.`),r){case"goto":if(O.value){const ce=t.coordinates.altitude??0,fe=O.value[0],Ue=O.value[1];vt(()=>{t.goTo(0,0,0,0,fe,Ue,ce)},{command:"GoTo"},gt(bt.GOTO))}break;default:console.warn("Unknown menu option selected:",r)}oe.value=!1},Re=at(),He=U(()=>`${Re.widgetBottomClearanceForVisibleArea(k.value)}px`);return(r,m)=>{const V=lt("tooltip");return N(),me(Me,null,[w(p(Ve),{ref_key:"map",ref:h,modelValue:n.value,"onUpdate:modelValue":m[6]||(m[6]=g=>n.value=g),zoom:n.value,"onUpdate:zoom":m[7]||(m[7]=g=>n.value=g),bounds:f.value,"onUpdate:bounds":m[8]||(m[8]=g=>f.value=g),center:c.value,"onUpdate:center":m[9]||(m[9]=g=>c.value=g),"max-zoom":19,class:"map",onReady:P,onClick:de},{default:A(()=>[O.value?(N(),q(p(K),{key:0,"lat-lng":O.value},{default:A(()=>[w(p(ge),null,{default:A(()=>[E("div",null,"coordinates: "+R(O.value),1)]),_:1})]),_:1},8,["lat-lng"])):Y("",!0),Ae(w(le,{class:Ce(["absolute left-0 m-3 bottom-button bg-slate-50",s.value?"":"active-events-on-disabled"]),color:d.value==p(D).HOME?"red":"",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-home-map-marker",size:"x-small",disabled:!s.value,onClick:m[0]||(m[0]=H(g=>p(u).goToTarget(p(D).HOME,!0),["stop"])),onDblclick:m[1]||(m[1]=H(g=>p(u).follow(p(D).HOME),["stop"]))},null,8,["class","color","disabled"]),[[V,s.value?void 0:"Home position is currently undefined"]]),oe.value?(N(),me("div",{key:1,class:"context-menu",style:st({top:ne.top,left:ne.left})},[E("ul",{onClick:m[3]||(m[3]=H(()=>{},["stop"]))},[E("li",{onClick:m[2]||(m[2]=g=>ze("goto"))},"GoTo")])],4)):Y("",!0),Ae(w(le,{class:Ce(["absolute m-3 bottom-button left-10 bg-slate-50",l.value?"":"active-events-on-disabled"]),color:d.value==p(D).VEHICLE?"red":"",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-airplane-marker",size:"x-small",disabled:!l.value,onClick:m[4]||(m[4]=H(g=>p(u).goToTarget(p(D).VEHICLE,!0),["stop"])),onDblclick:m[5]||(m[5]=H(g=>p(u).follow(p(D).VEHICLE),["stop"]))},null,8,["class","color","disabled"]),[[V,l.value?void 0:"Vehicle position is currently undefined"]]),w(le,{class:"absolute m-3 bottom-button left-20 bg-slate-50",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-download",size:"x-small",onClick:H(z,["stop"])}),w(le,{class:"absolute mb-3 ml-1 bottom-button left-32 bg-slate-50",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-play",size:"x-small",onClick:H(Le,["stop"])}),(N(!0),me(Me,null,it(p(o).currentPlanningWaypoints,(g,J)=>(N(),q(p(K),{key:g.id,"lat-lng":g.coordinates},{default:A(()=>[w(p(re),{"icon-anchor":[12,12],"class-name":"markerIcon"},{default:A(()=>[E("div",null,R(J),1)]),_:2},1024)]),_:2},1032,["lat-lng"]))),128)),w(p(ve),{"lat-lngs":p(o).currentPlanningWaypoints.map(g=>g.coordinates),color:"rgba(1, 1, 1, 0.5)"},null,8,["lat-lngs"]),s.value?(N(),q(p(K),{key:2,"lat-lng":s.value},{default:A(()=>[w(p(re),{"icon-size":[24,24]},{default:A(()=>[Ut]),_:1})]),_:1},8,["lat-lng"])):Y("",!0),w(p(K),{"lat-lng":l.value??[0,0],name:"Vehicle"},{default:A(()=>[w(p(ge),null,{default:A(()=>{var g;return[E("p",null,"Coordinates: "+R(l.value??"No data available"),1),E("p",null,"Velocity: "+R(`${(g=p(t).velocity.ground)==null?void 0:g.toFixed(2)} m/s`??"No data available"),1),E("p",null,"Heading: "+R(`${v.value.toFixed(2)}°`??"No data available"),1),E("p",null,R(p(t).isArmed?"Armed":"Disarmed"),1),E("p",null,"Last seen: "+R(B.value),1)]}),_:1}),w(p(re),{"icon-anchor":[50,50]},{default:A(()=>[w(ht,{type:p(t).vehicleType,heading:v.value},null,8,["type","heading"])]),_:1})]),_:1},8,["lat-lng"]),p(k).options.showVehiclePath?(N(),q(p(ve),{key:3,"lat-lngs":y.value},null,8,["lat-lngs"])):Y("",!0),w(p(je),{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})]),_:1},8,["modelValue","zoom","bounds","center"]),w(mt,{modelValue:p(k).managerVars.configMenuOpen,"onUpdate:modelValue":m[11]||(m[11]=g=>p(k).managerVars.configMenuOpen=g),width:"auto"},{default:A(()=>[w(rt,{class:"pa-2"},{default:A(()=>[w(ut,null,{default:A(()=>[dt("Map widget settings")]),_:1}),w(ct,null,{default:A(()=>[w(ft,{modelValue:p(k).options.showVehiclePath,"onUpdate:modelValue":m[10]||(m[10]=g=>p(k).options.showVehiclePath=g),class:"my-1",label:"Show vehicle path",color:p(k).options.showVehiclePath?"rgb(0, 20, 80)":void 0,"hide-details":""},null,8,["modelValue","color"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i.value?(N(),q(pt,{key:0,"model-value":b.value,height:"10",absolute:"",bottom:"",color:"rgba(0, 110, 255, 0.8)"},null,8,["model-value"])):Y("",!0)],64)}}});export{Zt as default};
