import{bM as M,bJ as _,aY as K,aZ as J,be as Q,a$ as Y,k as B,bN as q,c as fe,K as pe,y as ge,J as be,r as $,L as ve,o as he,bO as ye,au as Ve,w as C,aB as ke,aF as we,aH as Se,aE as xe,l as T,m as E,q as s,n as m,H as r,N as d,ah as Ce,aQ as R,a2 as F,O as L,V as G,aI as W,U as I,S as Le,a5 as Me,Q as Ne,a6 as Pe,F as je,aw as $e,_ as Te}from"./index-Cd73DPCK.js";const Z=M.reduce((t,i)=>(t[i]={type:[Boolean,String,Number],default:!1},t),{}),X=M.reduce((t,i)=>{const n="offset"+_(i);return t[n]={type:[String,Number],default:null},t},{}),ee=M.reduce((t,i)=>{const n="order"+_(i);return t[n]={type:[String,Number],default:null},t},{}),z={col:Object.keys(Z),offset:Object.keys(X),order:Object.keys(ee)};function Ee(t,i,n){let u=t;if(!(n==null||n===!1)){if(i){const e=i.replace(t,"");u+=`-${e}`}return t==="col"&&(u="v-"+u),t==="col"&&(n===""||n===!0)||(u+=`-${n}`),u.toLowerCase()}}const Ie=["auto","start","end","center","baseline","stretch"],Oe=K({cols:{type:[Boolean,String,Number],default:!1},...Z,offset:{type:[String,Number],default:null},...X,order:{type:[String,Number],default:null},...ee,alignSelf:{type:String,default:null,validator:t=>Ie.includes(t)},...J(),...Q()},"VCol"),O=Y()({name:"VCol",props:Oe(),setup(t,i){let{slots:n}=i;const u=B(()=>{const e=[];let f;for(f in z)z[f].forEach(p=>{const b=t[p],w=Ee(f,p,b);w&&e.push(w)});const g=e.some(p=>p.startsWith("v-col-"));return e.push({"v-col":!g||!t.cols,[`v-col-${t.cols}`]:t.cols,[`offset-${t.offset}`]:t.offset,[`order-${t.order}`]:t.order,[`align-self-${t.alignSelf}`]:t.alignSelf}),e});return()=>{var e;return q(t.tag,{class:[u.value,t.class],style:t.style},(e=n.default)==null?void 0:e.call(n))}}}),A=["start","end","center"],te=["space-between","space-around","space-evenly"];function D(t,i){return M.reduce((n,u)=>{const e=t+_(u);return n[e]=i(),n},{})}const Ue=[...A,"baseline","stretch"],le=t=>Ue.includes(t),ae=D("align",()=>({type:String,default:null,validator:le})),_e=[...A,...te],oe=t=>_e.includes(t),ne=D("justify",()=>({type:String,default:null,validator:oe})),Be=[...A,...te,"stretch"],se=t=>Be.includes(t),ie=D("alignContent",()=>({type:String,default:null,validator:se})),H={align:Object.keys(ae),justify:Object.keys(ne),alignContent:Object.keys(ie)},Ae={align:"align",justify:"justify",alignContent:"align-content"};function De(t,i,n){let u=Ae[t];if(n!=null){if(i){const e=i.replace(t,"");u+=`-${e}`}return u+=`-${n}`,u.toLowerCase()}}const Re=K({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:le},...ae,justify:{type:String,default:null,validator:oe},...ne,alignContent:{type:String,default:null,validator:se},...ie,...J(),...Q()},"VRow"),U=Y()({name:"VRow",props:Re(),setup(t,i){let{slots:n}=i;const u=B(()=>{const e=[];let f;for(f in H)H[f].forEach(g=>{const p=t[g],b=De(f,g,p);b&&e.push(b)});return e.push({"v-row--no-gutters":t.noGutters,"v-row--dense":t.dense,[`align-${t.align}`]:t.align,[`justify-${t.justify}`]:t.justify,[`align-content-${t.alignContent}`]:t.alignContent}),e});return()=>{var e;return q(t.tag,{class:["v-row",u.value,t.class],style:t.style},(e=n.default)==null?void 0:e.call(n))}}}),Fe={key:0,class:"w-full h-full flex items-center justify-center text-center text-white text-h5 font-weight-bold p-4 overflow-hidden"},Ge={key:1,class:"main"},We=["width","height"],ze={class:"ml-2"},He={class:"ml-2 flex gap-x-8"},Ke={class:"ml-2 flex gap-x-8"},Je={class:"flex w-full justify-end my-2"},Qe=fe({__name:"Plotter",props:{widget:{}},setup(t){const i=pe(),n=ge(),e=be(t).widget,f=$([]);let g;ve(()=>{const o={backgroundColor:"rgba(0, 0, 0, 0.7)",lineColor:"rgba(255, 0, 0, 1.0)",dataLakeVariableId:void 0,maxSamples:1e3,limitSamples:!0,lineThickness:1,decimalPlaces:2};e.value.options={...o,...e.value.options}}),he(()=>{b(e.value.options.dataLakeVariableId),f.value=Object.values(ye()).filter(o=>o.type==="number")});const p=()=>{e.value.options.limitSamples&&(c.length===e.value.options.maxSamples+1?c.shift():c.length>e.value.options.maxSamples&&c.splice(0,c.length-e.value.options.maxSamples))},b=(o,l)=>{if(o===void 0){console.error("No data lake variable ID provided!");return}l!==void 0&&g&&$e(l,g),g=Ve(o,a=>{c.push(a),p(),S()})};C([e.value.options.maxSamples,e.value.options.limitSamples],()=>{p(),S()}),C(()=>e.value.options.dataLakeVariableId,(o,l)=>{b(o,l),c.length=0});const{width:w,height:re}=ke(),y=B(()=>({width:e.value.size.width*w.value,height:e.value.size.height*re.value})),V=$(),N=$(),P=(o,l,a,v)=>{const k=o.measureText(l),h=4;o.fillStyle="rgba(0, 0, 0, 0.5)",o.fillRect(a-h,v-16-h,k.width+h*2,16+h*2),o.fillStyle=e.value.options.lineColor,o.fillText(l,a,v)},S=()=>{if(V.value===void 0||V.value===null)return;if(N.value===void 0){console.debug("Canvas context undefined!"),N.value=V.value.getContext("2d");return}const o=N.value,l=y.value.width,a=y.value.height;we(o),o.clearRect(0,0,l,a),o.fillStyle=e.value.options.backgroundColor,o.fillRect(0,0,l,a),o.strokeStyle=e.value.options.lineColor,o.lineWidth=Math.max(e.value.options.lineThickness,1);try{if(c.length===0)return;j=Math.max(...c),x=Math.min(...c);const v=c[c.length-1];o.beginPath(),o.moveTo(0,a),c.forEach((h,de)=>{const ce=de*(l/c.length),me=a-(h-x)/(j-x)*a;o.lineTo(ce,me)}),o.stroke(),o.font="14px monospace",o.textBaseline="bottom";const k=e.value.options.decimalPlaces;P(o,`Current: ${Number(v).toFixed(k)}`,10,a-10),P(o,`Min: ${Number(x).toFixed(k)}`,10,a-30),P(o,`Max: ${Number(j).toFixed(k)}`,10,a-50)}catch(v){console.error("Error drawing graph:",v)}},c=[];let j=0,x=0;C([y,e.value.options],()=>{n.isWidgetVisible(e.value)&&Se(()=>S())});const ue=xe(V);return C(ue,(o,l)=>{o&&!l&&S()}),(o,l)=>(T(),E(je,null,[s(e).options.dataLakeVariableId?(T(),E("div",Ge,[m("canvas",{ref_key:"canvasRef",ref:V,width:y.value.width,height:y.value.height},null,8,We)])):(T(),E("p",Fe," Please open the Plotter widget configuration menu to select a variable to be plotted. ")),r(Pe,{modelValue:s(n).widgetManagerVars(s(e).hash).configMenuOpen,"onUpdate:modelValue":l[8]||(l[8]=a=>s(n).widgetManagerVars(s(e).hash).configMenuOpen=a),title:"Plotter config",variant:"text-only"},{content:d(()=>[r(U,null,{default:d(()=>[r(O,{cols:"12"},{default:d(()=>[l[9]||(l[9]=m("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Source",-1)),m("div",ze,[r(Ce,{modelValue:s(e).options.dataLakeVariableId,"onUpdate:modelValue":l[0]||(l[0]=a=>s(e).options.dataLakeVariableId=a),items:f.value,"item-title":"name","item-value":"id",label:"Data Lake variable",hint:"Select a variable to be plotted","persistent-hint":"",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])])]),_:1})]),_:1}),r(U,null,{default:d(()=>[r(O,{cols:"12"},{default:d(()=>[l[12]||(l[12]=m("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Appearance",-1)),m("div",He,[r(R,{"close-on-content-click":!1},{activator:d(({props:a})=>[m("div",F(a,{class:"flex cursor-pointer"}),[l[10]||(l[10]=m("span",{class:"mt-1"},"Background color",-1)),m("div",{class:"w-[30px] h-[30px] border-2 border-slate-700 rounded-lg cursor-pointer ml-2",style:L({backgroundColor:s(e).options.backgroundColor})},null,4)],16)]),default:d(()=>[r(G,{class:"overflow-hidden",style:L(s(i).globalGlassMenuStyles)},{default:d(()=>[r(W,{modelValue:s(e).options.backgroundColor,"onUpdate:modelValue":l[1]||(l[1]=a=>s(e).options.backgroundColor=a),label:"Background","hide-inputs":""},null,8,["modelValue"])]),_:1},8,["style"])]),_:1}),r(R,{"close-on-content-click":!1},{activator:d(({props:a})=>[m("div",F(a,{class:"flex cursor-pointer"}),[l[11]||(l[11]=m("span",{class:"mt-1"},"Line color",-1)),m("div",{class:"w-[30px] h-[30px] border-2 border-slate-700 rounded-lg cursor-pointer ml-2",style:L({backgroundColor:s(e).options.lineColor})},null,4)],16)]),default:d(()=>[r(G,{class:"overflow-hidden",style:L(s(i).globalGlassMenuStyles)},{default:d(()=>[r(W,{modelValue:s(e).options.lineColor,"onUpdate:modelValue":l[2]||(l[2]=a=>s(e).options.lineColor=a),label:"Line","hide-inputs":""},null,8,["modelValue"])]),_:1},8,["style"])]),_:1}),r(I,{modelValue:s(e).options.lineThickness,"onUpdate:modelValue":l[3]||(l[3]=a=>s(e).options.lineThickness=a),modelModifiers:{number:!0},type:"number",label:"Line thickness",variant:"outlined",density:"compact",rules:[a=>a>0||"Must be greater than 0"],width:"140px","hide-details":""},null,8,["modelValue","rules"])])]),_:1})]),_:1}),r(U,null,{default:d(()=>[r(O,{cols:"12"},{default:d(()=>[l[13]||(l[13]=m("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Points",-1)),m("div",Ke,[r(I,{modelValue:s(e).options.decimalPlaces,"onUpdate:modelValue":l[4]||(l[4]=a=>s(e).options.decimalPlaces=a),modelModifiers:{number:!0},type:"number",label:"Decimal places",variant:"outlined",density:"comfortable",rules:[a=>a>=0||"Must be 0 or greater"],hint:"Number of decimal places to be displayed",width:"160px",class:"ml-2"},null,8,["modelValue","rules"]),r(Le,{modelValue:s(e).options.limitSamples,"onUpdate:modelValue":l[5]||(l[5]=a=>s(e).options.limitSamples=a),label:"Limit number of samples"},null,8,["modelValue"]),r(I,{modelValue:s(e).options.maxSamples,"onUpdate:modelValue":l[6]||(l[6]=a=>s(e).options.maxSamples=a),modelModifiers:{number:!0},type:"number",label:"Maximum samples",variant:"outlined",density:"comfortable",disabled:!s(e).options.limitSamples,rules:[a=>a>0||"Must be greater than 0"],hint:"Higher values will show more history but may impact performance",width:"220px"},null,8,["modelValue","disabled","rules"])])]),_:1})]),_:1})]),actions:d(()=>[m("div",Je,[r(Me,{onClick:l[7]||(l[7]=a=>s(n).widgetManagerVars(s(e).hash).configMenuOpen=!1)},{default:d(()=>l[14]||(l[14]=[Ne("Close")])),_:1})])]),_:1},8,["modelValue"])],64))}}),qe=Te(Qe,[["__scopeId","data-v-c0f135cf"]]);export{qe as default};
