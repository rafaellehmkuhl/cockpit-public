import{aG as F,aH as $,aQ as de,aZ as B,aJ as R,bw as ce,aT as fe,aM as me,G as o,bx as k,bt as O,k as U,by as q,c as ge,K as be,J as pe,I as ve,r as N,L as Ve,o as ye,bz as he,bA as Ce,bB as Se,w as j,au as we,ay as ke,aA as xe,ax as Le,l as I,m as A,q as u,n as w,N as d,V as Pe,O as z,P as Me,Q as T,R as Ne,ah as je,bC as Ie,a5 as Ae,a2 as Te,bD as _e,bE as W,bF as H,aC as K,a4 as Ee,U as Fe,W as $e,F as Be,_ as Re}from"./index-CdAWnfuS.js";const Oe=F({fluid:{type:Boolean,default:!1},...$(),...de(),...B()},"VContainer"),Ue=R()({name:"VContainer",props:Oe(),setup(e,i){let{slots:l}=i;const{rtlClasses:r}=ce(),{dimensionStyles:t}=fe(e);return me(()=>o(e.tag,{class:["v-container",{"v-container--fluid":e.fluid},r.value,e.class],style:[t.value,e.style]},l)),{}}}),Y=k.reduce((e,i)=>(e[i]={type:[Boolean,String,Number],default:!1},e),{}),Z=k.reduce((e,i)=>{const l="offset"+O(i);return e[l]={type:[String,Number],default:null},e},{}),X=k.reduce((e,i)=>{const l="order"+O(i);return e[l]={type:[String,Number],default:null},e},{}),J={col:Object.keys(Y),offset:Object.keys(Z),order:Object.keys(X)};function De(e,i,l){let r=e;if(!(l==null||l===!1)){if(i){const t=i.replace(e,"");r+=`-${t}`}return e==="col"&&(r="v-"+r),e==="col"&&(l===""||l===!0)||(r+=`-${l}`),r.toLowerCase()}}const Ge=["auto","start","end","center","baseline","stretch"],ze=F({cols:{type:[Boolean,String,Number],default:!1},...Y,offset:{type:[String,Number],default:null},...Z,order:{type:[String,Number],default:null},...X,alignSelf:{type:String,default:null,validator:e=>Ge.includes(e)},...$(),...B()},"VCol"),_=R()({name:"VCol",props:ze(),setup(e,i){let{slots:l}=i;const r=U(()=>{const t=[];let f;for(f in J)J[f].forEach(m=>{const b=e[m],h=De(f,m,b);h&&t.push(h)});const g=t.some(m=>m.startsWith("v-col-"));return t.push({"v-col":!g||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),t});return()=>{var t;return q(e.tag,{class:[r.value,e.class],style:e.style},(t=l.default)==null?void 0:t.call(l))}}}),D=["start","end","center"],ee=["space-between","space-around","space-evenly"];function G(e,i){return k.reduce((l,r)=>{const t=e+O(r);return l[t]=i(),l},{})}const We=[...D,"baseline","stretch"],te=e=>We.includes(e),ae=G("align",()=>({type:String,default:null,validator:te})),He=[...D,...ee],le=e=>He.includes(e),ne=G("justify",()=>({type:String,default:null,validator:le})),Ke=[...D,...ee,"stretch"],se=e=>Ke.includes(e),oe=G("alignContent",()=>({type:String,default:null,validator:se})),Q={align:Object.keys(ae),justify:Object.keys(ne),alignContent:Object.keys(oe)},Je={align:"align",justify:"justify",alignContent:"align-content"};function Qe(e,i,l){let r=Je[e];if(l!=null){if(i){const t=i.replace(e,"");r+=`-${t}`}return r+=`-${l}`,r.toLowerCase()}}const qe=F({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:te},...ae,justify:{type:String,default:null,validator:le},...ne,alignContent:{type:String,default:null,validator:se},...oe,...$(),...B()},"VRow"),E=R()({name:"VRow",props:qe(),setup(e,i){let{slots:l}=i;const r=U(()=>{const t=[];let f;for(f in Q)Q[f].forEach(g=>{const m=e[g],b=Qe(f,g,m);b&&t.push(b)});return t.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),t});return()=>{var t;return q(e.tag,{class:["v-row",r.value,e.class],style:e.style},(t=l.default)==null?void 0:t.call(l))}}}),Ye={key:0,class:"w-full h-full flex items-center justify-center text-center text-white text-h5 font-weight-bold p-4 overflow-hidden"},Ze={key:1,class:"main"},Xe=["width","height"],et=ge({__name:"Plotter",props:{widget:{}},setup(e){const i=be(),l=pe(),t=ve(e).widget,f=N([]);Ve(()=>{Object.keys(t.value.options).length===0&&(t.value.options={backgroundColor:"rgba(0, 0, 0, 0.7)",lineColor:"rgba(255, 0, 0, 1.0)",dataLakeVariableId:void 0,maxSamples:1e3,limitSamples:!0})}),ye(()=>{m(t.value.options.dataLakeVariableId),f.value=Object.values(he()).filter(s=>s.type==="number")});const g=()=>{t.value.options.limitSamples&&(c.length===t.value.options.maxSamples+1?c.shift():c.length>t.value.options.maxSamples&&c.splice(0,c.length-t.value.options.maxSamples))},m=s=>{if(s===void 0){console.error("No data lake variable ID provided!");return}const a=t.value.options.dataLakeVariableId;a!==void 0&&Ce(a),Se(s,n=>{c.push(n),g(),C()})};j([t.value.options.maxSamples,t.value.options.limitSamples],()=>{g(),C()});const{width:b,height:h}=we(),V=U(()=>({width:t.value.size.width*b.value,height:t.value.size.height*h.value})),y=N(),x=N(),L=(s,a,n,p)=>{const M=s.measureText(a),v=4;s.fillStyle="rgba(0, 0, 0, 0.5)",s.fillRect(n-v,p-16-v,M.width+v*2,16+v*2),s.fillStyle=t.value.options.lineColor,s.fillText(a,n,p)},C=()=>{if(y.value===void 0||y.value===null)return;if(x.value===void 0){console.debug("Canvas context undefined!"),x.value=y.value.getContext("2d");return}const s=x.value,a=V.value.width,n=V.value.height;ke(s),s.clearRect(0,0,a,n),s.fillStyle=t.value.options.backgroundColor,s.fillRect(0,0,a,n),s.strokeStyle=t.value.options.lineColor;try{if(c.length===0)return;P=Math.max(...c),S=Math.min(...c);const p=c[c.length-1];s.beginPath(),s.moveTo(0,n),c.forEach((M,v)=>{const re=v*(a/c.length),ue=n-(M-S)/(P-S)*n;s.lineTo(re,ue)}),s.stroke(),s.font="14px monospace",s.textBaseline="bottom",L(s,`Current: ${p.toFixed(2)}`,10,n-10),L(s,`Min: ${S.toFixed(2)}`,10,n-30),L(s,`Max: ${P.toFixed(2)}`,10,n-50)}catch(p){console.error("Error drawing graph:",p)}},c=[];let P=0,S=0;j([V,t.value.options],()=>{l.isWidgetVisible(t.value)&&xe(()=>C())});const ie=Le(y);return j(ie,(s,a)=>{s&&!a&&C()}),(s,a)=>(I(),A(Be,null,[u(t).options.dataLakeVariableId?(I(),A("div",Ze,[w("canvas",{ref_key:"canvasRef",ref:y,width:V.value.width,height:V.value.height},null,8,Xe)])):(I(),A("p",Ye," Please open the Plotter widget configuration menu to select a variable to be plotted. ")),o($e,{modelValue:u(l).widgetManagerVars(u(t).hash).configMenuOpen,"onUpdate:modelValue":a[5]||(a[5]=n=>u(l).widgetManagerVars(u(t).hash).configMenuOpen=n),"min-width":"400","max-width":"35%"},{default:d(()=>[o(Pe,{class:"pa-2",style:z(u(i).globalGlassMenuStyles)},{default:d(()=>[o(Me,null,{default:d(()=>a[6]||(a[6]=[T("Plotter config")])),_:1}),o(Ne,null,{default:d(()=>[o(Ue,{class:"pa-0"},{default:d(()=>[o(E,null,{default:d(()=>[o(_,{cols:"12"},{default:d(()=>[a[7]||(a[7]=w("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Source",-1)),o(je,{modelValue:u(t).options.dataLakeVariableId,"onUpdate:modelValue":[a[0]||(a[0]=n=>u(t).options.dataLakeVariableId=n),m],items:f.value,"item-title":"name","item-value":"id",label:"Data Lake variable",hint:"Select a variable to be plotted","persistent-hint":"",variant:"outlined",density:"comfortable",class:"mb-2"},null,8,["modelValue","items"])]),_:1})]),_:1}),o(E,null,{default:d(()=>[o(_,{cols:"12"},{default:d(()=>[a[10]||(a[10]=w("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Appearance",-1)),o(Ie,null,{activator:d(({props:n})=>[o(Ae,Te(n,{icon:"mdi-palette",size:"54",class:"bg-[#334a5755] text-[#FFFFFFCC] text-[28px] rounded-full elevation-5"}),null,16)]),default:d(()=>[o(_e,{style:z(u(i).globalGlassMenuStyles)},{default:d(()=>[o(W,null,{default:d(()=>[o(H,{class:"text-subtitle-1 font-weight-medium mb-2"},{default:d(()=>a[8]||(a[8]=[T(" Background Color ")])),_:1}),o(K,{modelValue:u(t).options.backgroundColor,"onUpdate:modelValue":a[1]||(a[1]=n=>u(t).options.backgroundColor=n),label:"Background","hide-inputs":"",class:"m-2"},null,8,["modelValue"])]),_:1}),o(W,null,{default:d(()=>[o(H,{class:"text-subtitle-1 font-weight-medium mb-2"},{default:d(()=>a[9]||(a[9]=[T("Line Color")])),_:1}),o(K,{modelValue:u(t).options.lineColor,"onUpdate:modelValue":a[2]||(a[2]=n=>u(t).options.lineColor=n),label:"Line","hide-inputs":"",class:"m-2"},null,8,["modelValue"])]),_:1})]),_:1},8,["style"])]),_:1})]),_:1})]),_:1}),o(E,null,{default:d(()=>[o(_,{cols:"12"},{default:d(()=>[a[11]||(a[11]=w("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Points",-1)),o(Ee,{modelValue:u(t).options.limitSamples,"onUpdate:modelValue":a[3]||(a[3]=n=>u(t).options.limitSamples=n),label:"Limit number of samples",color:"primary","hide-details":"",class:"mb-2"},null,8,["modelValue"]),o(Fe,{modelValue:u(t).options.maxSamples,"onUpdate:modelValue":a[4]||(a[4]=n=>u(t).options.maxSamples=n),modelModifiers:{number:!0},type:"number",label:"Maximum samples",variant:"outlined",density:"comfortable",disabled:!u(t).options.limitSamples,rules:[n=>n>0||"Must be greater than 0"],hint:"Higher values will show more history but may impact performance","persistent-hint":""},null,8,["modelValue","disabled","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])],64))}}),at=Re(et,[["__scopeId","data-v-a43d6319"]]);export{at as default};
