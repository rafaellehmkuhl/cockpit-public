import{aY as R,aZ as B,b5 as de,be as O,a$ as U,bM as ce,b8 as fe,b2 as me,H as r,bN as x,bJ as F,k as D,bO as Y,c as ge,K as pe,y as be,J as ve,r as _,L as ye,o as he,bP as Ve,av as Ce,au as Se,w as j,aB as ke,aF as we,aH as xe,aE as Le,l as $,m as E,q as i,n as f,N as d,V as I,O as C,P as Pe,Q as Me,R as Ne,ah as _e,aQ as z,a2 as H,aI as K,S as je,U as $e,W as Ee,F as Ie,_ as Ae}from"./index-C8hSWpLO.js";const Te=R({fluid:{type:Boolean,default:!1},...B(),...de(),...O()},"VContainer"),Re=U()({name:"VContainer",props:Te(),setup(e,s){let{slots:o}=s;const{rtlClasses:u}=ce(),{dimensionStyles:t}=fe(e);return me(()=>r(e.tag,{class:["v-container",{"v-container--fluid":e.fluid},u.value,e.class],style:[t.value,e.style]},o)),{}}}),q=x.reduce((e,s)=>(e[s]={type:[Boolean,String,Number],default:!1},e),{}),Z=x.reduce((e,s)=>{const o="offset"+F(s);return e[o]={type:[String,Number],default:null},e},{}),X=x.reduce((e,s)=>{const o="order"+F(s);return e[o]={type:[String,Number],default:null},e},{}),J={col:Object.keys(q),offset:Object.keys(Z),order:Object.keys(X)};function Be(e,s,o){let u=e;if(!(o==null||o===!1)){if(s){const t=s.replace(e,"");u+=`-${t}`}return e==="col"&&(u="v-"+u),e==="col"&&(o===""||o===!0)||(u+=`-${o}`),u.toLowerCase()}}const Oe=["auto","start","end","center","baseline","stretch"],Ue=R({cols:{type:[Boolean,String,Number],default:!1},...q,offset:{type:[String,Number],default:null},...Z,order:{type:[String,Number],default:null},...X,alignSelf:{type:String,default:null,validator:e=>Oe.includes(e)},...B(),...O()},"VCol"),A=U()({name:"VCol",props:Ue(),setup(e,s){let{slots:o}=s;const u=D(()=>{const t=[];let m;for(m in J)J[m].forEach(g=>{const b=e[g],S=Be(m,g,b);S&&t.push(S)});const p=t.some(g=>g.startsWith("v-col-"));return t.push({"v-col":!p||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),t});return()=>{var t;return Y(e.tag,{class:[u.value,e.class],style:e.style},(t=o.default)==null?void 0:t.call(o))}}}),G=["start","end","center"],ee=["space-between","space-around","space-evenly"];function W(e,s){return x.reduce((o,u)=>{const t=e+F(u);return o[t]=s(),o},{})}const Fe=[...G,"baseline","stretch"],te=e=>Fe.includes(e),ae=W("align",()=>({type:String,default:null,validator:te})),De=[...G,...ee],le=e=>De.includes(e),oe=W("justify",()=>({type:String,default:null,validator:le})),Ge=[...G,...ee,"stretch"],ne=e=>Ge.includes(e),se=W("alignContent",()=>({type:String,default:null,validator:ne})),Q={align:Object.keys(ae),justify:Object.keys(oe),alignContent:Object.keys(se)},We={align:"align",justify:"justify",alignContent:"align-content"};function ze(e,s,o){let u=We[e];if(o!=null){if(s){const t=s.replace(e,"");u+=`-${t}`}return u+=`-${o}`,u.toLowerCase()}}const He=R({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:te},...ae,justify:{type:String,default:null,validator:le},...oe,alignContent:{type:String,default:null,validator:ne},...se,...B(),...O()},"VRow"),T=U()({name:"VRow",props:He(),setup(e,s){let{slots:o}=s;const u=D(()=>{const t=[];let m;for(m in Q)Q[m].forEach(p=>{const g=e[p],b=ze(m,p,g);b&&t.push(b)});return t.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),t});return()=>{var t;return Y(e.tag,{class:["v-row",u.value,e.class],style:e.style},(t=o.default)==null?void 0:t.call(o))}}}),Ke={key:0,class:"w-full h-full flex items-center justify-center text-center text-white text-h5 font-weight-bold p-4 overflow-hidden"},Je={key:1,class:"main"},Qe=["width","height"],Ye={class:"ml-2"},qe={class:"ml-2 flex gap-x-8"},Ze={class:"ml-2 flex gap-x-8"},Xe=ge({__name:"Plotter",props:{widget:{}},setup(e){const s=pe(),o=be(),t=ve(e).widget,m=_([]);ye(()=>{Object.keys(t.value.options).length===0&&(t.value.options={backgroundColor:"rgba(0, 0, 0, 0.7)",lineColor:"rgba(255, 0, 0, 1.0)",dataLakeVariableId:void 0,maxSamples:1e3,limitSamples:!0})}),he(()=>{g(t.value.options.dataLakeVariableId),m.value=Object.values(Ve()).filter(n=>n.type==="number")});const p=()=>{t.value.options.limitSamples&&(c.length===t.value.options.maxSamples+1?c.shift():c.length>t.value.options.maxSamples&&c.splice(0,c.length-t.value.options.maxSamples))},g=n=>{if(n===void 0){console.error("No data lake variable ID provided!");return}const a=t.value.options.dataLakeVariableId;a!==void 0&&Ce(a),Se(n,l=>{c.push(l),p(),k()})};j([t.value.options.maxSamples,t.value.options.limitSamples],()=>{p(),k()});const{width:b,height:S}=ke(),h=D(()=>({width:t.value.size.width*b.value,height:t.value.size.height*S.value})),V=_(),L=_(),P=(n,a,l,v)=>{const N=n.measureText(a),y=4;n.fillStyle="rgba(0, 0, 0, 0.5)",n.fillRect(l-y,v-16-y,N.width+y*2,16+y*2),n.fillStyle=t.value.options.lineColor,n.fillText(a,l,v)},k=()=>{if(V.value===void 0||V.value===null)return;if(L.value===void 0){console.debug("Canvas context undefined!"),L.value=V.value.getContext("2d");return}const n=L.value,a=h.value.width,l=h.value.height;we(n),n.clearRect(0,0,a,l),n.fillStyle=t.value.options.backgroundColor,n.fillRect(0,0,a,l),n.strokeStyle=t.value.options.lineColor;try{if(c.length===0)return;M=Math.max(...c),w=Math.min(...c);const v=c[c.length-1];n.beginPath(),n.moveTo(0,l),c.forEach((N,y)=>{const re=y*(a/c.length),ue=l-(N-w)/(M-w)*l;n.lineTo(re,ue)}),n.stroke(),n.font="14px monospace",n.textBaseline="bottom",P(n,`Current: ${v.toFixed(2)}`,10,l-10),P(n,`Min: ${w.toFixed(2)}`,10,l-30),P(n,`Max: ${M.toFixed(2)}`,10,l-50)}catch(v){console.error("Error drawing graph:",v)}},c=[];let M=0,w=0;j([h,t.value.options],()=>{o.isWidgetVisible(t.value)&&xe(()=>k())});const ie=Le(V);return j(ie,(n,a)=>{n&&!a&&k()}),(n,a)=>($(),E(Ie,null,[i(t).options.dataLakeVariableId?($(),E("div",Je,[f("canvas",{ref_key:"canvasRef",ref:V,width:h.value.width,height:h.value.height},null,8,Qe)])):($(),E("p",Ke," Please open the Plotter widget configuration menu to select a variable to be plotted. ")),r(Ee,{modelValue:i(o).widgetManagerVars(i(t).hash).configMenuOpen,"onUpdate:modelValue":a[5]||(a[5]=l=>i(o).widgetManagerVars(i(t).hash).configMenuOpen=l),"min-width":"400","max-width":"35%"},{default:d(()=>[r(I,{class:"pa-2",style:C(i(s).globalGlassMenuStyles)},{default:d(()=>[r(Pe,{class:"text-center"},{default:d(()=>a[6]||(a[6]=[Me("Plotter config")])),_:1}),r(Ne,null,{default:d(()=>[r(Re,{class:"pa-0"},{default:d(()=>[r(T,null,{default:d(()=>[r(A,{cols:"12"},{default:d(()=>[a[7]||(a[7]=f("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Source",-1)),f("div",Ye,[r(_e,{modelValue:i(t).options.dataLakeVariableId,"onUpdate:modelValue":[a[0]||(a[0]=l=>i(t).options.dataLakeVariableId=l),g],items:m.value,"item-title":"name","item-value":"id",label:"Data Lake variable",hint:"Select a variable to be plotted","persistent-hint":"",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])])]),_:1})]),_:1}),r(T,null,{default:d(()=>[r(A,{cols:"12"},{default:d(()=>[a[10]||(a[10]=f("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Appearance",-1)),f("div",qe,[r(z,{"close-on-content-click":!1},{activator:d(({props:l})=>[f("div",H(l,{class:"flex cursor-pointer"}),[a[8]||(a[8]=f("span",{class:"mt-1"},"Background color",-1)),f("div",{class:"w-[30px] h-[30px] border-2 border-slate-700 rounded-lg cursor-pointer ml-2",style:C({backgroundColor:i(t).options.backgroundColor})},null,4)],16)]),default:d(()=>[r(I,{class:"overflow-hidden",style:C(i(s).globalGlassMenuStyles)},{default:d(()=>[r(K,{modelValue:i(t).options.backgroundColor,"onUpdate:modelValue":a[1]||(a[1]=l=>i(t).options.backgroundColor=l),label:"Background","hide-inputs":""},null,8,["modelValue"])]),_:1},8,["style"])]),_:1}),r(z,{"close-on-content-click":!1},{activator:d(({props:l})=>[f("div",H(l,{class:"flex cursor-pointer"}),[a[9]||(a[9]=f("span",{class:"mt-1"},"Line color",-1)),f("div",{class:"w-[30px] h-[30px] border-2 border-slate-700 rounded-lg cursor-pointer ml-2",style:C({backgroundColor:i(t).options.lineColor})},null,4)],16)]),default:d(()=>[r(I,{class:"overflow-hidden",style:C(i(s).globalGlassMenuStyles)},{default:d(()=>[r(K,{modelValue:i(t).options.lineColor,"onUpdate:modelValue":a[2]||(a[2]=l=>i(t).options.lineColor=l),label:"Line","hide-inputs":""},null,8,["modelValue"])]),_:1},8,["style"])]),_:1})])]),_:1})]),_:1}),r(T,null,{default:d(()=>[r(A,{cols:"12"},{default:d(()=>[a[11]||(a[11]=f("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Data Points",-1)),f("div",Ze,[r(je,{modelValue:i(t).options.limitSamples,"onUpdate:modelValue":a[3]||(a[3]=l=>i(t).options.limitSamples=l),label:"Limit number of samples",color:"primary"},null,8,["modelValue"]),r($e,{modelValue:i(t).options.maxSamples,"onUpdate:modelValue":a[4]||(a[4]=l=>i(t).options.maxSamples=l),modelModifiers:{number:!0},type:"number",label:"Maximum samples",variant:"outlined",density:"comfortable",disabled:!i(t).options.limitSamples,rules:[l=>l>0||"Must be greater than 0"],hint:"Higher values will show more history but may impact performance","persistent-hint":""},null,8,["modelValue","disabled","rules"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])],64))}}),tt=Ae(Xe,[["__scopeId","data-v-451176ad"]]);export{tt as default};
