import{c as B,J as P,r as v,o as U,w as h,l as H,I as z,n as f,a2 as j,aJ as q,al as G,y as J,M as Y,Y as K,u as X,L as Q,aB as Z,k as E,aF as ee,aG as u,aK as te,aD as N,aA as ae,aH as se,m as oe,H as V,N as ne,am as le,q as g,F as re,_ as ie}from"./index-BuIQHwnx.js";import{g as w}from"./index-C5ZFbjcW.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d=new a.Error().stack;d&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[d]="1c7464ba-1f9c-46e2-85e1-77d87708c8a9",a._sentryDebugIdIdentifier="sentry-dbid-1c7464ba-1f9c-46e2-85e1-77d87708c8a9")}catch{}})();const de=B({__name:"Dialog",props:{show:Boolean},emits:["update:show"],setup(a,{emit:d}){const p=a,S=d,c=P(p).show,l=v(c.value),i=v(),m=v();return U(()=>{i.value.addEventListener("click",s=>{!s.target||s.target instanceof HTMLElement&&!s.target.closest(".action-button")&&s.target.nodeName!=="DIALOG"||(l.value=!1)}),document.addEventListener("keydown",s=>{l.value&&s.key==="Escape"&&(s.preventDefault(),s.stopImmediatePropagation(),l.value=!1)},{passive:!1})}),h(c,()=>l.value=c.value),h(l,()=>{l.value?i.value.showModal():(i.value.setAttribute("closing",""),i.value.addEventListener("animationend",()=>{i.value.removeAttribute("closing"),i.value.close()},{once:!0})),S("update:show",l.value)}),(s,o)=>(H(),z(G,{to:"body"},[f("dialog",{ref_key:"dialogRef",ref:i,class:"modal"},[f("div",j({ref_key:"dialogContentRef",ref:m},s.$attrs,{class:"flex flex-col items-center justify-center w-full h-full p-5 backdrop-blur-sm"}),[q(s.$slots,"default")],16)],512)]))}}),ce=["height","width"],ue={class:"flex items-center"},ge={class:"w-40"};var L=(a=>(a.NORTH_UP="North Up",a.HEAD_UP="Head Up",a))(L||{});const fe=B({__name:"Compass",props:{widget:{}},setup(a){const d=J();Y.registerUsage(K.heading);const p=X(),S=v(),c=v(),l=v(),i={0:"N",45:"NE",90:"E",135:"SE",180:"S",225:"SW",270:"W",315:"NW"},m=Object.values(L),o=P(a).widget;Q(()=>{Object.keys(o.value.options).length===0&&(o.value.options={headingStyle:m[0]})}),U(()=>{I(),M()});const{width:O,height:F}=Z(),T=E(()=>o.value.size.width*O.value),R=E(()=>o.value.size.height*F.value),y=E(()=>T.value<R.value?T.value:R.value),M=()=>{if(c.value===void 0||c.value===null)return;l.value===void 0&&(l.value=c.value.getContext("2d"));const e=l.value;ee(e);const t=.5*y.value,r=.13*y.value,A=.03*t;e.textAlign="center",e.strokeStyle="white",e.font=`bold ${r}px Arial`,e.fillStyle="white",e.lineWidth=A,e.textBaseline="middle";const _=.7*t,W=.4*t,C=.55*t;e.translate(t,t),e.font=`bold ${r}px Arial`,e.fillText(`${n.yawAngleDegrees.toFixed(0)}Â°`,.15*r,0),e.rotate(u(-90)),o.value.options.headingStyle=="Head Up"&&e.rotate(-u(n.yawAngleDegrees));for(const[k,$]of Object.entries(i))e.save(),e.rotate(u(Number(k))),e.beginPath(),e.moveTo(C,0),e.lineTo(_,0),e.textBaseline="bottom",e.font=`bold ${.7*r}px Arial`,e.translate(_*1.025,0),e.rotate(u(90)),e.fillText($,0,0),e.stroke(),e.restore();for(const k of te(360))k%9===0&&(e.save(),e.lineWidth=.25*A,e.rotate(u(Number(k))),e.beginPath(),e.moveTo(1.1*C,0),e.lineTo(_,0),e.stroke(),e.restore());e.beginPath(),e.arc(0,0,_,0,u(360)),e.stroke(),o.value.options.headingStyle=="North Up"?e.rotate(u(n.yawAngleDegrees)):e.rotate(u(n.yawAngleDegrees)),e.beginPath(),e.lineWidth=1,e.strokeStyle="red",e.fillStyle="red";const x=.05*t;e.moveTo(W,x),e.lineTo(C-.5*x,0),e.lineTo(W,-x),e.lineTo(W,x),e.closePath(),e.fill(),e.stroke()},b=v(.01);let D;h(p.attitude,e=>{if(D===void 0){b.value=N(p.attitude.yaw),D=e.yaw;return}Math.abs(N(e.yaw-D))>.1&&(D=e.yaw,b.value=N(p.attitude.yaw))});const n=ae({yawAngleDegrees:0}),I=()=>{const e=b.value,t=e<0?e+360:e,r=n.yawAngleDegrees>270&&t<90,A=n.yawAngleDegrees<90&&t>270;r?(w.to(n,.05,{yawAngleDegrees:0}),w.fromTo(n,.05,{yawAngleDegrees:0},{yawAngleDegrees:t})):A?(w.to(n,.05,{yawAngleDegrees:360}),w.fromTo(n,.05,{yawAngleDegrees:360},{yawAngleDegrees:t})):w.to(n,.1,{yawAngleDegrees:t})};return h(b,()=>I()),h([n,T,R],()=>{d.isWidgetVisible(o.value)&&se(()=>M())}),(e,t)=>(H(),oe(re,null,[f("div",{ref_key:"compassRoot",ref:S,class:"compass"},[f("canvas",{ref_key:"canvasRef",ref:c,height:y.value,width:y.value,class:"rounded-[15%] bg-slate-950/70"},null,8,ce)],512),V(de,{show:g(d).widgetManagerVars(g(o).hash).configMenuOpen,"onUpdate:show":t[1]||(t[1]=r=>g(d).widgetManagerVars(g(o).hash).configMenuOpen=r),class:"flex pa-4 bg-[#ffffff10] text-white backdrop-blur-2xl border-[1px] border-[#FAFAFA12]"},{default:ne(()=>[f("div",ue,[t[2]||(t[2]=f("span",{class:"mr-3 text-slate-100"},"Heading style",-1)),f("div",ge,[V(le,{modelValue:g(o).options.headingStyle,"onUpdate:modelValue":t[0]||(t[0]=r=>g(o).options.headingStyle=r),options:g(m)},null,8,["modelValue","options"])])])]),_:1},8,["show"])],64))}}),we=ie(fe,[["__scopeId","data-v-758f6fd3"]]);export{we as default};
//# sourceMappingURL=Compass-ZXHeKUbt.js.map
