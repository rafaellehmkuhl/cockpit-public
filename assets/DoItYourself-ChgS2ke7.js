import{c as G,bO as q,k as A,bP as X,bQ as Z,K as ee,y as te,J as se,r as h,L as ne,o as oe,aM as ae,D as le,l as R,m as $,n as i,H as s,N as n,V as re,O as w,v as m,ag as y,Q as d,P as ie,R as ue,bB as de,s as ce,bR as fe,ai as v,W as pe,F as me,bS as ge,bT as he,bU as ve,bV as g,bW as _,_ as xe}from"./index-DYzg7ivP.js";import{V as Ce,a as L,b as F,c as D}from"./VExpansionPanels-HJO4aOVU.js";function we(u){return new Worker(""+new URL("css.worker-CDE9TcMx.js",import.meta.url).href,{name:u==null?void 0:u.name})}function ye(u){return new Worker(""+new URL("html.worker-CgyTMpcR.js",import.meta.url).href,{name:u==null?void 0:u.name})}function _e(u){return new Worker(""+new URL("json.worker-F_3Wl95C.js",import.meta.url).href,{name:u==null?void 0:u.name})}const Ve={class:"main"},je=["innerHTML"],be={key:0,class:"help-panel mb-4 p-4 rounded bg-white/5"},ke={class:"flex justify-between items-center px-4 w-full h-full"},Ee={class:"flex gap-x-3"},U=50,Se=G({__name:"DoItYourself",props:{widget:{}},setup(u){q(t=>({"142fb790":C.value})),self.MonacoEnvironment={getWorker(t,e){return e==="json"?new _e:e==="css"||e==="scss"||e==="less"?new we:e==="html"||e==="handlebars"||e==="razor"?new ye:e==="typescript"||e==="javascript"?new X:new Z}};const I=ee(),V=te(),r=se(u).widget,j=h(null),b=h(null),k=h(null),E=h(!1),S=h(["html","css","js"]);let o=null,a=null,l=null;const c={html:`<!-- Write your HTML code here -->
<div id="diy-container">
  <span>Create your own widget!</span>
</div>`,css:`/* Write your CSS code here */
#diy-container {
  width: 100%;
  height: 100%;
  padding: 1rem;
  background-color: white;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 3rem;
  text-align: center;
  font-family: 'Roboto', sans-serif;
  font-weight: 500;
}`,js:`// Write your JavaScript code here
document.addEventListener('DOMContentLoaded', () => {
  // Your code here
});`},B=A(()=>{const t=r.value.options.html||c.html,e=r.value.options.css||c.css,f=r.value.options.js||c.js;return`${t}
<style>
${e}
</style>
<script>
${f}
<\/script>`}),M=(t,e,f)=>ve.create(t,{value:f,language:e,theme:"vs-dark",minimap:{enabled:!1},fontSize:14,lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0,tabSize:2,wordWrap:"on",padding:{top:12,bottom:12}}),W=t=>{t.addCommand(g.CtrlCmd|_.Enter,()=>x()),t.addCommand(g.CtrlCmd|_.KeyS,()=>x()),t.addCommand(g.CtrlCmd|g.Alt|_.UpArrow,()=>{o&&o.hasTextFocus()&&a?a.focus():l&&l.hasTextFocus()&&o?o.focus():a&&a.hasTextFocus()&&l&&l.focus()}),t.addCommand(g.CtrlCmd|g.Alt|_.DownArrow,()=>{o&&o.hasTextFocus()&&l?l.focus():l&&l.hasTextFocus()&&a?a.focus():a&&a.hasTextFocus()&&o&&o.focus()})},H=async()=>{o||!j.value||l||!k.value||a||!b.value||(o=M(j.value,"html",r.value.options.html||c.html),l=M(k.value,"javascript",r.value.options.js||c.js),a=M(b.value,"css",r.value.options.css||c.css),o&&W(o),l&&W(l),a&&W(a))},z=async()=>{await H()},P=async()=>{T()},x=()=>{!o||!a||!l||(r.value.options.html=o.getValue(),r.value.options.css=a.getValue(),r.value.options.js=l.getValue(),O())},O=()=>{var p;const t=r.value.options.js||"",e=`diy-script-${r.value.hash}`;(p=document.getElementById(e))==null||p.remove();const f=document.createElement("script");f.type="text/javascript",f.textContent=t,f.id=e,document.body.appendChild(f)},N=()=>{!o||!a||!l||(o.setValue(r.value.options.html||c.html),a.setValue(r.value.options.css||c.css),l.setValue(r.value.options.js||c.js))},T=()=>{o&&(o.dispose(),o=null),a&&(a.dispose(),a=null),l&&(l.dispose(),l=null)},Y=()=>{V.widgetManagerVars(r.value.hash).configMenuOpen=!1,T()},K=()=>{if(!o||!a||!l)return;const t={html:o.getValue(),css:a.getValue(),js:l.getValue()};he(t,"diy-widget-config.json")},J=t=>!t||typeof t!="object"?{isValid:!1,error:"Invalid configuration file: content is not an object."}:!t.html||!t.css||!t.js?{isValid:!1,error:"Invalid configuration file: missing html, css, or js fields"}:{isValid:!0},Q=async()=>{try{const t=await ge("application/json",!0,J);if(!o||!a||!l)return;o.setValue(t.html),a.setValue(t.css),l.setValue(t.js),x()}catch(t){console.error("Error importing configuration:",t),alert(t.message||"Failed to import configuration file")}},C=A(()=>{const t=S.value.length;return t===0?`${U}vh`:`${Math.round(U/t)}vh`});return ne(()=>{r.value.options=Object.assign({},c,r.value.options)}),oe(()=>{O()}),ae(()=>{T()}),(t,e)=>{const f=le("vue-draggable-resizable");return $(),R(me,null,[i("div",Ve,[i("div",{class:"w-full h-full",innerHTML:B.value},null,8,je)]),s(pe,{modelValue:m(V).widgetManagerVars(m(r).hash).configMenuOpen,"onUpdate:modelValue":e[2]||(e[2]=p=>m(V).widgetManagerVars(m(r).hash).configMenuOpen=p),"max-width":m(I).isOnSmallScreen?"100%":"800px",onAfterEnter:z,onAfterLeave:P},{default:n(()=>[s(f,{"drag-handle":".drag-handle",w:"auto",h:"auto",handles:["tm","mr","bm","ml"]},{default:n(()=>[s(re,{class:"pa-2",style:w(m(I).globalGlassMenuStyles)},{default:n(()=>[s(y,{class:"drag-handle absolute top-[12px] left-[12px] cursor-grab"},{default:n(()=>e[3]||(e[3]=[d("mdi-drag")])),_:1,__:[3]}),s(y,{class:"absolute top-[12px] right-[12px] cursor-pointer",onClick:e[0]||(e[0]=p=>E.value=!E.value)},{default:n(()=>e[4]||(e[4]=[d(" mdi-help-circle-outline ")])),_:1,__:[4]}),s(ie,{class:"w-full text-center mt-2 mb-2"},{default:n(()=>e[5]||(e[5]=[d("DIY widget configuration")])),_:1,__:[5]}),s(ue,{class:"mx-2 flex flex-col gap-y-3"},{default:n(()=>[s(de,null,{default:n(()=>[E.value?($(),R("div",be,e[6]||(e[6]=[i("h3",{class:"text-lg mb-2"},"Editor instructions",-1),i("ul",{class:"text-sm text-white/70 list-disc pl-4 space-y-1"},[i("li",null,"Use the HTML, CSS, and JS editors to create your custom widget"),i("li",null,"Changes are applied when you click Apply or press Cmd/Ctrl + Enter/S"),i("li",null,"Navigate between editors using Cmd/Ctrl + Option/Alt + ↑/↓"),i("li",null,"Reset to last saved state using the Reset button"),i("li",null,"Your code runs in the widget's context and has access to the DOM"),i("li",null,"You can use the console to debug your code"),i("li",null," You can use the data-lake system to inject or consume data from Cockpit. Check the docs for more information around this. "),i("li",null,"Click on each editor's header to expand it to full size")],-1)]))):ce("",!0)]),_:1}),s(Ce,{modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=p=>S.value=p),class:"editors-container",multiple:""},{default:n(()=>[s(L,{value:"html"},{default:n(()=>[s(F,{static:"",height:"36px",class:"text-white/60"},{default:n(()=>e[7]||(e[7]=[d(" HTML ")])),_:1,__:[7]}),s(D,{eager:""},{default:n(()=>[i("div",{ref_key:"htmlEditorContainer",ref:j,class:"editor-container",style:w({height:C.value})},null,4)]),_:1})]),_:1}),s(L,{value:"js"},{default:n(()=>[s(F,{static:"",height:"36px",class:"text-white/60"},{default:n(()=>e[8]||(e[8]=[d(" JS ")])),_:1,__:[8]}),s(D,{eager:""},{default:n(()=>[i("div",{ref_key:"jsEditorContainer",ref:k,class:"editor-container",style:w({height:C.value})},null,4)]),_:1})]),_:1}),s(L,{value:"css"},{default:n(()=>[s(F,{static:"",height:"36px",class:"text-white/60"},{default:n(()=>e[9]||(e[9]=[d(" CSS ")])),_:1,__:[9]}),s(D,{eager:""},{default:n(()=>[i("div",{ref_key:"cssEditorContainer",ref:b,class:"editor-container",style:w({height:C.value})},null,4)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(fe,null,{default:n(()=>[i("div",ke,[s(v,{class:"text-white/60",variant:"text",onClick:Y},{default:n(()=>e[10]||(e[10]=[d("Close")])),_:1,__:[10]}),i("div",Ee,[s(v,{class:"text-white/60",variant:"text",title:"Export configuration",onClick:K},{default:n(()=>[s(y,{class:"mr-1 mt-[2px]"},{default:n(()=>e[11]||(e[11]=[d("mdi-download")])),_:1,__:[11]}),e[12]||(e[12]=d(" Export "))]),_:1,__:[12]}),s(v,{class:"text-white/60 mr-10",variant:"text",title:"Import configuration",onClick:Q},{default:n(()=>[s(y,{class:"mr-1 mt-[2px]"},{default:n(()=>e[13]||(e[13]=[d("mdi-upload")])),_:1,__:[13]}),e[14]||(e[14]=d(" Import "))]),_:1,__:[14]}),s(v,{class:"text-white/60",variant:"text",onClick:N},{default:n(()=>e[15]||(e[15]=[d("Reset")])),_:1,__:[15]}),s(v,{class:"text-white",variant:"text",onClick:x},{default:n(()=>e[16]||(e[16]=[d("Apply")])),_:1,__:[16]})])])]),_:1})]),_:1},8,["style"])]),_:1})]),_:1},8,["modelValue","max-width"])],64)}}}),Le=xe(Se,[["__scopeId","data-v-2dd538fd"]]);export{Le as default};
