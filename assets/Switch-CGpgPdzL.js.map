{"version":3,"file":"Switch-CGpgPdzL.js","sources":["../../src/components/custom-widget-elements/Switch.vue"],"sourcesContent":["<template>\n  <div\n    class=\"flex items-center h-[30px] px-4\"\n    :class=\"\n      widgetStore.elementToShowOnDrawer?.hash === miniWidget.hash && widgetStore.editingMode\n        ? 'bg-[#00000010] '\n        : 'border-0'\n    \"\n    @click=\"widgetStore.editingMode && widgetStore.showElementPropsDrawer(miniWidget.hash)\"\n  >\n    <v-switch\n      v-model=\"switchValue\"\n      hide-details\n      :color=\"miniWidget.options.layout?.color || '#FFFFFF'\"\n      :class=\"{ 'pointer-events-none': widgetStore.editingMode }\"\n      class=\"min-w-[35px]\"\n      @change=\"handleToggleAction\"\n    />\n    <p v-if=\"miniWidget.options.layout?.label !== ''\" class=\"ml-3 mb-[3px] whitespace-nowrap\">\n      {{ miniWidget.options.layout?.label }}\n    </p>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { onMounted, onUnmounted, ref, toRefs, watch } from 'vue'\n\nimport {\n  deleteDataLakeVariable,\n  listenDataLakeVariable,\n  setDataLakeVariableData,\n  unlistenDataLakeVariable,\n} from '@/libs/actions/data-lake'\nimport { useWidgetManagerStore } from '@/stores/widgetManager'\nimport { CustomWidgetElementOptions, CustomWidgetElementType } from '@/types/widgets'\n\nconst widgetStore = useWidgetManagerStore()\n\nconst props = defineProps<{\n  /**\n   * Element instance\n   */\n  miniWidget: CustomWidgetElementOptions[CustomWidgetElementType.Switch]\n}>()\n\nconst miniWidget = toRefs(props).miniWidget\nconst switchValue = ref(true)\nlet listenerId: string | undefined\n\nwatch(\n  () => widgetStore.miniWidgetManagerVars(miniWidget.value.hash).configMenuOpen,\n  (newValue) => {\n    if (newValue === true) {\n      widgetStore.showElementPropsDrawer(miniWidget.value.hash)\n      setTimeout(() => {\n        widgetStore.miniWidgetManagerVars(miniWidget.value.hash).configMenuOpen = false\n      }, 200)\n    }\n  },\n  { immediate: true, deep: true }\n)\n\nconst handleToggleAction = (): void => {\n  if (widgetStore.editingMode) return\n  if (miniWidget.value.options.dataLakeVariable) {\n    widgetStore.setMiniWidgetLastValue(miniWidget.value.hash, switchValue.value)\n    setDataLakeVariableData(miniWidget.value.options.dataLakeVariable.name, switchValue.value)\n  }\n}\n\nonMounted(() => {\n  if (!props.miniWidget.options || Object.keys(props.miniWidget.options).length === 0) {\n    miniWidget.value.isCustomElement = true\n    widgetStore.updateElementOptions(props.miniWidget.hash, {\n      layout: {\n        align: miniWidget.value.options.layout?.align || 'center',\n        color: miniWidget.value.options.layout?.color || '#FFFFFF',\n        label: miniWidget.value.options.layout?.label || '',\n      },\n      variableType: 'boolean',\n      dataLakeVariable: undefined,\n      toggled: true,\n    })\n\n    switchValue.value = true\n  } else if (miniWidget.value.options.dataLakeVariable) {\n    listenerId = listenDataLakeVariable(miniWidget.value.options.dataLakeVariable.name, (value) => {\n      switchValue.value = value as boolean\n    })\n    switchValue.value = widgetStore.getMiniWidgetLastValue(miniWidget.value.hash) as boolean\n  }\n})\n\nonUnmounted(() => {\n  if (miniWidget.value.options.dataLakeVariable) {\n    deleteDataLakeVariable(miniWidget.value.options.dataLakeVariable.id)\n    if (listenerId) {\n      unlistenDataLakeVariable(miniWidget.value.options.dataLakeVariable.name, listenerId)\n    }\n  }\n})\n</script>\n\n<style scoped></style>\n"],"names":["widgetStore","useWidgetManagerStore","props","__props","miniWidget","toRefs","switchValue","ref","listenerId","watch","newValue","handleToggleAction","setDataLakeVariableData","onMounted","_a","_b","_c","listenDataLakeVariable","value","onUnmounted","deleteDataLakeVariable","unlistenDataLakeVariable"],"mappings":"2kBAoCA,MAAMA,EAAcC,EAAsB,EAEpCC,EAAQC,EAORC,EAAaC,EAAOH,CAAK,EAAE,WAC3BI,EAAcC,EAAI,EAAI,EACxB,IAAAC,EAEJC,EACE,IAAMT,EAAY,sBAAsBI,EAAW,MAAM,IAAI,EAAE,eAC9DM,GAAa,CACRA,IAAa,KACHV,EAAA,uBAAuBI,EAAW,MAAM,IAAI,EACxD,WAAW,IAAM,CACfJ,EAAY,sBAAsBI,EAAW,MAAM,IAAI,EAAE,eAAiB,IACzE,GAAG,EAEV,EACA,CAAE,UAAW,GAAM,KAAM,EAAK,CAChC,EAEA,MAAMO,EAAqB,IAAY,CACjCX,EAAY,aACZI,EAAW,MAAM,QAAQ,mBAC3BJ,EAAY,uBAAuBI,EAAW,MAAM,KAAME,EAAY,KAAK,EAC3EM,EAAwBR,EAAW,MAAM,QAAQ,iBAAiB,KAAME,EAAY,KAAK,EAE7F,EAEA,OAAAO,EAAU,IAAM,WACV,CAACX,EAAM,WAAW,SAAW,OAAO,KAAKA,EAAM,WAAW,OAAO,EAAE,SAAW,GAChFE,EAAW,MAAM,gBAAkB,GACvBJ,EAAA,qBAAqBE,EAAM,WAAW,KAAM,CACtD,OAAQ,CACN,QAAOY,EAAAV,EAAW,MAAM,QAAQ,SAAzB,YAAAU,EAAiC,QAAS,SACjD,QAAOC,EAAAX,EAAW,MAAM,QAAQ,SAAzB,YAAAW,EAAiC,QAAS,UACjD,QAAOC,EAAAZ,EAAW,MAAM,QAAQ,SAAzB,YAAAY,EAAiC,QAAS,EACnD,EACA,aAAc,UACd,iBAAkB,OAClB,QAAS,EAAA,CACV,EAEDV,EAAY,MAAQ,IACXF,EAAW,MAAM,QAAQ,mBAClCI,EAAaS,EAAuBb,EAAW,MAAM,QAAQ,iBAAiB,KAAOc,GAAU,CAC7FZ,EAAY,MAAQY,CAAA,CACrB,EACDZ,EAAY,MAAQN,EAAY,uBAAuBI,EAAW,MAAM,IAAI,EAC9E,CACD,EAEDe,EAAY,IAAM,CACZf,EAAW,MAAM,QAAQ,mBAC3BgB,EAAuBhB,EAAW,MAAM,QAAQ,iBAAiB,EAAE,EAC/DI,GACFa,EAAyBjB,EAAW,MAAM,QAAQ,iBAAiB,KAAMI,CAAU,EAEvF,CACD"}