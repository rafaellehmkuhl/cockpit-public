import{bM as L,bJ as D,aY as K,aZ as J,be as Q,a$ as Y,k as O,bN as q,c as fe,K as me,y as ge,J as pe,r as j,L as be,o as ve,bO as he,au as ye,w as x,aB as Ve,aF as ke,aH as we,aE as Se,l as _,m as $,q as s,n as f,H as r,N as d,ah as xe,aQ as A,a2 as R,O as C,V as F,aI as G,U as W,S as Ce,a5 as Le,Q as Me,a6 as Ne,F as Ie,aw as Pe,_ as je}from"./index-BuIQHwnx.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},i=new e.Error().stack;i&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[i]="14ba58d6-1eaa-4988-9f3b-478c6ae0923f",e._sentryDebugIdIdentifier="sentry-dbid-14ba58d6-1eaa-4988-9f3b-478c6ae0923f")}catch{}})();const Z=L.reduce((e,i)=>(e[i]={type:[Boolean,String,Number],default:!1},e),{}),X=L.reduce((e,i)=>{const o="offset"+D(i);return e[o]={type:[String,Number],default:null},e},{}),ee=L.reduce((e,i)=>{const o="order"+D(i);return e[o]={type:[String,Number],default:null},e},{}),z={col:Object.keys(Z),offset:Object.keys(X),order:Object.keys(ee)};function _e(e,i,o){let u=e;if(!(o==null||o===!1)){if(i){const t=i.replace(e,"");u+=`-${t}`}return e==="col"&&(u="v-"+u),e==="col"&&(o===""||o===!0)||(u+=`-${o}`),u.toLowerCase()}}const $e=["auto","start","end","center","baseline","stretch"],Ee=K({cols:{type:[Boolean,String,Number],default:!1},...Z,offset:{type:[String,Number],default:null},...X,order:{type:[String,Number],default:null},...ee,alignSelf:{type:String,default:null,validator:e=>$e.includes(e)},...J(),...Q()},"VCol"),E=Y()({name:"VCol",props:Ee(),setup(e,i){let{slots:o}=i;const u=O(()=>{const t=[];let m;for(m in z)z[m].forEach(g=>{const b=e[g],k=_e(m,g,b);k&&t.push(k)});const p=t.some(g=>g.startsWith("v-col-"));return t.push({"v-col":!p||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),t});return()=>{var t;return q(e.tag,{class:[u.value,e.class],style:e.style},(t=o.default)==null?void 0:t.call(o))}}}),B=["start","end","center"],te=["space-between","space-around","space-evenly"];function U(e,i){return L.reduce((o,u)=>{const t=e+D(u);return o[t]=i(),o},{})}const Te=[...B,"baseline","stretch"],ae=e=>Te.includes(e),le=U("align",()=>({type:String,default:null,validator:ae})),De=[...B,...te],ne=e=>De.includes(e),oe=U("justify",()=>({type:String,default:null,validator:ne})),Oe=[...B,...te,"stretch"],se=e=>Oe.includes(e),ie=U("alignContent",()=>({type:String,default:null,validator:se})),H={align:Object.keys(le),justify:Object.keys(oe),alignContent:Object.keys(ie)},Be={align:"align",justify:"justify",alignContent:"align-content"};function Ue(e,i,o){let u=Be[e];if(o!=null){if(i){const t=i.replace(e,"");u+=`-${t}`}return u+=`-${o}`,u.toLowerCase()}}const Ae=K({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:ae},...le,justify:{type:String,default:null,validator:ne},...oe,alignContent:{type:String,default:null,validator:se},...ie,...J(),...Q()},"VRow"),T=Y()({name:"VRow",props:Ae(),setup(e,i){let{slots:o}=i;const u=O(()=>{const t=[];let m;for(m in H)H[m].forEach(p=>{const g=e[p],b=Ue(m,p,g);b&&t.push(b)});return t.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),t});return()=>{var t;return q(e.tag,{class:["v-row",u.value,e.class],style:e.style},(t=o.default)==null?void 0:t.call(o))}}}),Re={key:0,class:"w-full h-full flex items-center justify-center text-center text-white text-h5 font-weight-bold p-4 overflow-hidden"},Fe={key:1,class:"main"},Ge=["width","height"],We={class:"ml-2"},ze={class:"ml-2 flex gap-x-8"},He={class:"ml-2 flex gap-x-8"},Ke={class:"flex w-full justify-end my-2"},Je=fe({__name:"Plotter",props:{widget:{}},setup(e){const i=me(),o=ge(),t=pe(e).widget,m=j([]);let p;be(()=>{Object.keys(t.value.options).length===0&&(t.value.options={backgroundColor:"rgba(0, 0, 0, 0.7)",lineColor:"rgba(255, 0, 0, 1.0)",dataLakeVariableId:void 0,maxSamples:1e3,limitSamples:!0,lineThickness:1})}),ve(()=>{b(t.value.options.dataLakeVariableId),m.value=Object.values(he()).filter(n=>n.type==="number")});const g=()=>{t.value.options.limitSamples&&(c.length===t.value.options.maxSamples+1?c.shift():c.length>t.value.options.maxSamples&&c.splice(0,c.length-t.value.options.maxSamples))},b=(n,a)=>{if(n===void 0){console.error("No data lake variable ID provided!");return}a!==void 0&&p&&Pe(a,p),p=ye(n,l=>{c.push(l),g(),w()})};x([t.value.options.maxSamples,t.value.options.limitSamples],()=>{g(),w()}),x(()=>t.value.options.dataLakeVariableId,(n,a)=>{b(n,a),c.length=0});const{width:k,height:re}=Ve(),y=O(()=>({width:t.value.size.width*k.value,height:t.value.size.height*re.value})),V=j(),M=j(),N=(n,a,l,v)=>{const P=n.measureText(a),h=4;n.fillStyle="rgba(0, 0, 0, 0.5)",n.fillRect(l-h,v-16-h,P.width+h*2,16+h*2),n.fillStyle=t.value.options.lineColor,n.fillText(a,l,v)},w=()=>{if(V.value===void 0||V.value===null)return;if(M.value===void 0){console.debug("Canvas context undefined!"),M.value=V.value.getContext("2d");return}const n=M.value,a=y.value.width,l=y.value.height;ke(n),n.clearRect(0,0,a,l),n.fillStyle=t.value.options.backgroundColor,n.fillRect(0,0,a,l),n.strokeStyle=t.value.options.lineColor,n.lineWidth=Math.max(t.value.options.lineThickness,1);try{if(c.length===0)return;I=Math.max(...c),S=Math.min(...c);const v=c[c.length-1];n.beginPath(),n.moveTo(0,l),c.forEach((P,h)=>{const de=h*(a/c.length),ce=l-(P-S)/(I-S)*l;n.lineTo(de,ce)}),n.stroke(),n.font="14px monospace",n.textBaseline="bottom",N(n,`Current: ${Number(v).toFixed(2)}`,10,l-10),N(n,`Min: ${Number(S).toFixed(2)}`,10,l-30),N(n,`Max: ${Number(I).toFixed(2)}`,10,l-50)}catch(v){console.error("Error drawing graph:",v)}},c=[];let I=0,S=0;x([y,t.value.options],()=>{o.isWidgetVisible(t.value)&&we(()=>w())});const ue=Se(V);return x(ue,(n,a)=>{n&&!a&&w()}),(n,a)=>(_(),$(Ie,null,[s(t).options.dataLakeVariableId?(_(),$("div",Fe,[f("canvas",{ref_key:"canvasRef",ref:V,width:y.value.width,height:y.value.height},null,8,Ge)])):(_(),$("p",Re," Please open the Plotter widget configuration menu to select a variable to be plotted. ")),r(Ne,{modelValue:s(o).widgetManagerVars(s(t).hash).configMenuOpen,"onUpdate:modelValue":a[7]||(a[7]=l=>s(o).widgetManagerVars(s(t).hash).configMenuOpen=l),title:"Plotter config",variant:"text-only"},{content:d(()=>[r(T,null,{default:d(()=>[r(E,{cols:"12"},{default:d(()=>[a[8]||(a[8]=f("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Source",-1)),f("div",We,[r(xe,{modelValue:s(t).options.dataLakeVariableId,"onUpdate:modelValue":a[0]||(a[0]=l=>s(t).options.dataLakeVariableId=l),items:m.value,"item-title":"name","item-value":"id",label:"Data Lake variable",hint:"Select a variable to be plotted","persistent-hint":"",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])])]),_:1})]),_:1}),r(T,null,{default:d(()=>[r(E,{cols:"12"},{default:d(()=>[a[11]||(a[11]=f("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Appearance",-1)),f("div",ze,[r(A,{"close-on-content-click":!1},{activator:d(({props:l})=>[f("div",R(l,{class:"flex cursor-pointer"}),[a[9]||(a[9]=f("span",{class:"mt-1"},"Background color",-1)),f("div",{class:"w-[30px] h-[30px] border-2 border-slate-700 rounded-lg cursor-pointer ml-2",style:C({backgroundColor:s(t).options.backgroundColor})},null,4)],16)]),default:d(()=>[r(F,{class:"overflow-hidden",style:C(s(i).globalGlassMenuStyles)},{default:d(()=>[r(G,{modelValue:s(t).options.backgroundColor,"onUpdate:modelValue":a[1]||(a[1]=l=>s(t).options.backgroundColor=l),label:"Background","hide-inputs":""},null,8,["modelValue"])]),_:1},8,["style"])]),_:1}),r(A,{"close-on-content-click":!1},{activator:d(({props:l})=>[f("div",R(l,{class:"flex cursor-pointer"}),[a[10]||(a[10]=f("span",{class:"mt-1"},"Line color",-1)),f("div",{class:"w-[30px] h-[30px] border-2 border-slate-700 rounded-lg cursor-pointer ml-2",style:C({backgroundColor:s(t).options.lineColor})},null,4)],16)]),default:d(()=>[r(F,{class:"overflow-hidden",style:C(s(i).globalGlassMenuStyles)},{default:d(()=>[r(G,{modelValue:s(t).options.lineColor,"onUpdate:modelValue":a[2]||(a[2]=l=>s(t).options.lineColor=l),label:"Line","hide-inputs":""},null,8,["modelValue"])]),_:1},8,["style"])]),_:1}),r(W,{modelValue:s(t).options.lineThickness,"onUpdate:modelValue":a[3]||(a[3]=l=>s(t).options.lineThickness=l),modelModifiers:{number:!0},type:"number",label:"Line thickness",variant:"outlined",density:"compact",rules:[l=>l>0||"Must be greater than 0"],width:"140px","hide-details":""},null,8,["modelValue","rules"])])]),_:1})]),_:1}),r(T,null,{default:d(()=>[r(E,{cols:"12"},{default:d(()=>[a[12]||(a[12]=f("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Data Points",-1)),f("div",He,[r(Ce,{modelValue:s(t).options.limitSamples,"onUpdate:modelValue":a[4]||(a[4]=l=>s(t).options.limitSamples=l),label:"Limit number of samples"},null,8,["modelValue"]),r(W,{modelValue:s(t).options.maxSamples,"onUpdate:modelValue":a[5]||(a[5]=l=>s(t).options.maxSamples=l),modelModifiers:{number:!0},type:"number",label:"Maximum samples",variant:"outlined",density:"comfortable",disabled:!s(t).options.limitSamples,rules:[l=>l>0||"Must be greater than 0"],hint:"Higher values will show more history but may impact performance",width:"220px"},null,8,["modelValue","disabled","rules"])])]),_:1})]),_:1})]),actions:d(()=>[f("div",Ke,[r(Le,{onClick:a[6]||(a[6]=l=>s(o).widgetManagerVars(s(t).hash).configMenuOpen=!1)},{default:d(()=>a[13]||(a[13]=[Me("Close")])),_:1})])]),_:1},8,["modelValue"])],64))}}),Ye=je(Je,[["__scopeId","data-v-540b6328"]]);export{Ye as default};
//# sourceMappingURL=Plotter-B0HdjN2d.js.map
