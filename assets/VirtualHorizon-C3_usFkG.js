import{c as $,y as E,J as F,M as R,Y as V,u as U,r as u,aB as J,k as M,w as D,aD as g,aA as N,aH as Y,o as j,l as q,m as K,n as O,aF as Q,aG as a,_ as X}from"./index-j_pn1PLB.js";import{g as _}from"./index-C5ZFbjcW.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},b=new s.Error().stack;b&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[b]="0a92556e-8fb1-4e95-88b5-58b4bf48ebcb",s._sentryDebugIdIdentifier="sentry-dbid-0a92556e-8fb1-4e95-88b5-58b4bf48ebcb")}catch{}})();const Z=["height","width"],ee=$({__name:"VirtualHorizon",props:{widget:{}},setup(s){const b=E(),k=F(s).widget;R.registerUsage(V.roll),R.registerUsage(V.pitch);const h=U(),I=u(),p=u(),A=u(),{width:L,height:B}=J(),W=M(()=>k.value.size.width*L.value),x=M(()=>k.value.size.height*B.value),T=M(()=>W.value<x.value?W.value:x.value),H=()=>{if(p.value===void 0||p.value===null)return;A.value===void 0&&(A.value=p.value.getContext("2d"));const e=A.value;Q(e);const r=.5*T.value,c=.06*T.value,i=.03*r;e.textAlign="center",e.strokeStyle="white",e.font=`bold ${c}px Arial`,e.fillStyle="white",e.lineWidth=i,e.textBaseline="middle";const t=.7*r;e.translate(r,r),e.rotate(a(-90)),e.rotate(a(90)),e.save(),e.strokeStyle="white",e.lineWidth=1.5*i,e.beginPath(),e.arc(0,0,t,0,a(360)),e.stroke(),e.restore(),e.save(),e.rotate(a(l.rollAngleDegrees)),e.beginPath(),e.arc(0,0,t,0,a(360)),e.clip();const y=4,n=y*(l.pitchAngleDegrees/90)*t,z=e.createLinearGradient(0,-t,0,t);z.addColorStop(0,"rgb(69, 144, 190)"),z.addColorStop(1,"rgb(137, 190, 228)"),e.fillStyle=z,e.fillRect(-1.5*t,n,3*t,-3*t);const C=e.createLinearGradient(0,-t,0,t);C.addColorStop(0,"rgb(176, 117, 80)"),C.addColorStop(1,"rgb(200, 149, 98)"),e.fillStyle=C,e.fillRect(-1.5*t,n,3*t,3*t),e.lineWidth=.6*i,e.strokeStyle="white",e.beginPath(),e.moveTo(-.75*t,n),e.lineTo(-.45*t,n),e.lineTo(-.43*t,n+.07*t),e.moveTo(.75*t,n),e.lineTo(.45*t,n),e.lineTo(.43*t,n+.07*t),e.stroke(),e.save(),e.fillStyle="white",e.strokeStyle="white",e.lineWidth=.5*i,e.font=`bold ${c}px Arial`;for(const o of[-10,0,10]){const d=y*Math.abs(o/300)||.15,S=y*(o/90)*t,P=y*((o-5*Math.sign(o))/90)*t;e.beginPath(),e.moveTo(-d*t,S),e.lineTo(+d*t,S),e.moveTo(-.5*d*t,P),e.lineTo(.5*d*t,P),e.stroke(),e.textAlign="right",e.fillText(`${Math.abs(o)}`,-1*(d*t+.3*c),S),e.textAlign="left",e.fillText(`${Math.abs(o)}`,1*(d*t+.3*c),S)}e.restore(),e.restore(),e.save(),e.lineWidth=.8*i,e.rotate(a(l.rollAngleDegrees)),e.beginPath(),e.moveTo(-1*t,0),e.lineTo(-.85*t,0),e.moveTo(.85*t,0),e.lineTo(1*t,0),e.stroke(),e.restore();for(const o of[-60,-45,-30,-20,-10,0,10,20,30,45,60])e.save(),e.rotate(a(o)),e.beginPath(),[-60,-30,30,60].includes(o)?(e.lineWidth=.8*i,e.moveTo(0,-1.2*t),e.lineTo(0,-1*t)):[-20,-10,10,20].includes(o)?(e.lineWidth=.6*i,e.moveTo(0,-1.1*t),e.lineTo(0,-1*t)):[-45,45].includes(o)?(e.lineWidth=.01*i,e.moveTo(0,-1.01*t),e.lineTo(-.05*t,-1.15*t),e.lineTo(.05*t,-1.15*t),e.lineTo(0,-1.01*t)):o===0&&(e.lineWidth=.01*i,e.moveTo(0,-1.01*t),e.lineTo(-.07*t,-1.25*t),e.lineTo(.07*t,-1.25*t),e.lineTo(0,-1.01*t)),e.stroke(),e.fill(),e.restore();e.save(),e.beginPath(),e.rotate(a(90)),e.rotate(a(l.rollAngleDegrees)),e.lineWidth=.01*i,e.fillStyle="rgb(221, 43, 43)",e.moveTo(-1*t,0),e.lineTo(-.8*t,-.08*t),e.lineTo(-.8*t,.08*t),e.lineTo(-1*t,0),e.stroke(),e.fill(),e.restore()},v=u(.01),f=u(.01);let w,m;D(h.attitude,e=>{if(w===void 0||m===void 0){v.value=g(h.attitude.roll),f.value=g(h.attitude.pitch),w=e.roll,m=e.pitch;return}const r=Math.abs(g(e.roll-w)),c=Math.abs(g(e.pitch-m));r>.1&&(w=e.roll,v.value=g(h.attitude.roll)),c>.1&&(m=e.pitch,f.value=g(h.attitude.pitch))});const l=N({pitchAngleDegrees:0,rollAngleDegrees:0});return D(f,()=>{_.to(l,.1,{pitchAngleDegrees:f.value})}),D(v,()=>{_.to(l,.1,{rollAngleDegrees:-1*v.value})}),D([l,W,x],()=>{b.isWidgetVisible(k.value)&&Y(()=>H())}),j(()=>{_.to(l,.1,{pitchAngleDegrees:f.value}),_.to(l,.1,{rollAngleDegrees:-1*v.value}),H()}),(e,r)=>(q(),K("div",{ref_key:"virtualHorizonRoot",ref:I,class:"virtualHorizon"},[O("canvas",{ref_key:"canvasRef",ref:p,height:T.value,width:T.value,class:"rounded-[15%] bg-slate-950/70"},null,8,Z)],512))}}),ie=X(ee,[["__scopeId","data-v-1de2f19a"]]);export{ie as default};
//# sourceMappingURL=VirtualHorizon-C3_usFkG.js.map
