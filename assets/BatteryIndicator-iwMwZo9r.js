import{c as P,K as F,u as U,y as k,L as B,r as p,k as g,w as O,M as j,N as D,h as N,l as x,m as h,J as n,H as v,n as s,I as A,x as z,t as w,v as l,V as R,O as E,P as G,Q as H,R as J,S as K,T as I,U as L,W as Q,F as $}from"./index-DrigeUUK.js";const q={class:"relative right-0 flex flex-col w-[4rem] select-none text-sm font-semibold leading-4 text-end -mr-2"},X={class:"w-full"},Y={class:"flex justify-end gap-x-1 items-center"},Z={class:"font-mono"},ee={class:"w-full"},te={key:0,class:"flex justify-end gap-x-1 items-center"},oe={class:"font-mono mt-[2px]"},se={key:1,class:"flex justify-end gap-x-1 items-center text-yellow-100"},le={class:"font-mono mt-[2px]"},ae={class:"text-red-500 text-center text-sm w-[full]"},u=500,ie=P({__name:"BatteryIndicator",props:{miniWidget:{}},setup(S){const e=F(S).miniWidget,y={showCurrent:!0,showPower:!0,toggleInterval:1e3},o=U(),V=k(),C=B(),m=p(!0),d=p(void 0),c=p(""),f=p(void 0),r=p(e.value.options.toggleInterval??y.toggleInterval),_=g(()=>{var i;return((i=o==null?void 0:o.powerSupply)==null?void 0:i.voltage)===void 0?"--":Math.abs(o.powerSupply.voltage)>=100?o.powerSupply.voltage.toFixed(0):o.powerSupply.voltage.toFixed(1)}),M=g(()=>{var i;return((i=o==null?void 0:o.powerSupply)==null?void 0:i.current)===void 0?"--":Math.abs(o.powerSupply.current)>=100?o.powerSupply.current.toFixed(0):o.powerSupply.current.toFixed(1)}),T=g(()=>o.instantaneousWatts!==void 0?o.instantaneousWatts.toFixed(1):"--"),W=g(()=>"mdi-battery"),b=()=>{(d.value||f.value)&&(clearInterval(d.value),clearTimeout(f.value)),r.value<u?(e.value.options.toggleInterval=u,c.value=`Interval must be at least ${u}ms.`):e.value.options.toggleInterval=r.value,!e.value.options.showCurrent&&!e.value.options.showPower&&(e.value.options.showCurrent=!0,e.value.options.showPower=!0,c.value="At least one of the options must be enabled."),e.value.options.showCurrent&&e.value.options.showPower?d.value=setInterval(()=>{m.value=!m.value},e.value.options.toggleInterval):m.value=e.value.options.showCurrent,f.value=setTimeout(()=>{c.value="",r.value<u&&(r.value=u)},5e3)};return O([()=>e.value.options,r],b,{deep:!0}),j(()=>{e.value.options=Object.assign({},y,e.value.options),b(),D.registerUsage("Instantaneous Watts")}),N(()=>{d.value===void 0&&clearInterval(d.value)}),(i,t)=>(h(),x($,null,[n(R,{text:l(o).isVehicleOnline?"Vehicle connected":"Vehicle disconnected",location:"top"},{activator:v(({props:a})=>[s("div",A({class:"flex items-center w-[95px] h-12 text-white justify-center"},a),[s("span",{class:z(["relative w-[1.5rem] mdi battery-icon left-0 mr-3",[W.value]])},t[4]||(t[4]=[s("span",{class:"absolute text-sm text-yellow-400 -bottom-[3px] left-[4px] mdi mdi-alert-circle"},null,-1)]),2),s("div",q,[s("div",X,[s("div",Y,[s("span",Z,w(_.value),1),t[5]||(t[5]=s("div",{class:"w-[15px] mr-[1px] -ml-[1px]"},"V",-1))])]),s("div",ee,[m.value?(h(),x("div",te,[s("span",oe,w(M.value),1),t[6]||(t[6]=s("div",{class:"w-[15px]"},"A",-1))])):(h(),x("div",se,[s("span",le,w(T.value),1),t[7]||(t[7]=s("div",{class:"w-[15px]"},"W",-1))]))])])],16)]),_:1},8,["text"]),n(Q,{modelValue:l(V).miniWidgetManagerVars(l(e).hash).configMenuOpen,"onUpdate:modelValue":t[3]||(t[3]=a=>l(V).miniWidgetManagerVars(l(e).hash).configMenuOpen=a),width:"auto"},{default:v(()=>[n(E,{class:"pa-4 text-white w-[20rem]",style:G([{"border-radius":"15px"},l(C).globalGlassMenuStyles])},{default:v(()=>[n(H,{class:"text-center"},{default:v(()=>t[8]||(t[8]=[J("Battery Indicator Config")])),_:1,__:[8]}),n(K,{class:"flex flex-col gap-y-4"},{default:v(()=>[n(I,{modelValue:l(e).options.showCurrent,"onUpdate:modelValue":t[0]||(t[0]=a=>l(e).options.showCurrent=a),label:"Show Current","hide-details":""},null,8,["modelValue"]),n(I,{modelValue:l(e).options.showPower,"onUpdate:modelValue":t[1]||(t[1]=a=>l(e).options.showPower=a),label:"Show Power","hide-details":""},null,8,["modelValue"]),n(L,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=a=>r.value=a),modelModifiers:{number:!0},label:"Toggle Interval (ms)",type:"number",min:u,step:"100",density:"compact",variant:"outlined",disabled:!l(e).options.showCurrent||!l(e).options.showPower},null,8,["modelValue","disabled"]),s("p",ae,w(c.value),1)]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])],64))}});export{ie as default};
