{"version":3,"file":"Switch-Ci1xq_3-.js","sources":["../../src/components/custom-widget-elements/Switch.vue"],"sourcesContent":["<template>\n  <div\n    class=\"flex items-center h-[30px] px-4\"\n    :class=\"\n      widgetStore.elementToShowOnDrawer?.hash === miniWidget.hash && widgetStore.editingMode\n        ? 'bg-[#00000010] '\n        : 'border-0'\n    \"\n    @click=\"widgetStore.editingMode && widgetStore.showElementPropsDrawer(miniWidget.hash)\"\n  >\n    <v-switch\n      v-model=\"switchValue\"\n      hide-details\n      :color=\"miniWidget.options.layout?.color || '#FFFFFF'\"\n      :class=\"{ 'pointer-events-none': widgetStore.editingMode }\"\n      class=\"min-w-[35px]\"\n      @change=\"handleToggleAction\"\n    />\n    <p v-if=\"miniWidget.options.layout?.label !== ''\" class=\"ml-3 mb-[3px] whitespace-nowrap\">\n      {{ miniWidget.options.layout?.label }}\n    </p>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { onMounted, onUnmounted, ref, toRefs, watch } from 'vue'\n\nimport {\n  deleteCockpitActionVariable,\n  listenCockpitActionVariable,\n  setCockpitActionVariableData,\n  unlistenCockpitActionVariable,\n} from '@/libs/actions/data-lake'\nimport { useWidgetManagerStore } from '@/stores/widgetManager'\nimport { CustomWidgetElementOptions, CustomWidgetElementType } from '@/types/widgets'\n\nconst widgetStore = useWidgetManagerStore()\n\nconst props = defineProps<{\n  /**\n   * Element instance\n   */\n  miniWidget: CustomWidgetElementOptions[CustomWidgetElementType.Switch]\n}>()\n\nconst miniWidget = toRefs(props).miniWidget\nconst switchValue = ref(true)\n\nwatch(\n  () => widgetStore.miniWidgetManagerVars(miniWidget.value.hash).configMenuOpen,\n  (newValue) => {\n    if (newValue === true) {\n      widgetStore.showElementPropsDrawer(miniWidget.value.hash)\n      setTimeout(() => {\n        widgetStore.miniWidgetManagerVars(miniWidget.value.hash).configMenuOpen = false\n      }, 200)\n    }\n  },\n  { immediate: true, deep: true }\n)\n\nconst handleToggleAction = (): void => {\n  if (widgetStore.editingMode) return\n  if (miniWidget.value.options.actionVariable) {\n    widgetStore.setMiniWidgetLastValue(miniWidget.value.hash, switchValue.value)\n    setCockpitActionVariableData(miniWidget.value.options.actionVariable.name, switchValue.value)\n  }\n}\n\nonMounted(() => {\n  if (!props.miniWidget.options || Object.keys(props.miniWidget.options).length === 0) {\n    miniWidget.value.isCustomElement = true\n    widgetStore.updateElementOptions(props.miniWidget.hash, {\n      layout: {\n        align: miniWidget.value.options.layout?.align || 'center',\n        color: miniWidget.value.options.layout?.color || '#FFFFFF',\n        label: miniWidget.value.options.layout?.label || '',\n      },\n      variableType: 'boolean',\n      actionVariable: undefined,\n      toggled: true,\n    })\n\n    switchValue.value = true\n  } else if (miniWidget.value.options.actionVariable) {\n    listenCockpitActionVariable(miniWidget.value.options.actionVariable.name, (value) => {\n      switchValue.value = value as boolean\n    })\n    switchValue.value = widgetStore.getMiniWidgetLastValue(miniWidget.value.hash) as boolean\n  }\n})\n\nonUnmounted(() => {\n  if (miniWidget.value.options.actionVariable) {\n    unlistenCockpitActionVariable(miniWidget.value.options.actionVariable.name)\n    deleteCockpitActionVariable(miniWidget.value.options.actionVariable.id)\n  }\n})\n</script>\n\n<style scoped></style>\n"],"names":["widgetStore","useWidgetManagerStore","props","__props","miniWidget","toRefs","switchValue","ref","watch","newValue","handleToggleAction","setCockpitActionVariableData","onMounted","_a","_b","_c","listenCockpitActionVariable","value","onUnmounted","unlistenCockpitActionVariable","deleteCockpitActionVariable"],"mappings":"2kBAoCA,MAAMA,EAAcC,IAEdC,EAAQC,EAORC,EAAaC,EAAOH,CAAK,EAAE,WAC3BI,EAAcC,EAAI,EAAI,EAE5BC,EACE,IAAMR,EAAY,sBAAsBI,EAAW,MAAM,IAAI,EAAE,eAC9DK,GAAa,CACRA,IAAa,KACHT,EAAA,uBAAuBI,EAAW,MAAM,IAAI,EACxD,WAAW,IAAM,CACfJ,EAAY,sBAAsBI,EAAW,MAAM,IAAI,EAAE,eAAiB,IACzE,GAAG,EAEV,EACA,CAAE,UAAW,GAAM,KAAM,EAAK,CAAA,EAGhC,MAAMM,EAAqB,IAAY,CACjCV,EAAY,aACZI,EAAW,MAAM,QAAQ,iBAC3BJ,EAAY,uBAAuBI,EAAW,MAAM,KAAME,EAAY,KAAK,EAC3EK,EAA6BP,EAAW,MAAM,QAAQ,eAAe,KAAME,EAAY,KAAK,EAC9F,EAGF,OAAAM,EAAU,IAAM,WACV,CAACV,EAAM,WAAW,SAAW,OAAO,KAAKA,EAAM,WAAW,OAAO,EAAE,SAAW,GAChFE,EAAW,MAAM,gBAAkB,GACvBJ,EAAA,qBAAqBE,EAAM,WAAW,KAAM,CACtD,OAAQ,CACN,QAAOW,EAAAT,EAAW,MAAM,QAAQ,SAAzB,YAAAS,EAAiC,QAAS,SACjD,QAAOC,EAAAV,EAAW,MAAM,QAAQ,SAAzB,YAAAU,EAAiC,QAAS,UACjD,QAAOC,EAAAX,EAAW,MAAM,QAAQ,SAAzB,YAAAW,EAAiC,QAAS,EACnD,EACA,aAAc,UACd,eAAgB,OAChB,QAAS,EAAA,CACV,EAEDT,EAAY,MAAQ,IACXF,EAAW,MAAM,QAAQ,iBAClCY,EAA4BZ,EAAW,MAAM,QAAQ,eAAe,KAAOa,GAAU,CACnFX,EAAY,MAAQW,CAAA,CACrB,EACDX,EAAY,MAAQN,EAAY,uBAAuBI,EAAW,MAAM,IAAI,EAC9E,CACD,EAEDc,EAAY,IAAM,CACZd,EAAW,MAAM,QAAQ,iBAC3Be,EAA8Bf,EAAW,MAAM,QAAQ,eAAe,IAAI,EAC1EgB,EAA4BhB,EAAW,MAAM,QAAQ,eAAe,EAAE,EACxE,CACD"}