import{A as E}from"./AlertIcon-B9EZ1da3.js";import{c as T,e as _,h as r,t as I,r as w,w as c,o as P,j as z,m as B,n as L,q as y,s as N,v as j,E as A,p as R,aM as U,aN as $,an as q,y as M,z as o,Q as J,x as Q,aO as F,aa as G,aJ as H,a5 as D,_ as K}from"./index-Bpw_4DmJ.js";const X=T({__name:"Dropdown",props:{miniWidget:{}},setup(C){var f,V;const i=_();let n;const v=C,l=r(()=>{var a;return((a=e.value.options.layout)==null?void 0:a.selectorOptions)||[]}),e=I(v).miniWidget,m=w(l.value.find(a=>{var t;return a.value===((t=v.miniWidget.options.lastSelected)==null?void 0:t.value)})||l.value[0]),s=w(((f=v.miniWidget.options.lastSelected)==null?void 0:f.value)||((V=l.value[0])==null?void 0:V.value));c(()=>i.miniWidgetManagerVars(e.value.hash).configMenuOpen,a=>{a===!0&&(i.showElementPropsDrawer(e.value.hash),setTimeout(()=>{i.miniWidgetManagerVars(e.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0}),c(m,a=>{i.updateElementOptions(e.value.hash,{...e.value.options,lastSelected:a})});const S=a=>{if(i.editingMode)return;const t=l.value.find(d=>d.value===a);t&&(s.value=a,e.value.options.dataLakeVariable&&F(e.value.options.dataLakeVariable.id,a),i.setMiniWidgetLastValue(e.value.hash,t.value))},W=r(()=>!u.value&&!i.editingMode&&i.isRealMiniWidget(e.value.hash)),u=r(()=>{var a;return!!((a=e.value.options.dataLakeVariable)!=null&&a.id)}),h=r(()=>{var a;return((a=e.value.options.dataLakeVariable)==null?void 0:a.allowUserToChangeValue)===!0}),x=r(()=>u.value&&h.value&&!i.editingMode),g=()=>{e.value.options.dataLakeVariable&&(n=G(e.value.options.dataLakeVariable.id,a=>{s.value=String(a)}),s.value=String(H(e.value.options.dataLakeVariable.id)))};return c(()=>{var a;return(a=e.value.options.dataLakeVariable)==null?void 0:a.id},(a,t)=>{t&&n&&D(t,n),a&&g()}),P(()=>{if((!e.value.options||Object.keys(e.value.options).length===0)&&(e.value.isCustomElement=!0,i.updateElementOptions(e.value.hash,{layout:{selectorOptions:[],align:"start",width:168},variableType:"string",dataLakeVariable:void 0})),e.value.options.dataLakeVariable)g();else{const a=i.getMiniWidgetLastValue(e.value.hash);m.value=l.value.find(t=>t.value===a)||l.value[0]}}),z(()=>{e.value.options.dataLakeVariable&&n&&D(e.value.options.dataLakeVariable.id,n)}),(a,t)=>{var d,k;return L(),B("div",{class:M(["flex relative w-full",((d=o(i).elementToShowOnDrawer)==null?void 0:d.hash)===o(e).hash&&o(i).editingMode?"bg-[#00000010] ":"border-0"]),style:Q({width:"100%",justifyContent:(k=o(e).options.layout)==null?void 0:k.align}),onClick:t[2]||(t[2]=p=>o(i).editingMode&&o(i).showElementPropsDrawer(o(e).hash))},[y(J,{text:"This element is in display mode. To make it interactive, create or select a user-controlled data-lake variable",location:"top","open-delay":"500",disabled:h.value||!u.value},{activator:A(({props:p})=>{var b;return[R("div",U($(p)),[y(q,{modelValue:s.value,"onUpdate:modelValue":[t[0]||(t[0]=O=>s.value=O),S],items:l.value,"item-title":"name","item-value":"value",theme:"dark",density:"compact",variant:"filled","min-width":((b=o(e).options.layout)==null?void 0:b.width)||168,"hide-details":"",class:M(["text-white",[x.value?"pointer-events-auto cursor-pointer":"pointer-events-none cursor-default",u.value?"":"opacity-50"]])},null,8,["modelValue","items","min-width","class"])],16)]}),_:1},8,["disabled"]),W.value?(L(),N(E,{key:0,icon:"mdi-connection",color:"#b9af1d",animation:"pulse",class:"absolute center ml-[70px] mt-[12px]",tooltip:"This element isn't connected to a data-lake variable yet. Click here to configure it.",onClick:t[1]||(t[1]=p=>o(i).showElementPropsDrawer(o(e).hash))})):j("",!0)],6)}}}),ee=K(X,[["__scopeId","data-v-326346cc"]]);export{ee as default};
