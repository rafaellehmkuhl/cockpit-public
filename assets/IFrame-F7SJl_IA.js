import{c as _,bw as R,K as I,y as O,r as u,J as T,L as B,bD as b,ae as $,o as D,k,w as E,l as N,m as j,n as c,G as F,aU as A,q as n,H as t,N as r,V as K,O as W,P as z,Q as h,R as y,U as G,aD as P,a6 as M,T as q,aF as H,bz as J,W as Q,bE as X,F as Y,bF as Z,at as ee,_ as ae}from"./index-BA2C2lKu.js";const te={class:"w-full h-full"},se=["src"],oe={class:"flex items-center justify-between"},le=_({__name:"IFrame",props:{widget:{}},setup(x){R(o=>({"314d23c4":U.value,"28f340b3":L.value}));const S=I(),i=O(),m=u(),a=T(x).widget,g=u(!1),f=u(0),l=u(a.value.options.source),d=u(!1),p=u(""),v=o=>Z(o)?!0:"URL is not valid.",V=()=>{const o=v(l.value);if(o!==!0){p.value=`${o} Please enter a valid URL.`,d.value=!0;return}a.value.options.source=l.value,p.value=`IFrame URL sucessfully updated to '${l.value}'.`,d.value=!0},w=o=>{if(o.data.type!=="cockpit:listenToDatalakeVariables")return;const{variable:e}=o.data;ee(e,s=>{m.value.contentWindow.postMessage({type:"cockpit:datalakeVariable",variable:e,value:s},"*")})};B(()=>{console.log(`IFrame '${a.value.hash}' with source '${a.value.options.source}' will mount.`),window.addEventListener("message",w,!0),Object.keys(a.value.options).length===0&&(a.value.options={source:"http://"+b},l.value=b)}),$(()=>{window.removeEventListener("message",w,!0)}),D(()=>{console.log(`IFrame '${a.value.hash}' with source '${a.value.options.source}' mounted.`)});const U=k(()=>(100-f.value)/100),L=k(()=>i.editingMode?"none":"auto");function C(){console.log("Finished loading"),g.value=!0}return E(a,()=>{i.widgetManagerVars(a.value.hash).configMenuOpen===!1&&v(l.value)!==!0&&(l.value=a.value.options.source)},{deep:!0}),(o,e)=>(N(),j(Y,null,[c("div",te,[F(c("iframe",{ref_key:"iframe",ref:m,src:n(a).options.source,frameborder:"0",onLoad:C},null,40,se),[[A,g.value]]),t(Q,{modelValue:n(i).widgetManagerVars(n(a).hash).configMenuOpen,"onUpdate:modelValue":e[3]||(e[3]=s=>n(i).widgetManagerVars(n(a).hash).configMenuOpen=s),"min-width":"400","max-width":"35%"},{default:r(()=>[t(K,{class:"pa-2",style:W(n(S).globalGlassMenuStyles)},{default:r(()=>[t(z,{class:"text-center"},{default:r(()=>e[5]||(e[5]=[h("Settings")])),_:1}),t(y,null,{default:r(()=>[e[6]||(e[6]=c("p",null,"Iframe Source",-1)),c("div",oe,[t(G,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value=s),variant:"filled",outlined:"",rules:[v],onKeydown:P(V,["enter"])},null,8,["modelValue","rules"]),F(t(M,{icon:"mdi-check",class:"mx-1 mb-5 bg-[#FFFFFF22]",rounded:"lg",flat:"",onClick:V},null,512),[[q,"Set",void 0,{bottom:!0}]])])]),_:1}),t(y,null,{default:r(()=>[t(H,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=s=>f.value=s),label:"Transparency",color:"white",min:0,max:90},null,8,["modelValue"])]),_:1}),t(J,{class:"flex justify-end"},{default:r(()=>[t(M,{color:"white",onClick:e[2]||(e[2]=s=>n(i).widgetManagerVars(n(a).hash).configMenuOpen=!1)},{default:r(()=>e[7]||(e[7]=[h(" Close ")])),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])]),t(X,{"open-snackbar":d.value,message:p.value,duration:3e3,"close-button":!1,"onUpdate:openSnackbar":e[4]||(e[4]=s=>d.value=s)},null,8,["open-snackbar","message"])],64))}}),ue=ae(le,[["__scopeId","data-v-7d9a9364"]]);export{ue as default};
