import{bN as P,bK as B,b0 as J,b1 as q,bh as X,b3 as Z,k as N,bO as ee,c as he,K as Ve,y as ye,J as ke,r as $,L as we,o as Se,bP as xe,bQ as Ce,h as Le,bR as Me,au as Ne,w as L,aB as Pe,aF as Ie,aH as je,aE as Te,l as E,m as O,q as s,n as f,H as r,N as d,ah as $e,aQ as G,a2 as W,O as M,V as z,aI as H,U,S as Ee,a5 as Oe,Q as Ue,a6 as De,F as _e,aw as K,_ as Be}from"./index-C_CF9HC8.js";const te=P.reduce((t,i)=>(t[i]={type:[Boolean,String,Number],default:!1},t),{}),ae=P.reduce((t,i)=>{const o="offset"+B(i);return t[o]={type:[String,Number],default:null},t},{}),le=P.reduce((t,i)=>{const o="order"+B(i);return t[o]={type:[String,Number],default:null},t},{}),Q={col:Object.keys(te),offset:Object.keys(ae),order:Object.keys(le)};function Ae(t,i,o){let u=t;if(!(o==null||o===!1)){if(i){const e=i.replace(t,"");u+=`-${e}`}return t==="col"&&(u="v-"+u),t==="col"&&(o===""||o===!0)||(u+=`-${o}`),u.toLowerCase()}}const Re=["auto","start","end","center","baseline","stretch"],Fe=J({cols:{type:[Boolean,String,Number],default:!1},...te,offset:{type:[String,Number],default:null},...ae,order:{type:[String,Number],default:null},...le,alignSelf:{type:String,default:null,validator:t=>Re.includes(t)},...q(),...X()},"VCol"),D=Z()({name:"VCol",props:Fe(),setup(t,i){let{slots:o}=i;const u=N(()=>{const e=[];let m;for(m in Q)Q[m].forEach(b=>{const g=t[b],V=Ae(m,b,g);V&&e.push(V)});const p=e.some(b=>b.startsWith("v-col-"));return e.push({"v-col":!p||!t.cols,[`v-col-${t.cols}`]:t.cols,[`offset-${t.offset}`]:t.offset,[`order-${t.order}`]:t.order,[`align-self-${t.alignSelf}`]:t.alignSelf}),e});return()=>{var e;return ee(t.tag,{class:[u.value,t.class],style:t.style},(e=o.default)==null?void 0:e.call(o))}}}),A=["start","end","center"],ne=["space-between","space-around","space-evenly"];function R(t,i){return P.reduce((o,u)=>{const e=t+B(u);return o[e]=i(),o},{})}const Ge=[...A,"baseline","stretch"],oe=t=>Ge.includes(t),se=R("align",()=>({type:String,default:null,validator:oe})),We=[...A,...ne],ie=t=>We.includes(t),re=R("justify",()=>({type:String,default:null,validator:ie})),ze=[...A,...ne,"stretch"],ue=t=>ze.includes(t),de=R("alignContent",()=>({type:String,default:null,validator:ue})),Y={align:Object.keys(se),justify:Object.keys(re),alignContent:Object.keys(de)},He={align:"align",justify:"justify",alignContent:"align-content"};function Ke(t,i,o){let u=He[t];if(o!=null){if(i){const e=i.replace(t,"");u+=`-${e}`}return u+=`-${o}`,u.toLowerCase()}}const Qe=J({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:oe},...se,justify:{type:String,default:null,validator:ie},...re,alignContent:{type:String,default:null,validator:ue},...de,...q(),...X()},"VRow"),_=Z()({name:"VRow",props:Qe(),setup(t,i){let{slots:o}=i;const u=N(()=>{const e=[];let m;for(m in Y)Y[m].forEach(p=>{const b=t[p],g=Ke(m,p,b);g&&e.push(g)});return e.push({"v-row--no-gutters":t.noGutters,"v-row--dense":t.dense,[`align-${t.align}`]:t.align,[`justify-${t.justify}`]:t.justify,[`align-content-${t.alignContent}`]:t.alignContent}),e});return()=>{var e;return ee(t.tag,{class:["v-row",u.value,t.class],style:t.style},(e=o.default)==null?void 0:e.call(o))}}}),Ye={key:0,class:"w-full h-full flex items-center justify-center text-center text-white text-h5 font-weight-bold p-4 overflow-hidden"},Je={key:1,class:"main"},qe=["width","height"],Xe={class:"ml-2"},Ze={class:"ml-2 flex gap-x-8"},et={class:"ml-2 flex gap-x-8"},tt={class:"flex w-full justify-end my-2"},at=he({__name:"Plotter",props:{widget:{}},setup(t){const i=Ve(),o=ye(),e=ke(t).widget,m=$([]);let p,b;we(()=>{const n={backgroundColor:"rgba(0, 0, 0, 0.7)",lineColor:"rgba(255, 0, 0, 1.0)",dataLakeVariableId:void 0,maxSamples:1e3,limitSamples:!0,lineThickness:1,decimalPlaces:2};e.value.options={...n,...e.value.options}}),Se(()=>{F(e.value.options.dataLakeVariableId),m.value=Object.values(xe()),b=Ce(n=>{m.value=Object.values(n)})}),Le(()=>{b&&Me(b),p&&K(e.value.options.dataLakeVariableId,p)});const g=N(()=>m.value.filter(n=>n.type==="number")),V=()=>{e.value.options.limitSamples&&(c.length===e.value.options.maxSamples+1?c.shift():c.length>e.value.options.maxSamples&&c.splice(0,c.length-e.value.options.maxSamples))},F=(n,a)=>{if(n===void 0){console.error("No data lake variable ID provided!");return}a!==void 0&&p&&K(a,p),p=Ne(n,l=>{c.push(l),V(),x()})};L([e.value.options.maxSamples,e.value.options.limitSamples],()=>{V(),x()}),L(()=>e.value.options.dataLakeVariableId,(n,a)=>{F(n,a),c.length=0});const{width:ce,height:fe}=Pe(),y=N(()=>({width:e.value.size.width*ce.value,height:e.value.size.height*fe.value})),k=$(),I=$(),j=(n,a,l,v)=>{const C=n.measureText(a),h=4;n.fillStyle="rgba(0, 0, 0, 0.5)",n.fillRect(l-h,v-16-h,C.width+h*2,16+h*2),n.fillStyle=e.value.options.lineColor,n.fillText(a,l,v)},x=()=>{if(k.value===void 0||k.value===null)return;if(I.value===void 0){console.debug("Canvas context undefined!"),I.value=k.value.getContext("2d");return}const n=I.value,a=y.value.width,l=y.value.height;Ie(n),n.clearRect(0,0,a,l),n.fillStyle=e.value.options.backgroundColor,n.fillRect(0,0,a,l),n.strokeStyle=e.value.options.lineColor,n.lineWidth=Math.max(e.value.options.lineThickness,1);try{if(c.length===0)return;w=Math.max(...c);const v=w>0?w*1.05:w*.95;S=Math.min(...c);const C=S>0?S*.95:S*1.05,h=c[c.length-1];n.beginPath(),n.moveTo(0,l),c.forEach((pe,be)=>{const ge=be*(a/c.length),ve=l-(pe-C)/(v-C)*l;n.lineTo(ge,ve)}),n.stroke(),n.font="14px monospace",n.textBaseline="bottom";const T=e.value.options.decimalPlaces;j(n,`Current: ${Number(h).toFixed(T)}`,10,l-10),j(n,`Min: ${Number(S).toFixed(T)}`,10,l-30),j(n,`Max: ${Number(w).toFixed(T)}`,10,l-50)}catch(v){console.error("Error drawing graph:",v)}},c=[];let w=0,S=0;L([y,e.value.options],()=>{o.isWidgetVisible(e.value)&&je(()=>x())});const me=Te(k);return L(me,(n,a)=>{n&&!a&&x()}),(n,a)=>(E(),O(_e,null,[s(e).options.dataLakeVariableId?(E(),O("div",Je,[f("canvas",{ref_key:"canvasRef",ref:k,width:y.value.width,height:y.value.height},null,8,qe)])):(E(),O("p",Ye," Please open the Plotter widget configuration menu to select a variable to be plotted. ")),r(De,{modelValue:s(o).widgetManagerVars(s(e).hash).configMenuOpen,"onUpdate:modelValue":a[8]||(a[8]=l=>s(o).widgetManagerVars(s(e).hash).configMenuOpen=l),title:"Plotter config",variant:"text-only"},{content:d(()=>[r(_,null,{default:d(()=>[r(D,{cols:"12"},{default:d(()=>[a[9]||(a[9]=f("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Source",-1)),f("div",Xe,[r($e,{modelValue:s(e).options.dataLakeVariableId,"onUpdate:modelValue":a[0]||(a[0]=l=>s(e).options.dataLakeVariableId=l),items:g.value,"item-title":"name","item-value":"id",label:"Data Lake variable",hint:"Select a variable to be plotted","persistent-hint":"",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])])]),_:1})]),_:1}),r(_,null,{default:d(()=>[r(D,{cols:"12"},{default:d(()=>[a[12]||(a[12]=f("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Appearance",-1)),f("div",Ze,[r(G,{"close-on-content-click":!1},{activator:d(({props:l})=>[f("div",W(l,{class:"flex cursor-pointer"}),[a[10]||(a[10]=f("span",{class:"mt-1"},"Background color",-1)),f("div",{class:"w-[30px] h-[30px] border-2 border-slate-700 rounded-lg cursor-pointer ml-2",style:M({backgroundColor:s(e).options.backgroundColor})},null,4)],16)]),default:d(()=>[r(z,{class:"overflow-hidden",style:M(s(i).globalGlassMenuStyles)},{default:d(()=>[r(H,{modelValue:s(e).options.backgroundColor,"onUpdate:modelValue":a[1]||(a[1]=l=>s(e).options.backgroundColor=l),label:"Background","hide-inputs":""},null,8,["modelValue"])]),_:1},8,["style"])]),_:1}),r(G,{"close-on-content-click":!1},{activator:d(({props:l})=>[f("div",W(l,{class:"flex cursor-pointer"}),[a[11]||(a[11]=f("span",{class:"mt-1"},"Line color",-1)),f("div",{class:"w-[30px] h-[30px] border-2 border-slate-700 rounded-lg cursor-pointer ml-2",style:M({backgroundColor:s(e).options.lineColor})},null,4)],16)]),default:d(()=>[r(z,{class:"overflow-hidden",style:M(s(i).globalGlassMenuStyles)},{default:d(()=>[r(H,{modelValue:s(e).options.lineColor,"onUpdate:modelValue":a[2]||(a[2]=l=>s(e).options.lineColor=l),label:"Line","hide-inputs":""},null,8,["modelValue"])]),_:1},8,["style"])]),_:1}),r(U,{modelValue:s(e).options.lineThickness,"onUpdate:modelValue":a[3]||(a[3]=l=>s(e).options.lineThickness=l),modelModifiers:{number:!0},type:"number",label:"Line thickness",variant:"outlined",density:"compact",rules:[l=>l>0||"Must be greater than 0"],width:"140px","hide-details":""},null,8,["modelValue","rules"])])]),_:1})]),_:1}),r(_,null,{default:d(()=>[r(D,{cols:"12"},{default:d(()=>[a[13]||(a[13]=f("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Points",-1)),f("div",et,[r(U,{modelValue:s(e).options.decimalPlaces,"onUpdate:modelValue":a[4]||(a[4]=l=>s(e).options.decimalPlaces=l),modelModifiers:{number:!0},type:"number",label:"Decimal places",variant:"outlined",density:"comfortable",rules:[l=>l>=0||"Must be 0 or greater"],hint:"Number of decimal places to be displayed",width:"160px",class:"ml-2"},null,8,["modelValue","rules"]),r(Ee,{modelValue:s(e).options.limitSamples,"onUpdate:modelValue":a[5]||(a[5]=l=>s(e).options.limitSamples=l),label:"Limit number of samples"},null,8,["modelValue"]),r(U,{modelValue:s(e).options.maxSamples,"onUpdate:modelValue":a[6]||(a[6]=l=>s(e).options.maxSamples=l),modelModifiers:{number:!0},type:"number",label:"Maximum samples",variant:"outlined",density:"comfortable",disabled:!s(e).options.limitSamples,rules:[l=>l>0||"Must be greater than 0"],hint:"Higher values will show more history but may impact performance",width:"220px"},null,8,["modelValue","disabled","rules"])])]),_:1})]),_:1})]),actions:d(()=>[f("div",tt,[r(Oe,{onClick:a[7]||(a[7]=l=>s(o).widgetManagerVars(s(e).hash).configMenuOpen=!1)},{default:d(()=>a[14]||(a[14]=[Ue("Close")])),_:1})])]),_:1},8,["modelValue"])],64))}}),nt=Be(at,[["__scopeId","data-v-6dafbd2d"]]);export{nt as default};
