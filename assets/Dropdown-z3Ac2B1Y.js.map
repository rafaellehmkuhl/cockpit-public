{"version":3,"file":"Dropdown-z3Ac2B1Y.js","sources":["../../src/components/custom-widget-elements/Dropdown.vue"],"sourcesContent":["<template>\n  <div\n    class=\"flex w-full\"\n    :style=\"{ width: '100%', justifyContent: miniWidget.options.layout?.align }\"\n    :class=\"\n      widgetStore.elementToShowOnDrawer?.hash === miniWidget.hash && widgetStore.editingMode\n        ? 'bg-[#00000010] '\n        : 'border-0'\n    \"\n    @click=\"widgetStore.editingMode && widgetStore.showElementPropsDrawer(miniWidget.hash)\"\n  >\n    <div>\n      <v-select\n        v-model=\"selectedValue\"\n        :items=\"options\"\n        item-title=\"name\"\n        item-value=\"value\"\n        theme=\"dark\"\n        density=\"compact\"\n        variant=\"filled\"\n        :min-width=\"miniWidget.options.layout?.width || 168\"\n        hide-details\n        class=\"text-white\"\n        :class=\"{ 'pointer-events-none': widgetStore.editingMode }\"\n        @update:model-value=\"handleSelection\"\n      >\n        >\n      </v-select>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, onUnmounted, ref, toRefs, watch } from 'vue'\n\nimport {\n  deleteDataLakeVariable,\n  listenDataLakeVariable,\n  setDataLakeVariableData,\n  unlistenDataLakeVariable,\n} from '@/libs/actions/data-lake'\nimport { useWidgetManagerStore } from '@/stores/widgetManager'\nimport { CustomWidgetElementOptions, CustomWidgetElementType, SelectorOption } from '@/types/widgets'\n\nconst widgetStore = useWidgetManagerStore()\nlet listenerId: string | undefined\n\nconst props = defineProps<{\n  /**\n   * Element instance\n   */\n  miniWidget: CustomWidgetElementOptions[CustomWidgetElementType.Dropdown]\n}>()\n\nconst options = computed(() => {\n  return miniWidget.value.options.layout?.selectorOptions || []\n})\n\nconst miniWidget = toRefs(props).miniWidget\nconst selectedOption = ref<SelectorOption | undefined>(\n  options.value.find((option) => option.value === props.miniWidget.options.lastSelected?.value) || options.value[0]\n)\n\nconst selectedValue = ref<string | number | boolean>(\n  props.miniWidget.options.lastSelected?.value || options.value[0]?.value\n)\n\nwatch(\n  () => widgetStore.miniWidgetManagerVars(miniWidget.value.hash).configMenuOpen,\n  (newValue) => {\n    if (newValue === true) {\n      widgetStore.showElementPropsDrawer(miniWidget.value.hash)\n      setTimeout(() => {\n        widgetStore.miniWidgetManagerVars(miniWidget.value.hash).configMenuOpen = false\n      }, 200)\n    }\n  },\n  { immediate: true, deep: true }\n)\n\nwatch(selectedOption, (newValue) => {\n  widgetStore.updateElementOptions(miniWidget.value.hash, {\n    ...miniWidget.value.options,\n    lastSelected: newValue,\n  })\n})\n\nconst handleSelection = (value: string | number | boolean): void => {\n  if (widgetStore.editingMode) return\n\n  const selected = options.value.find((option) => option.value === value)\n  if (!selected) return\n\n  selectedValue.value = value\n\n  if (miniWidget.value.options.dataLakeVariable) {\n    setDataLakeVariableData(miniWidget.value.options.dataLakeVariable.id, value)\n  }\n  widgetStore.setMiniWidgetLastValue(miniWidget.value.hash, selected.value)\n}\n\nonMounted(() => {\n  if (!miniWidget.value.options || Object.keys(miniWidget.value.options).length === 0) {\n    miniWidget.value.isCustomElement = true\n    widgetStore.updateElementOptions(miniWidget.value.hash, {\n      layout: {\n        selectorOptions: [],\n        align: 'start',\n        width: 168,\n      },\n      variableType: 'string',\n      dataLakeVariable: undefined,\n    })\n  }\n  if (miniWidget.value.options.dataLakeVariable) {\n    listenerId = listenDataLakeVariable(miniWidget.value.options.dataLakeVariable.name, (value) => {\n      selectedOption.value = options.value.find((option) => option.value === value)\n    })\n    const storedValue = widgetStore.getMiniWidgetLastValue(miniWidget.value.hash)\n    selectedOption.value = options.value.find((option: SelectorOption) => option.value === storedValue)\n  }\n  if (miniWidget.value.options.lastSelected?.name !== '') {\n    selectedOption.value = miniWidget.value.options.lastSelected\n  }\n})\n\nonUnmounted(() => {\n  if (miniWidget.value.options.dataLakeVariable) {\n    deleteDataLakeVariable(miniWidget.value.options.dataLakeVariable.id)\n    if (listenerId) {\n      unlistenDataLakeVariable(miniWidget.value.options.dataLakeVariable.name, listenerId)\n    }\n  }\n})\n</script>\n\n<style scoped>\n.select-container {\n  width: 100%;\n  align-items: center;\n  flex-direction: row;\n}\n</style>\n"],"names":["widgetStore","useWidgetManagerStore","listenerId","props","__props","options","computed","_a","miniWidget","toRefs","selectedOption","ref","option","selectedValue","_b","watch","newValue","handleSelection","value","selected","setDataLakeVariableData","onMounted","listenDataLakeVariable","storedValue","onUnmounted","deleteDataLakeVariable","unlistenDataLakeVariable"],"mappings":"+jBA4CA,MAAMA,EAAcC,EAAsB,EACtC,IAAAC,EAEJ,MAAMC,EAAQC,EAORC,EAAUC,EAAS,IAAM,OAC7B,QAAOC,EAAAC,EAAW,MAAM,QAAQ,SAAzB,YAAAD,EAAiC,kBAAmB,CAAC,CAAA,CAC7D,EAEKC,EAAaC,EAAON,CAAK,EAAE,WAC3BO,EAAiBC,EACrBN,EAAQ,MAAM,KAAMO,GAAW,OAAA,OAAAA,EAAO,UAAUL,EAAAJ,EAAM,WAAW,QAAQ,eAAzB,YAAAI,EAAuC,OAAK,GAAKF,EAAQ,MAAM,CAAC,CAClH,EAEMQ,EAAgBF,IACpBJ,EAAAJ,EAAM,WAAW,QAAQ,eAAzB,YAAAI,EAAuC,UAASO,EAAAT,EAAQ,MAAM,CAAC,IAAf,YAAAS,EAAkB,MACpE,EAEAC,EACE,IAAMf,EAAY,sBAAsBQ,EAAW,MAAM,IAAI,EAAE,eAC9DQ,GAAa,CACRA,IAAa,KACHhB,EAAA,uBAAuBQ,EAAW,MAAM,IAAI,EACxD,WAAW,IAAM,CACfR,EAAY,sBAAsBQ,EAAW,MAAM,IAAI,EAAE,eAAiB,IACzE,GAAG,EAEV,EACA,CAAE,UAAW,GAAM,KAAM,EAAK,CAChC,EAEMO,EAAAL,EAAiBM,GAAa,CACtBhB,EAAA,qBAAqBQ,EAAW,MAAM,KAAM,CACtD,GAAGA,EAAW,MAAM,QACpB,aAAcQ,CAAA,CACf,CAAA,CACF,EAEK,MAAAC,EAAmBC,GAA2C,CAClE,GAAIlB,EAAY,YAAa,OAEvB,MAAAmB,EAAWd,EAAQ,MAAM,KAAMO,GAAWA,EAAO,QAAUM,CAAK,EACjEC,IAELN,EAAc,MAAQK,EAElBV,EAAW,MAAM,QAAQ,kBAC3BY,EAAwBZ,EAAW,MAAM,QAAQ,iBAAiB,GAAIU,CAAK,EAE7ElB,EAAY,uBAAuBQ,EAAW,MAAM,KAAMW,EAAS,KAAK,EAC1E,EAEA,OAAAE,EAAU,IAAM,OAaV,IAZA,CAACb,EAAW,MAAM,SAAW,OAAO,KAAKA,EAAW,MAAM,OAAO,EAAE,SAAW,KAChFA,EAAW,MAAM,gBAAkB,GACvBR,EAAA,qBAAqBQ,EAAW,MAAM,KAAM,CACtD,OAAQ,CACN,gBAAiB,CAAC,EAClB,MAAO,QACP,MAAO,GACT,EACA,aAAc,SACd,iBAAkB,MAAA,CACnB,GAECA,EAAW,MAAM,QAAQ,iBAAkB,CAC7CN,EAAaoB,EAAuBd,EAAW,MAAM,QAAQ,iBAAiB,KAAOU,GAAU,CAC9ER,EAAA,MAAQL,EAAQ,MAAM,KAAMO,GAAWA,EAAO,QAAUM,CAAK,CAAA,CAC7E,EACD,MAAMK,EAAcvB,EAAY,uBAAuBQ,EAAW,MAAM,IAAI,EAC7DE,EAAA,MAAQL,EAAQ,MAAM,KAAMO,GAA2BA,EAAO,QAAUW,CAAW,CAAA,GAEhGhB,EAAAC,EAAW,MAAM,QAAQ,eAAzB,YAAAD,EAAuC,QAAS,KACnCG,EAAA,MAAQF,EAAW,MAAM,QAAQ,aAClD,CACD,EAEDgB,EAAY,IAAM,CACZhB,EAAW,MAAM,QAAQ,mBAC3BiB,EAAuBjB,EAAW,MAAM,QAAQ,iBAAiB,EAAE,EAC/DN,GACFwB,EAAyBlB,EAAW,MAAM,QAAQ,iBAAiB,KAAMN,CAAU,EAEvF,CACD"}