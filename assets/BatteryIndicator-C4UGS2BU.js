import{c as B,t as F,u as k,e as D,R as U,r as v,h as w,w as j,S as N,T as $,j as O,m as x,n as f,q as r,E as m,p as a,P as A,v as z,x as I,B as y,Q as E,U as G,z as s,W as R,G as q,X as Q,Y as _,Z as X,$ as Y,F as Z}from"./index-Bpw_4DmJ.js";const H={class:"relative w-[1.5rem] battery-icon"},J={key:0,class:"absolute text-sm text-yellow-400 -bottom-[3px] left-[4px] mdi mdi-alert-circle"},K={class:"relative right-0 flex flex-col w-[4rem] select-none text-sm font-semibold leading-4 text-end -mr-2"},L={class:"w-full"},ee={class:"flex justify-end gap-x-1 items-center"},te={class:"font-mono"},oe={class:"w-full"},ae={key:0,class:"flex justify-end gap-x-1 items-center"},se={class:"font-mono mt-[2px]"},le={key:1,class:"flex justify-end gap-x-1 items-center text-yellow-100"},ne={class:"font-mono mt-[2px]"},re={class:"text-red-500 text-center text-sm w-[full]"},u=500,pe=B({__name:"BatteryIndicator",props:{miniWidget:{}},setup(C){const e=F(C).miniWidget,V={showCurrent:!0,showPower:!0,toggleInterval:1e3},t=k(),b=D(),M=U(),g=v(!0),p=v(void 0),c=v(""),h=v(void 0),i=v(e.value.options.toggleInterval??V.toggleInterval),T=w(()=>{var l;return((l=t==null?void 0:t.powerSupply)==null?void 0:l.voltage)===void 0?"--":Math.abs(t.powerSupply.voltage)>=100?t.powerSupply.voltage.toFixed(0):t.powerSupply.voltage.toFixed(1)}),W=w(()=>{var l;return((l=t==null?void 0:t.powerSupply)==null?void 0:l.current)===void 0?"--":Math.abs(t.powerSupply.current)>=100?t.powerSupply.current.toFixed(0):t.powerSupply.current.toFixed(1)}),P=w(()=>t.instantaneousWatts!==void 0?t.instantaneousWatts.toFixed(1):"--"),d=w(()=>{var l;return((l=t==null?void 0:t.powerSupply)==null?void 0:l.remaining)===void 0?-1:Math.abs(t.powerSupply.remaining)>100?100:t.powerSupply.remaining}),S=()=>{(p.value||h.value)&&(clearInterval(p.value),clearTimeout(h.value)),i.value<u?(e.value.options.toggleInterval=u,c.value=`Interval must be at least ${u}ms.`):e.value.options.toggleInterval=i.value,!e.value.options.showCurrent&&!e.value.options.showPower&&(e.value.options.showCurrent=!0,e.value.options.showPower=!0,c.value="At least one of the options must be enabled."),e.value.options.showCurrent&&e.value.options.showPower?p.value=setInterval(()=>{g.value=!g.value},e.value.options.toggleInterval):g.value=e.value.options.showCurrent,h.value=setTimeout(()=>{c.value="",i.value<u&&(i.value=u)},5e3)};return j([()=>e.value.options,i],S,{deep:!0}),N(()=>{e.value.options=Object.assign({},V,e.value.options),S(),$.registerUsage("Instantaneous Watts")}),O(()=>{p.value===void 0&&clearInterval(p.value)}),(l,o)=>(f(),x(Z,null,[r(E,{text:`Battery remaining: ${d.value<0?"No Data":d.value+"%"}`},{activator:m(({props:n})=>[a("div",A(n,{class:"flex items-center w-[95px] h-12 text-white justify-center"}),[a("div",H,[o[4]||(o[4]=a("i",{class:"mdi mdi-battery-outline"},null,-1)),a("i",{class:"mdi mdi-battery absolute inset-0 bottom-0 -right-1 text-transparent bg-clip-text",style:I({backgroundImage:`linear-gradient(to top, white ${d.value}%, transparent ${d.value}%)`})},null,4),d.value<0?(f(),x("span",J)):z("",!0)]),a("div",K,[a("div",L,[a("div",ee,[a("span",te,y(T.value),1),o[5]||(o[5]=a("div",{class:"w-[15px] mr-[1px] -ml-[1px]"},"V",-1))])]),a("div",oe,[g.value?(f(),x("div",ae,[a("span",se,y(W.value),1),o[6]||(o[6]=a("div",{class:"w-[15px]"},"A",-1))])):(f(),x("div",le,[a("span",ne,y(P.value),1),o[7]||(o[7]=a("div",{class:"w-[15px]"},"W",-1))]))])])],16)]),_:1},8,["text"]),r(Y,{modelValue:s(b).miniWidgetManagerVars(s(e).hash).configMenuOpen,"onUpdate:modelValue":o[3]||(o[3]=n=>s(b).miniWidgetManagerVars(s(e).hash).configMenuOpen=n),width:"auto"},{default:m(()=>[r(G,{class:"pa-4 text-white w-[20rem]",style:I([{"border-radius":"15px"},s(M).globalGlassMenuStyles])},{default:m(()=>[r(R,{class:"text-center"},{default:m(()=>o[8]||(o[8]=[q("Battery Indicator Config")])),_:1,__:[8]}),r(Q,{class:"flex flex-col gap-y-4"},{default:m(()=>[r(_,{modelValue:s(e).options.showCurrent,"onUpdate:modelValue":o[0]||(o[0]=n=>s(e).options.showCurrent=n),label:"Show Current","hide-details":""},null,8,["modelValue"]),r(_,{modelValue:s(e).options.showPower,"onUpdate:modelValue":o[1]||(o[1]=n=>s(e).options.showPower=n),label:"Show Power","hide-details":""},null,8,["modelValue"]),r(X,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=n=>i.value=n),modelModifiers:{number:!0},label:"Toggle Interval (ms)",type:"number",min:u,step:"100",density:"compact",variant:"outlined",disabled:!s(e).options.showCurrent||!s(e).options.showPower},null,8,["modelValue","disabled"]),a("p",re,y(c.value),1)]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])],64))}});export{pe as default};
