import{aG as T,aH as E,aQ as ie,aZ as F,aJ as $,bw as re,aT as ue,aM as de,G as o,bx as k,bt as _,k as B,by as K,c as ce,K as fe,J as me,I as ge,r as N,L as be,o as pe,bz as ve,bA as Ve,bB as ye,w as P,au as Ce,ay as he,aA as Se,ax as ke,l as we,m as xe,n as C,N as u,V as Le,O as U,q as d,P as Me,Q as j,R as Ne,ah as Pe,bC as je,a5 as Ae,a2 as Ie,bD as Te,bE as D,bF as G,aC as z,a4 as Ee,U as Fe,W as $e,F as _e,_ as Be}from"./index-D_idQJBq.js";const Re=T({fluid:{type:Boolean,default:!1},...E(),...ie(),...F()},"VContainer"),Oe=$()({name:"VContainer",props:Re(),setup(e,i){let{slots:l}=i;const{rtlClasses:r}=re(),{dimensionStyles:t}=ue(e);return de(()=>o(e.tag,{class:["v-container",{"v-container--fluid":e.fluid},r.value,e.class],style:[t.value,e.style]},l)),{}}}),J=k.reduce((e,i)=>(e[i]={type:[Boolean,String,Number],default:!1},e),{}),Q=k.reduce((e,i)=>{const l="offset"+_(i);return e[l]={type:[String,Number],default:null},e},{}),q=k.reduce((e,i)=>{const l="order"+_(i);return e[l]={type:[String,Number],default:null},e},{}),W={col:Object.keys(J),offset:Object.keys(Q),order:Object.keys(q)};function Ue(e,i,l){let r=e;if(!(l==null||l===!1)){if(i){const t=i.replace(e,"");r+=`-${t}`}return e==="col"&&(r="v-"+r),e==="col"&&(l===""||l===!0)||(r+=`-${l}`),r.toLowerCase()}}const De=["auto","start","end","center","baseline","stretch"],Ge=T({cols:{type:[Boolean,String,Number],default:!1},...J,offset:{type:[String,Number],default:null},...Q,order:{type:[String,Number],default:null},...q,alignSelf:{type:String,default:null,validator:e=>De.includes(e)},...E(),...F()},"VCol"),A=$()({name:"VCol",props:Ge(),setup(e,i){let{slots:l}=i;const r=B(()=>{const t=[];let f;for(f in W)W[f].forEach(m=>{const p=e[m],g=Ue(f,m,p);g&&t.push(g)});const b=t.some(m=>m.startsWith("v-col-"));return t.push({"v-col":!b||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),t});return()=>{var t;return K(e.tag,{class:[r.value,e.class],style:e.style},(t=l.default)==null?void 0:t.call(l))}}}),R=["start","end","center"],Y=["space-between","space-around","space-evenly"];function O(e,i){return k.reduce((l,r)=>{const t=e+_(r);return l[t]=i(),l},{})}const ze=[...R,"baseline","stretch"],Z=e=>ze.includes(e),X=O("align",()=>({type:String,default:null,validator:Z})),We=[...R,...Y],ee=e=>We.includes(e),te=O("justify",()=>({type:String,default:null,validator:ee})),He=[...R,...Y,"stretch"],ae=e=>He.includes(e),le=O("alignContent",()=>({type:String,default:null,validator:ae})),H={align:Object.keys(X),justify:Object.keys(te),alignContent:Object.keys(le)},Ke={align:"align",justify:"justify",alignContent:"align-content"};function Je(e,i,l){let r=Ke[e];if(l!=null){if(i){const t=i.replace(e,"");r+=`-${t}`}return r+=`-${l}`,r.toLowerCase()}}const Qe=T({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:Z},...X,justify:{type:String,default:null,validator:ee},...te,alignContent:{type:String,default:null,validator:ae},...le,...E(),...F()},"VRow"),I=$()({name:"VRow",props:Qe(),setup(e,i){let{slots:l}=i;const r=B(()=>{const t=[];let f;for(f in H)H[f].forEach(b=>{const m=e[b],p=Je(f,b,m);p&&t.push(p)});return t.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),t});return()=>{var t;return K(e.tag,{class:["v-row",r.value,e.class],style:e.style},(t=l.default)==null?void 0:t.call(l))}}}),qe={class:"main"},Ye=["width","height"],Ze=ce({__name:"Plotter",props:{widget:{}},setup(e){const i=fe(),l=me(),t=ge(e).widget,f=N([]);be(()=>{Object.keys(t.value.options).length===0&&(t.value.options={backgroundColor:"rgba(0, 0, 0, 0.7)",lineColor:"rgba(255, 0, 0, 1.0)",dataLakeVariableId:void 0,maxSamples:1e3,limitSamples:!0})}),pe(()=>{m(t.value.options.dataLakeVariableId),f.value=Object.values(ve()).filter(s=>s.type==="number")});const b=()=>{t.value.options.limitSamples&&(c.length===t.value.options.maxSamples+1?c.shift():c.length>t.value.options.maxSamples&&c.splice(0,c.length-t.value.options.maxSamples))},m=s=>{if(s===void 0){console.error("No data lake variable ID provided!");return}const a=t.value.options.dataLakeVariableId;a!==void 0&&Ve(a),ye(s,n=>{c.push(n),b(),h()})};P([t.value.options.maxSamples,t.value.options.limitSamples],()=>{b(),h()});const{height:p}=Ce(),g=B(()=>({width:t.value.size.width*p.value,height:t.value.size.height*p.value})),y=N(),w=N(),x=(s,a,n,v)=>{const M=s.measureText(a),V=4;s.fillStyle="rgba(0, 0, 0, 0.5)",s.fillRect(n-V,v-16-V,M.width+V*2,16+V*2),s.fillStyle=t.value.options.lineColor,s.fillText(a,n,v)},h=()=>{if(y.value===void 0||y.value===null)return;if(w.value===void 0){console.debug("Canvas context undefined!"),w.value=y.value.getContext("2d");return}const s=w.value,a=g.value.width,n=g.value.height;he(s),s.clearRect(0,0,a,n),s.fillStyle=t.value.options.backgroundColor,s.fillRect(0,0,a,n),s.strokeStyle=t.value.options.lineColor;try{if(c.length===0)return;L=Math.max(...c),S=Math.min(...c);const v=c[c.length-1];s.beginPath(),s.moveTo(0,n),c.forEach((M,V)=>{const se=V*(a/c.length),oe=n-(M-S)/(L-S)*n;s.lineTo(se,oe)}),s.stroke(),s.font="14px monospace",s.textBaseline="bottom",x(s,`Current: ${v.toFixed(2)}`,10,n-10),x(s,`Min: ${S.toFixed(2)}`,10,n-30),x(s,`Max: ${L.toFixed(2)}`,10,n-50)}catch(v){console.error("Error drawing graph:",v)}},c=[];let L=0,S=0;P([g,t.value.options],()=>{l.isWidgetVisible(t.value)&&Se(()=>h())});const ne=ke(y);return P(ne,(s,a)=>{s&&!a&&h()}),(s,a)=>(we(),xe(_e,null,[C("div",qe,[C("canvas",{ref_key:"canvasRef",ref:y,width:g.value.width,height:g.value.height},null,8,Ye)]),o($e,{modelValue:d(l).widgetManagerVars(d(t).hash).configMenuOpen,"onUpdate:modelValue":a[5]||(a[5]=n=>d(l).widgetManagerVars(d(t).hash).configMenuOpen=n),"min-width":"400","max-width":"35%"},{default:u(()=>[o(Le,{class:"pa-2",style:U(d(i).globalGlassMenuStyles)},{default:u(()=>[o(Me,null,{default:u(()=>a[6]||(a[6]=[j("Plotter config")])),_:1}),o(Ne,null,{default:u(()=>[o(Oe,{class:"pa-0"},{default:u(()=>[o(I,null,{default:u(()=>[o(A,{cols:"12"},{default:u(()=>[a[7]||(a[7]=C("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Source",-1)),o(Pe,{modelValue:d(t).options.dataLakeVariableId,"onUpdate:modelValue":[a[0]||(a[0]=n=>d(t).options.dataLakeVariableId=n),m],items:f.value,"item-title":"name","item-value":"id",label:"Data Lake variable",hint:"Select a variable to be plotted","persistent-hint":"",variant:"outlined",density:"comfortable",class:"mb-2"},null,8,["modelValue","items"])]),_:1})]),_:1}),o(I,null,{default:u(()=>[o(A,{cols:"12"},{default:u(()=>[a[10]||(a[10]=C("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Appearance",-1)),o(je,null,{activator:u(({props:n})=>[o(Ae,Ie(n,{icon:"mdi-palette",size:"54",class:"bg-[#334a5755] text-[#FFFFFFCC] text-[28px] rounded-full elevation-5"}),null,16)]),default:u(()=>[o(Te,{style:U(d(i).globalGlassMenuStyles)},{default:u(()=>[o(D,null,{default:u(()=>[o(G,{class:"text-subtitle-1 font-weight-medium mb-2"},{default:u(()=>a[8]||(a[8]=[j(" Background Color ")])),_:1}),o(z,{modelValue:d(t).options.backgroundColor,"onUpdate:modelValue":a[1]||(a[1]=n=>d(t).options.backgroundColor=n),label:"Background","hide-inputs":"",class:"m-2"},null,8,["modelValue"])]),_:1}),o(D,null,{default:u(()=>[o(G,{class:"text-subtitle-1 font-weight-medium mb-2"},{default:u(()=>a[9]||(a[9]=[j("Line Color")])),_:1}),o(z,{modelValue:d(t).options.lineColor,"onUpdate:modelValue":a[2]||(a[2]=n=>d(t).options.lineColor=n),label:"Line","hide-inputs":"",class:"m-2"},null,8,["modelValue"])]),_:1})]),_:1},8,["style"])]),_:1})]),_:1})]),_:1}),o(I,null,{default:u(()=>[o(A,{cols:"12"},{default:u(()=>[a[11]||(a[11]=C("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Points",-1)),o(Ee,{modelValue:d(t).options.limitSamples,"onUpdate:modelValue":a[3]||(a[3]=n=>d(t).options.limitSamples=n),label:"Limit number of samples",color:"primary","hide-details":"",class:"mb-2"},null,8,["modelValue"]),o(Fe,{modelValue:d(t).options.maxSamples,"onUpdate:modelValue":a[4]||(a[4]=n=>d(t).options.maxSamples=n),modelModifiers:{number:!0},type:"number",label:"Maximum samples",variant:"outlined",density:"comfortable",disabled:!d(t).options.limitSamples,rules:[n=>n>0||"Must be greater than 0"],hint:"Higher values will show more history but may impact performance","persistent-hint":""},null,8,["modelValue","disabled","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])],64))}}),et=Be(Ze,[["__scopeId","data-v-72c0b088"]]);export{et as default};
